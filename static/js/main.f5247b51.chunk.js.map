{"version":3,"sources":["lib/typeAcquisition.ts","../../bundler/dist/dist-module/index.js","../../resolver-host-compound/dist/dist-module/index.js","lib/error.ts","lib/ResolverHostMonaco.ts","../../resolver-host-unpkg/dist/dist-module/index.js","lib/ResolverHostWithCache.ts","lib/EditorManager.ts","playground/Editor.tsx","playground/Preview.tsx","lib/hooks.ts","playground/Sidebar.tsx","playground/Playground.tsx","templates/react.ts","serviceWorker.ts","useServiceWorker.tsx","App.tsx","index.tsx","../../resolver/dist/dist-module/index.js"],"names":["PackageEntryKind","HAS_D_TS_EXTENSION","getTypingsModuleSpec","pkgJson","typingsName","name","charAt","slice","replace","typingsRange","version","major","split","range","TypeAcquirer","resolver","resolveBareModule","_onTypeFile","Emitter","typingsFiles","parentPath","moduleRoot","util","join","this","_listFiles","then","files","imported","promises","normalizedMain","resolve","main","pathname","test","push","host","readFileContent","buf","contents","decoder","decode","filePath","fire","content","e","console","warn","length","Promise","all","undefined","typingsModuleSpec","_import","dependencies","getCanonicalUrl","unresolvedUrl","resolvedUrl","entries","queue","next","shift","listEntries","entriesAtPath","entry","type","ResolvedEntryKind","Directory","url","path","href","File","pkgJsonPathname","bareModuleUrl","readParentPackageJson","resolvedPkgJson","Error","pkgJsonText","JSON","stringify","packageJson","resolvedName","_importAdjacentTypings","indexOf","_importTypingsFromDefinitelyTyped","error","specs","Object","keys","map","importTypesForSpec","importResults","reduce","result","event","object","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","target","i","arguments","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","RELATE_PATH_RX","SPEC_RX","Deferred","token","_this","internalState","promise","promiseResolve","promiseReject","isCancellationRequested","reject","onCancellationRequested","value","reason","get","isBareModuleSpecifier","spec","parseBareModuleSpec","parsed","matches","match","nameSpec","maybeParseBareModuleSpec","concat","traverse","ast","ctx","_ref","visit","node","parent","enter","leave","prop","index","_shouldSkip","shouldSkip","call","skipped","childKeys","Array","isArray","j","skip","isArrowFunctionExpression","isFunctionDeclaration","isFunctionExpression","isIdentifier","isMemberExpression","isNodeWithStartAndEnd","start","end","isStringLiteral","isLiteral","parseFile","uri","magicString","code","options","unboundSymbols","Map","locals","nodeEnv","replacements","requires","requireResolves","Set","original","onComment","_isBlock","_test","remove","onToken","addSourcemapLocation","allowReturnOutsideFunction","sourceType","scopingAndRequiresVisitor","collectGlobalsVisitor","err","message","requireDependencies","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","callee","return","requireResolveDependencies","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_node","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_ref4","_ref3","symbolName","symbolNodes","set","has","_parent","isVariableDeclaration","nextParent","kind","isScope","isBlockScope","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","declarations","declarePattern","id","_parent2","_nextParent2","_locals","declareFunction","isFunction","_locals2","isClassDeclaration","_parent3","_nextParent3","_locals3","isTryStatement","handler","_locals4","param","visitAndCaptureScoping","isIfStatement","isBinaryExpression","l","r","operator","left","right","memberExpressionMatches","replacement","alternate","add","consequent","visitAndSkipBranches","isCallExpression","firstArg","property","_firstArg","visitRequires","isPropertyOfMemberExpression","isProperty","isKeyOfProperty","isBindingIdentifier","foundBinding","declaresArguments","isThisExpression","_foundBinding","_nextParent","declaresThis","_unboundSymbols","params","isObjectPattern","properties","isArrayPattern","elements","isRestElement","argument","isAssignmentPattern","isProgram","isBlockStatement","pattern","memberParts","DependencyKind","Asset","rootHref","unresolvedDependencies","deps","filename","indentExclusionRanges","sourceMappingUrl","str","re","lastMatch","exec","getSourceMappingUrl","asset","endsWith","parse","_href","cssCode","BACKSLASH","charCodeAt","SINGLE_QUOTE","NL","CR","escaped","char","overwrite","prependRight","prepend","append","getParserForAsset","json","_asset$dependencies","setCode","NODE_CORE_SHIMS","shims","coreLibName","assign","resolveBareModuleToUnpkgWithDetails","_ref5","mark","_callee","parentHref","_ref6","syntheticDependencies","parsedSpec","details","resolvedSpecRoot","unresolvedHref","parentUrl","parentPackageInfo","consolidatedDependencies","builtIn","parsedBuiltInSpec","stableUrl","stableRootUrl","resolveResult","packageInfo","_args","wrap","_context","prev","bareModule","URL","t0","sent","peerDependencies","devDependencies","versionSpec","t1","isBuiltIn","ignored","rootUrl","abrupt","stop","_x","_x2","_x3","_x4","_Error","ExtendableError","_this2","constructor","captureStackTrace","stack","_ExtendableError","InvariantViolation","createRuntime","manifest","aliases","create","mappings","modules","registry","Runtime","root","Module","self","register","module","exports","HotModule","runtime","dependents","acceptCallbacks","disposeCallbacks","seal","hot","toStringTag","configurable","prototype","alias","dependency","fromId","toId","mappingsForId","getId","init","executeEntrypoints","factory","_alias","entrypoint","entrypoints","require","dependent","delete","accept","cb","dispose","dirname","bind","window","Bundle","assets","entrypointsToAssets","dependenciesToAssets","assetsByHref","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","bundle","separator","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","addSource","buildAssetForImmediateExecution","aliasMap","from","acc","_ref7","_ref8","entrypointMap","_ref9","_ref10","runtimeOptions","toString","sourceMap","generateSourceMap","_this$buildForImmedia","buildForImmediateExecution","toDataUri","_this4","inputMap","generateMap","includeContent","hires","seen","remapping","SourceMap","input","file","sourceRoot","names","sources","sourcesContent","encode","_buildAssetAndCollect","indent","clone","trim","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","Require","RequireResolve","InjectedGlobal","exportName","buildAssetAndCollectDependencies","ResolveDetailsKind","Bundler","EMPTY_MODULE_URL","DEFAULT_SHIM_GLOBALS","Buffer","export","global","process","pendingResolves","onAssetAddedEmitter","onAssetRemovedEmitter","clear","_generateBundle","_callee5","tokenSource","pendingOperations","dfd","enqueue","resolveDependencies","resolveAsset","_loop4","_loop5","idx","_this5","_args5","_context5","cancel","_ref11","_callee2","op","_context2","onEnqueueAsset","onCompleteAsset","setTimeout","isSettled","catch","_","_x6","_ref12","_callee3","_asset$dependencies2","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_loop","_iterator8","_step8","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_loop2","_iterator9","_step9","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_loop3","_iterator10","_step10","_ref14","_context3","dependencyAsset","finish","_ref13","references","shim","t2","splice","_x7","_x8","_ref15","_callee4","fromSpec","resolvedSpec","_context4","resolveWithDetails","getOrCreateAsset","resolvedHref","readCode","_x9","_x10","_x5","_invalidate","_callee6","_ref16","combinedUri","_args6","_context6","removeAsset","_x11","_readCode","_callee7","_ref17","_context7","_x12","_x13","_resolveWithDetails","_callee8","fromUri","_ref18","resolved","bareModuleResolveResult","resolvedUri","_resolvedHref","_context8","BareModule","stableHref","stableRootHref","Relative","_x14","_x15","_x16","_AbstractResolverHost","ResolverHostCompound","hosts","prefix","_ref2","child","startsWith","getResolveRoot","InvariantError","TimeoutError","TranspileError","diagnostics","ResolverHostMonaco","rootUri","Monaco","_resolver","getModels","model","modelHref","seenDirs","nestedPath","nextDirIdx","getModel","encoder","TextEncoder","getTranspiledValue","output","getModeId","tryLoadFromWorker","a","typescript","getTypeScriptWorker","workerFactory","workerClient","getEmitOutput","getSyntacticDiagnostics","emitOutput","syntacticDiagnostics","emitSkipped","fsPath","diagnostic","startPosition","getPositionAt","endPosition","flattenDiagnosticMessageText","messageText","lineNumber","column","outputFiles","text","attempt","timeoutMs","race","timeout","Math","pow","getValue","AbstractResolverHost","diag","newLine","EntryNotFoundError","_ExtendableError2","FetchError","isValidEntry","isValidFile","isValidDirectory","every","signalFromCancellationToken","AbortControllerConstructor","abortController","abort","signal","UnpkgCdn","UNPKG_SPEC_RX","protocol","hostname","JSDelivrCdn","JSDELIVR_SPEC_RX","mapChildEntry","_files","dataHost","ResolverHostUnpkg","contentCache","byteLength","max","inflightContentRequests","packageLock","packageEntriesCache","packageJsonCache","fetch","TypeError","AbortController","cdn","_getCanonicalUrl","unresolvedSpec","isValidUrl","parseUrl","readPackageJsonWithCache","urlForPackageFile","_getResolveRoot","_args2","_listEntries","parentEntry","traversalSegments","_args3","readPackageEntriesWithCache","Boolean","segment","find","basename","_readFileContent","cached","inflight","_args4","redirect","res","ok","status","arrayBuffer","aborted","_readPackageEntriesWithCache","lockKey","lock","packageEntriesCacheForModule","exactMatch","_packageEntries","packageEntries","readPackageEntries","_readPackageJsonWithCache","packageJsonCacheForModule","_packageJson","readPackageJson","_readPackageJson","_args7","parseBufferAsPackageJson","_readPackageEntries","_args8","urlForPackageList","normalizePackageListing","ResolverHostWithCache","idbTimeout","hostTimeout","idbPromise","openDB","schemaVersion","upgrade","db","oldVersion","newVersion","transaction","createObjectStore","objectStore","inflightGetCanonicalUrl","inflightGetResolveRoot","inflightListEntries","inflightReadFileContent","getCanonicalUrlCache","getResolveRootCache","listEntriesCache","readFileContentCache","loadFn","cache","inflightMap","storeName","serialize","deserialize","withTimeout","idb","put","withCache","duration","EditorManager","unpkgCdn","bundler","Resolver","getRoot","extensions","packageMain","editor","disposableStore","DisposableStore","initialPath","typeAcquirer","viewState","WeakMap","onWillFocusModelEmitter","onDidChangeEmitter","typescriptDefaults","setEagerModelSync","setMaximumWorkerIdleTime","setCompilerOptions","allowJs","allowNonTsExtensions","allowSyntheticDefaultImports","baseUrl","checkJs","esModuleInterop","experimentalDecorators","inlineSourceMap","inlineSources","isolatedModules","jsx","JsxEmit","React","lib","ModuleKind","CommonJS","moduleResolution","ModuleResolutionKind","NodeJs","noEmit","outDir","resolveJsonModule","rootDir","ScriptTarget","ES2015","typeRoots","setDiagnosticsOptions","noSemanticValidation","noSyntaxValidation","createModel","onDidCreateModel","onDidChangePackageJson","typescriptVersion","importTypesForSpecs","throttler","ThrottledDelayer","trigger","onDidChangeContent","onTypeFile","addExtraLib","language","inferLanguage","getModelByHref","focusModel","setModel","revealLineInCenter","ScrollType","Smooth","setPosition","columnNumber","markers","setModelMarkers","focus","getModelByPath","el","automaticLayout","minimap","enabled","showUnused","scrollBeyondLastLine","theme","wordWrap","wrappingIndent","onDidDispose","onDidChangeModel","newModelUrl","restoreViewState","onDidBlurEditorText","saveViewState","focusPath","EditorManagerContext","createContext","Editor","className","useRef","editorManager","useContext","useEffect","current","mount","ref","PreviewProgress","props","total","round","completed","PreviewIframeWrap","PreviewWrap","PreviewMessageError","PreviewMessageErrorText","isInternal","PreviewMessages","PreviewMessageLine","line","PreviewMessage","lines","Preview","invalidations","previewWrapRef","hmrClientRef","previewIframeRef","useState","messages","setMessages","buildProgress","setBuildProgress","runtimeBundleString","disposable","delayer","Delayer","Throttler","CancellationTokenSource","queueRefreshPreview","uris","refreshPreview","toInvalidate","building","invalidate","generateBundle","createBundleRuntime","runtimeBundle","unresolvedEntrypointHref","resolvedEntrypoint","resolvedEntrypointHref","build","CanceledError","send","updatedBundleFile","updatedBundleHref","createObjectURL","Event","toPromise","onReload","bundledCode","runtimeFile","bundleFile","markup","htmlUrl","iframe","document","createElement","style","display","src","appendChild","onload","onerror","onWillDisposeModel","onMessage","contentWindow","data","payload","fileName","row","getLineContent","MessagePort","HmrClient","debug","addEventListener","removeEventListener","ReactErrorOverlay","velcroRequire","channel","MessageChannel","setEditorHandler","postMessage","startReportingRuntimeErrors","onError","port2","onmessage","dismissRuntimeErrors","reportBuildError","val","isString","isValidReload","dismissBuildError","reload","__velcroRuntime","potentialOrphans","requireReload","acceptCallbackQueue","disposeCallbackQueue","disposeCallback","acceptCallback","script","toReload","potentialOrphan","potentialOrphanModule","size","head","port1","EntryKind","port","onReloadEmitter","close","Entry","modelFocused","color","cursor","backgroundColor","CreateEntry","SidebarFileDelete","Button","StyledTooltip","SidebarFile","activeModel","workbench","setActiveModel","trackEditor","onDidFocusEditorText","hasTextFocus","onDidCreateEditor","useActiveModel","tooltip","useTooltipState","gutter","onClick","TooltipReference","as","role","aria-label","Tooltip","Sidebar","sortEntries","models","sort","b","initialEntries","modelUri","setEntries","findIndex","useDirectory","prompt","onClickCreate","PlaygroundCmp","project","Provider","Playground","react","isLocalhost","location","config","navigator","origin","swUrl","headers","response","contentType","serviceWorker","ready","registration","unregister","registerValidSW","log","checkValidServiceWorker","onSuccess","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","ServiceWorkerContext","ServiceWorkerProvider","waitingServiceWorker","setWaitingServiceWorker","assetsUpdateReady","setAssetsUpdateReady","assetsCached","setAssetsCached","useMemo","updateAssets","waiting","active","PlaygroundWrapper","StatusBarItem","ReloadButton","StatusBar","context","useServiceWorker","offlineTooltip","reloadTooltip","StatusBarStyles","OfflineBolt","fontSize","Update","AppWrapper","Title","Subtitle","Link","Links","Header","globalCss","css","ReactDOM","render","CssBaseline","styles","rel","getElementById","ownKeys","_objectSpread","hasInvalidOptionalStringField","field","hasInvalidDependenciesField","CHAR_DOT","CHAR_FORWARD_SLASH","TRAILING_SLASH_RX","ensureTrailingSlash","browser","hasInvalidBrowserField","isValidPackageJson","parseTextAsPackageJson","getFirstPathSegmentAfterPrefix","childHref","parentOffset","validateString","ext","matchedSlash","extIdx","firstNonSlashEnd","isPathSeparator","extname","startDot","startPart","preDotState","len","rootEnd","offset","last","resolvedPath","resolvedAbsolute","allowAboveRoot","lastSegmentLength","lastSlash","dots","lastSlashIndex","lastIndexOf","normalizeString","freeze","initialSegment","Decoder","TextDecoder","TRAILING_SLASH_RX$1","defaultExtensions","_resolve","optionsWithDefaults","canonicalUrlPromise","canonicalUrl","rootHrefWithoutTrailingSlash","canonicalHref","ignoreBrowserOverrides","resolveAsDirectory","resolveAsFile","_resolveAsDirectory","mainPathname","packageJsonEntry","packageJsonContent","mainUrl","_resolveAsFile","parentPackageJson","browserOverrides","browserMap","packageJsonDir","impliedUrl","targetSpec","containingUrl","entryDirectoryMap","entryFileMap","_entry","childFilename","_childFilename","mapping","_match","includes","t3","t4","_readParentPackageJson","hostRootUrl","hostRootHref","containingDirUrl","readPackageJsonOrRecurse","_this3","dir","parentPackageJsonContent","parentDir"],"mappings":"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","file":"static/js/main.f5247b51.chunk.js","sourcesContent":["import { util, Resolver, PackageJson, ResolvedEntryKind } from '@velcro/resolver';\n\nimport { Emitter, Event } from 'ts-primitives';\n\nconst HAS_D_TS_EXTENSION = /\\.d\\.ts$/;\n\nenum PackageEntryKind {\n  Directory = 'directory',\n  File = 'file',\n}\n\ninterface PackageDirectoryEntry {\n  type: PackageEntryKind.Directory;\n  path: string;\n  files: PackageEntry[];\n}\n\ninterface PackageFileEntry {\n  type: PackageEntryKind.File;\n  path: string;\n}\n\ninterface TypingsFiles {\n  [fileName: string]: string;\n}\n\ntype PackageEntry = PackageDirectoryEntry | PackageFileEntry;\n\nfunction getTypingsModuleSpec(pkgJson: { name: string; version?: string }): { name: string; range: string } {\n  const typingsName = pkgJson.name.charAt(0) === '@' ? pkgJson.name.slice(1).replace('/', '__') : pkgJson.name;\n\n  let typingsRange = '*';\n\n  if (pkgJson.version) {\n    const major = pkgJson.version.split('.')[0];\n    typingsRange = `${major}.x`;\n  }\n\n  return {\n    name: `@types/${typingsName}`,\n    range: typingsRange,\n  };\n}\n\ninterface TypeFile {\n  pathname: string;\n  content: string;\n}\n\nexport class TypeAcquirer {\n  private _onTypeFile = new Emitter<TypeFile>();\n\n  constructor(\n    private readonly resolver: Resolver,\n    private readonly resolveBareModule: (spec: string, pathname?: string) => URL\n  ) {}\n\n  private _importAdjacentTypings(\n    typingsFiles: TypingsFiles,\n    pkgJson: PackageJson,\n    parentPath: string\n  ): Promise<boolean> {\n    // console.log('_importAdjacentTypings', pkgJson.name, pkgJson.version, parentPath);\n    const moduleRoot = util.join(parentPath, `node_modules/${pkgJson.name}/`);\n\n    if (!pkgJson.name) {\n      return Promise.resolve(false);\n    }\n\n    return this._listFiles(pkgJson.name, pkgJson.version).then(files => {\n      let imported = false;\n      const promises: Promise<void>[] = [];\n      const normalizedMain = util.resolve('/', pkgJson.main || 'index.js');\n\n      for (const pathname in files) {\n        if (!(normalizedMain === pathname || HAS_D_TS_EXTENSION.test(pathname))) {\n          continue;\n        }\n\n        promises.push(\n          this.resolver.host\n            .readFileContent(this.resolver, this.resolveBareModule(`${pkgJson.name}@${pkgJson.version}`, pathname))\n            .then(\n              // eslint-disable-next-line no-loop-func\n              buf => {\n                const contents = this.resolver.decoder.decode(buf);\n                const filePath = util.join(moduleRoot, pathname);\n                typingsFiles[filePath] = contents;\n\n                this._onTypeFile.fire({\n                  pathname: filePath,\n                  content: contents,\n                });\n\n                if (normalizedMain !== pathname) {\n                  imported = true;\n                }\n              },\n              e => {\n                console.warn(e);\n              }\n            )\n        );\n      }\n\n      if (!promises.length) {\n        return imported;\n      }\n\n      return Promise.all(promises).then(() => imported);\n    });\n  }\n\n  // private async _importEmbeddedTypings(\n  //   typingsFiles: TypingsFiles,\n  //   pkgJson: PackageJsonWithTypings,\n  //   parentPath: string\n  // ) {\n  //   let filesPromise: Promise<{ [fileName: string]: PackageFileEntry }> | undefined;\n  //   const readFiles = () => {\n  //     if (!filesPromise) {\n  //       filesPromise = this._listFiles(pkgJson.name, pkgJson.version);\n  //     }\n  //     return filesPromise;\n  //   };\n  //   const visitTypingsFile = async (fileName: string) => {\n  //     if (seen.has(fileName)) return;\n  //     seen.add(fileName);\n  //     console.log('visiting', fileName);\n  //     // Load the contents and add it to the known models\n  //     const sourceText = await this._readUnpkgFile(pkgJson.name, pkgJson.version, pkgJson.typings);\n  //     console.log('addExtraLib', sourceText, fileName);\n  //     typingsFiles[join(parentPath, fileName)] = sourceText;\n  //     const sourceFile = typescript.createSourceFile(fileName, sourceText, typescript.ScriptTarget.Latest, true);\n  //     const children: string[] = [];\n  //     typescript.forEachChild(sourceFile, child => {\n  //       if (typescript.isImportDeclaration(child) && typescript.isStringLiteral(child.moduleSpecifier)) {\n  //         children.push(child.moduleSpecifier.text);\n  //       } else if (\n  //         typescript.isExportDeclaration(child) &&\n  //         child.moduleSpecifier &&\n  //         child.moduleSpecifier &&\n  //         typescript.isStringLiteral(child.moduleSpecifier)\n  //       ) {\n  //         children.push(child.moduleSpecifier.text);\n  //       }\n  //     });\n  //     // We will figure out dependencies outside this module by building the optimized npm\n  //     // dependency tree\n  //     const relativeChildren = children.filter(ref => ref.charAt(0) === '.');\n  //     if (relativeChildren.length) {\n  //       const currentDir = dirname(fileName);\n  //       const files = await readFiles();\n  //       await Promise.all(\n  //         relativeChildren.map(ref => {\n  //           const childPathReference = resolve(currentDir, ref);\n  //           const childPath = resolveImportPath(files, childPathReference);\n  //           if (childPath) {\n  //             return visitTypingsFile(childPath);\n  //           }\n  //         })\n  //       );\n  //     }\n  //   };\n  //   const seen = new Set<string>();\n  //   const typescript = await import('typescript');\n  //   await visitTypingsFile(pkgJson.typings);\n  // }\n\n  private async _importTypingsFromDefinitelyTyped(\n    files: TypingsFiles,\n    pkgJson: PackageJson,\n    parentPath: string\n  ): Promise<void> {\n    // console.log('_importTypingsFromDefinitelyTyped', pkgJson.name, pkgJson.version, parentPath);\n    if (!pkgJson.name) {\n      return undefined;\n    }\n\n    const typingsModuleSpec = getTypingsModuleSpec({ name: pkgJson.name, version: pkgJson.version });\n\n    try {\n      const pkgJson = await this._import(files, typingsModuleSpec.name, typingsModuleSpec.range, parentPath);\n\n      if (pkgJson.dependencies) {\n        for (const name in pkgJson.dependencies) {\n          await this._import(files, name, pkgJson.dependencies[name], parentPath);\n        }\n      }\n    } catch (e) {\n      return undefined;\n    }\n  }\n\n  private async _listFiles(\n    name: string,\n    version: string = 'latest'\n  ): Promise<{ [pathname: string]: PackageFileEntry }> {\n    const unresolvedUrl = await this.resolver.host.getCanonicalUrl(\n      this.resolver,\n      this.resolveBareModule(`${name}@${version}`, '/')\n    );\n    const resolvedUrl = await this.resolver.host.getCanonicalUrl(this.resolver, unresolvedUrl);\n    const entries: { [pathname: string]: PackageFileEntry } = {};\n    const queue = [resolvedUrl];\n\n    while (queue.length) {\n      const next = queue.shift()!;\n      const entriesAtPath = await this.resolver.host.listEntries(this.resolver, next);\n\n      for (const entry of entriesAtPath) {\n        if (entry.type === ResolvedEntryKind.Directory) {\n          queue.push(entry.url);\n        } else {\n          const path = entry.url.href.slice(resolvedUrl.href.length - 1);\n          entries[path] = { type: PackageEntryKind.File, path };\n        }\n      }\n    }\n\n    return entries;\n  }\n\n  private async _import(\n    files: TypingsFiles,\n    name: string,\n    range: string,\n    parentPath: string = ''\n  ): Promise<PackageJson> {\n    // console.log('_import', name, range, parentPath);\n\n    const pkgJsonPathname = util.join(parentPath, 'node_modules', name, 'package.json');\n    const bareModuleUrl = this.resolveBareModule(`${name}@${range}`, '/package.json');\n    const resolvedPkgJson = await this.resolver.readParentPackageJson(bareModuleUrl);\n\n    if (!resolvedPkgJson) {\n      throw new Error(`Unable to load package.json for ${name}@${range}`);\n    }\n\n    const pkgJsonText = JSON.stringify(resolvedPkgJson.packageJson);\n    const resolvedName = resolvedPkgJson.packageJson.name || name;\n\n    files[pkgJsonPathname] = pkgJsonText;\n\n    this._onTypeFile.fire({\n      pathname: pkgJsonPathname,\n      content: pkgJsonText,\n    });\n\n    // if (isPackageJsonWithTypings(pkgJson)) {\n    //   await this._importEmbeddedTypings(files, pkgJson, parentPath);\n    // } else {\n    try {\n      const hasAdjacentTypings = await this._importAdjacentTypings(files, resolvedPkgJson.packageJson!, parentPath);\n\n      // console.log('hasAdjacentTypings', hasAdjacentTypings);\n\n      if (!hasAdjacentTypings && resolvedName.indexOf('@types/') !== 0) {\n        await this._importTypingsFromDefinitelyTyped(files, resolvedPkgJson.packageJson, parentPath);\n      }\n    } catch (err) {\n      console.error('error', err);\n    }\n    // }\n\n    return resolvedPkgJson.packageJson;\n  }\n\n  get onTypeFile(): Event<TypeFile> {\n    return this._onTypeFile.event;\n  }\n\n  async importTypesForSpec(name: string, range: string = 'latest', parentPath: string = ''): Promise<TypingsFiles> {\n    const files: TypingsFiles = {};\n\n    try {\n      await this._import(files, name, range, parentPath);\n    } catch (err) {\n      console.warn(err, `Type acquisition failed for ${name}@${range}`);\n    }\n\n    return files;\n  }\n\n  async importTypesForSpecs(specs: { [name: string]: string }, parentPath: string = ''): Promise<TypingsFiles> {\n    const promises = Object.keys(specs).map(name => this.importTypesForSpec(name, specs[name], parentPath));\n    const importResults = promises.length ? await Promise.all(promises) : [];\n\n    return importResults.reduce((files, result) => ({ ...files, ...result }), {} as TypingsFiles);\n  }\n}\n","import _possibleConstructorReturn from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport _regeneratorRuntime from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Emitter } from 'ts-primitives';\nexport { CancellationToken, CancellationTokenSource } from 'ts-primitives';\nimport MagicString, { Bundle as Bundle$1 } from 'magic-string';\nimport { CanceledError, CancellationTokenSource, EntryNotFoundError } from '@velcro/resolver';\nimport { parse as parse$1 } from 'acorn';\nimport remapping from '@ampproject/remapping';\nimport { Base64 } from 'js-base64';\nvar RELATE_PATH_RX = /^[./]|^[a-z_-]+:/;\nvar SPEC_RX = /^((@[^/]+\\/[^/@]+|[^./@][^/@]*)(?:@([^/]+))?)(.*)?$/;\n\nvar Deferred =\n/*#__PURE__*/\nfunction () {\n  function Deferred(token) {\n    var _this = this;\n\n    _classCallCheck(this, Deferred);\n\n    this.internalState = 'pending';\n    this.promise = new Promise(function (promiseResolve, promiseReject) {\n      _this.promiseResolve = promiseResolve;\n      _this.promiseReject = promiseReject;\n    });\n\n    if (token) {\n      if (token.isCancellationRequested) {\n        this.reject(new CanceledError('Canceled'));\n      } else {\n        token.onCancellationRequested(function () {\n          _this.reject(new CanceledError('Canceled'));\n        });\n      }\n    }\n  }\n\n  _createClass(Deferred, [{\n    key: \"resolve\",\n    value: function resolve(value) {\n      this.internalState = 'resolved';\n      this.promiseResolve(value);\n    }\n  }, {\n    key: \"reject\",\n    value: function reject(reason) {\n      this.internalState = 'rejected';\n      this.promiseReject(reason);\n    }\n  }, {\n    key: \"isSettled\",\n    get: function get() {\n      return this.internalState !== 'pending';\n    }\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this.internalState;\n    }\n  }]);\n\n  return Deferred;\n}();\n\nfunction isBareModuleSpecifier(spec) {\n  return !RELATE_PATH_RX.test(spec);\n}\n\nfunction maybeParseBareModuleSpec(spec) {\n  /**\r\n   * 1: scope + name + version\r\n   * 2: scope + name\r\n   * 3: version?\r\n   * 4: pathname\r\n   */\n  var matches = spec.match(SPEC_RX);\n\n  if (!matches) {\n    return undefined;\n  }\n\n  return {\n    nameSpec: matches[1],\n    name: matches[2],\n    spec: matches[3] || '',\n    pathname: matches[4] || ''\n  };\n}\n\nfunction parseBareModuleSpec(spec) {\n  var parsed = maybeParseBareModuleSpec(spec);\n\n  if (!parsed) {\n    throw new Error(\"Unable to parse unexpected unpkg url: '\".concat(spec, \"'\"));\n  }\n\n  return parsed;\n} // this looks ridiculous, but it prevents sourcemap tooling from mistaking\n// this for an actual sourceMappingURL\n\n\nfunction getSourceMappingUrl(str) {\n  var re = /(?:\\/\\/[@#][\\s]*(?:source)MappingURL=([^\\s'\"]+)[\\s]*$)|(?:\\/\\*[@#][\\s]*(?:source)MappingURL=([^\\s*'\"]+)[\\s]*(?:\\*\\/)[\\s]*$)/gm; // Keep executing the search to find the *last* sourceMappingURL to avoid\n  // picking up sourceMappingURLs from comments, strings, etc.\n\n  var lastMatch = null;\n  var match;\n\n  while (match = re.exec(str)) {\n    lastMatch = match;\n  }\n\n  if (!lastMatch) return undefined;\n  return lastMatch[1];\n}\n\nfunction traverse(ast, ctx, _ref) {\n  var enter = _ref.enter,\n      leave = _ref.leave;\n  visit(ast, null, ctx, enter, leave);\n}\n\nvar shouldSkip = false;\nvar context = {\n  skip: function skip() {\n    return shouldSkip = true;\n  }\n};\nvar childKeys = {};\n\nfunction visit(node, parent, ctx, enter, leave, prop, index) {\n  if (!node) return;\n  node.parent = parent;\n\n  if (enter) {\n    var _shouldSkip = shouldSkip;\n    shouldSkip = false;\n    enter.call(context, node, parent, ctx, prop, index);\n    var skipped = shouldSkip;\n    shouldSkip = _shouldSkip;\n    if (skipped) return;\n  }\n\n  var keys = childKeys[node.type] || (childKeys[node.type] = Object.keys(node).filter(function (key) {\n    return key !== 'parent' && typeof node[key] === 'object';\n  }));\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = node[key];\n\n    if (Array.isArray(value)) {\n      for (var j = 0; j < value.length; j++) {\n        visit(value[j], node, ctx, enter, leave, key, j);\n      }\n    } else if (value && value.type) {\n      visit(value, node, ctx, enter, leave, key);\n    }\n  }\n\n  if (leave) {\n    leave(node, parent, ctx, prop, index);\n  }\n}\n\nfunction isArrowFunctionExpression(node) {\n  return node.type === 'ArrowFunctionExpression';\n}\n\nfunction isArrayPattern(node) {\n  return node.type === 'ArrayPattern';\n}\n\nfunction isAssignmentPattern(node) {\n  return node.type === 'AssignmentPattern';\n}\n\nfunction isBinaryExpression(node) {\n  return node.type === 'BinaryExpression';\n}\n\nfunction isBlockStatement(node) {\n  return node.type === 'BlockStatement';\n}\n\nfunction isCallExpression(node) {\n  return node.type === 'CallExpression';\n}\n\nfunction isClassDeclaration(node) {\n  return node.type === 'ClassDeclaration';\n}\n\nfunction isFunctionDeclaration(node) {\n  return node.type === 'FunctionDeclaration';\n}\n\nfunction isFunctionExpression(node) {\n  return node.type === 'FunctionExpression';\n}\n\nfunction isIdentifier(node) {\n  return node.type === 'Identifier';\n}\n\nfunction isIfStatement(node) {\n  return node.type === 'IfStatement';\n}\n\nfunction isLiteral(node) {\n  return node.type === 'Literal';\n}\n\nfunction isMemberExpression(node) {\n  return node.type === 'MemberExpression';\n}\n\nfunction isNodeWithStartAndEnd(node) {\n  return typeof node.start === 'number' && typeof node.end === 'number';\n}\n\nfunction isObjectPattern(node) {\n  return node.type === 'ObjectPattern';\n}\n\nfunction isProperty(node) {\n  return node.type === 'Property';\n}\n\nfunction isRestElement(node) {\n  return node.type === 'RestElement';\n}\n\nfunction isProgram(node) {\n  return node.type === 'Program';\n}\n\nfunction isThisExpression(node) {\n  return node.type === 'ThisExpression';\n}\n\nfunction isTryStatement(node) {\n  return node.type === 'TryStatement';\n}\n\nfunction isVariableDeclaration(node) {\n  return node.type === 'VariableDeclaration';\n} // Refinements or groups\n\n\nfunction isFunction(node) {\n  return isFunctionDeclaration(node) || isFunctionExpression(node) || isArrowFunctionExpression(node);\n}\n\nfunction isStringLiteral(node) {\n  return isLiteral(node) && typeof node.value === 'string';\n}\n\nfunction parse(code, options) {\n  return parse$1(code, _objectSpread({}, options, {\n    allowReturnOutsideFunction: true,\n    sourceType: 'script'\n  }));\n}\n\nfunction parseFile(uri, magicString) {\n  var ctx = {\n    unboundSymbols: new Map(),\n    locals: new Map(),\n    nodeEnv: 'development',\n    replacements: [],\n    requires: [],\n    requireResolves: [],\n    skip: new Set()\n  };\n\n  try {\n    // let lastToken: acorn.Token | undefined = undefined;\n    var ast = parse(magicString.original, {\n      onComment: function onComment(_isBlock, _test, start, end) {\n        magicString.remove(start, end);\n      },\n      onToken: function onToken(token) {\n        magicString.addSourcemapLocation(token.start); // const wsStart = lastToken ? lastToken.end : 0;\n        // if (wsStart < token.start - 1) {\n        //   const between = magicString.original.substring(wsStart, token.start);\n        //   if (whitespaceRx.test(between)) {\n        //     magicString.overwrite(wsStart, token.start - 1, ' ');\n        //   }\n        // }\n        // lastToken = token;\n      }\n    });\n    traverse(ast, ctx, scopingAndRequiresVisitor);\n    traverse(ast, ctx, collectGlobalsVisitor);\n  } catch (err) {\n    throw new Error(\"Error parsing \".concat(uri, \": \").concat(err.message));\n  }\n\n  var requireDependencies = [];\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = ctx.requires[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var node = _step.value;\n      requireDependencies.push({\n        callee: _objectSpread({}, node.callee),\n        spec: _objectSpread({}, node.spec)\n      });\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  var requireResolveDependencies = [];\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = ctx.requireResolves[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var _node = _step2.value;\n      requireResolveDependencies.push({\n        callee: _objectSpread({}, _node.callee),\n        spec: _objectSpread({}, _node.spec)\n      });\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  var unboundSymbols = new Map();\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    for (var _iterator3 = ctx.unboundSymbols[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      var _ref4 = _step3.value;\n\n      var _ref3 = _slicedToArray(_ref4, 2);\n\n      var symbolName = _ref3[0];\n      var symbolNodes = _ref3[1];\n      unboundSymbols.set(symbolName, symbolNodes.map(function (node) {\n        return {\n          start: node.start,\n          end: node.end\n        };\n      }));\n    }\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  return {\n    requireDependencies: requireDependencies,\n    requireResolveDependencies: requireResolveDependencies,\n    unboundSymbols: unboundSymbols\n  };\n}\n\nvar scopingAndRequiresVisitor = {\n  enter: function enter(node, parent, ctx) {\n    if (ctx.skip.has(node)) {\n      return this.skip();\n    }\n\n    visitAndCaptureScoping(node, parent, ctx);\n    visitAndSkipBranches(node, parent, ctx);\n    visitRequires(node, parent, ctx);\n  }\n};\nvar collectGlobalsVisitor = {\n  enter: function enter(node, _parent, ctx) {\n    if (isBindingIdentifier(node) && isIdentifier(node)) {\n      var name = node.name;\n      if (name === 'undefined') return;\n      var foundBinding = false;\n      var nextParent = node.parent;\n\n      while (nextParent) {\n        if (name === 'arguments' && declaresArguments(nextParent)) {\n          foundBinding = true;\n          break;\n        }\n\n        var locals = ctx.locals.get(nextParent);\n\n        if (locals && locals[name]) {\n          foundBinding = true;\n          break;\n        }\n\n        nextParent = nextParent.parent;\n      }\n\n      if (!foundBinding && isNodeWithStartAndEnd(node)) {\n        var unboundSymbols = ctx.unboundSymbols.get(name);\n\n        if (!unboundSymbols) {\n          unboundSymbols = [];\n          ctx.unboundSymbols.set(name, unboundSymbols);\n        }\n\n        unboundSymbols.push(node);\n      }\n    } else if (isThisExpression(node)) {\n      var _foundBinding = false;\n      var _nextParent = node.parent;\n\n      while (_nextParent) {\n        if (declaresThis(_nextParent)) {\n          _foundBinding = true;\n          break;\n        }\n\n        _nextParent = _nextParent.parent;\n      }\n\n      if (!_foundBinding && isNodeWithStartAndEnd(node)) {\n        var _unboundSymbols = ctx.unboundSymbols.get('this');\n\n        if (!_unboundSymbols) {\n          _unboundSymbols = [];\n          ctx.unboundSymbols.set('this', _unboundSymbols);\n        }\n\n        _unboundSymbols.push(node);\n      }\n    }\n  }\n};\n\nfunction visitAndCaptureScoping(node, _parent, ctx) {\n  if (isVariableDeclaration(node)) {\n    var parent;\n    var nextParent = node.parent;\n\n    while (nextParent) {\n      if (node.kind === 'var' ? isScope(nextParent) : isBlockScope(nextParent)) {\n        parent = nextParent;\n        break;\n      }\n\n      nextParent = nextParent.parent;\n    }\n\n    if (!parent) {\n      throw new Error(\"Invariant violation: Failed to find a parent\");\n    }\n\n    var locals = ctx.locals.get(parent);\n\n    if (!locals) {\n      locals = {};\n      ctx.locals.set(parent, locals);\n    }\n\n    var _iteratorNormalCompletion4 = true;\n    var _didIteratorError4 = false;\n    var _iteratorError4 = undefined;\n\n    try {\n      for (var _iterator4 = node.declarations[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n        var declaration = _step4.value;\n        declarePattern(declaration.id, locals);\n      }\n    } catch (err) {\n      _didIteratorError4 = true;\n      _iteratorError4 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n          _iterator4.return();\n        }\n      } finally {\n        if (_didIteratorError4) {\n          throw _iteratorError4;\n        }\n      }\n    }\n  } else if (isFunctionDeclaration(node)) {\n    var _parent2;\n\n    var _nextParent2 = node.parent;\n\n    if (_nextParent2 && _nextParent2.parent) {\n      _nextParent2 = _nextParent2.parent;\n    }\n\n    while (_nextParent2) {\n      if (isScope(_nextParent2)) {\n        _parent2 = _nextParent2;\n        break;\n      }\n\n      _nextParent2 = _nextParent2.parent;\n    }\n\n    if (!_parent2) {\n      throw new Error(\"Invariant violation: Failed to find a parent\");\n    }\n\n    var _locals = ctx.locals.get(_parent2);\n\n    if (!_locals) {\n      _locals = {};\n      ctx.locals.set(_parent2, _locals);\n    }\n\n    declareFunction(node, _locals);\n  } else if (isFunction(node)) {\n    var _locals2 = ctx.locals.get(node);\n\n    if (!_locals2) {\n      _locals2 = {};\n      ctx.locals.set(node, _locals2);\n    }\n\n    declareFunction(node, _locals2);\n  } else if (isClassDeclaration(node) && node.id) {\n    var _parent3;\n\n    var _nextParent3 = node.parent;\n\n    if (_nextParent3 && _nextParent3.parent) {\n      _nextParent3 = _nextParent3.parent;\n    }\n\n    while (_nextParent3) {\n      if (isScope(_nextParent3)) {\n        _parent3 = _nextParent3;\n        break;\n      }\n\n      _nextParent3 = _nextParent3.parent;\n    }\n\n    if (!_parent3) {\n      throw new Error(\"Invariant violation: Failed to find a parent\");\n    }\n\n    var _locals3 = ctx.locals.get(_parent3);\n\n    if (!_locals3) {\n      _locals3 = {};\n      ctx.locals.set(_parent3, _locals3);\n    }\n\n    _locals3[node.id.name] = true;\n  } else if (isTryStatement(node)) {\n    if (node.handler) {\n      var _locals4 = ctx.locals.get(node.handler);\n\n      if (!_locals4) {\n        _locals4 = {};\n        ctx.locals.set(node.handler, _locals4);\n      }\n\n      declarePattern(node.handler.param, _locals4);\n    }\n  }\n}\n\nfunction visitAndSkipBranches(node, _parent, ctx) {\n  if (isIfStatement(node) && isBinaryExpression(node.test)) {\n    var tests = {\n      '!=': function _(l, r) {\n        return l != r;\n      },\n      '!==': function _(l, r) {\n        return l !== r;\n      },\n      '==': function _(l, r) {\n        return l == r;\n      },\n      '===': function _(l, r) {\n        return l === r;\n      }\n    };\n    var test = tests[node.test.operator];\n\n    if (test) {\n      if (isStringLiteral(node.test.left) && isMemberExpression(node.test.right) && memberExpressionMatches(node.test.right, 'process.env.NODE_ENV')) {\n        // if ('development' === process.env.NODE_ENV) {}\n        ctx.replacements.push({\n          start: node.test.right.start,\n          end: node.test.right.end,\n          replacement: JSON.stringify(ctx.nodeEnv)\n        });\n\n        if (!test(node.test.left.value, ctx.nodeEnv)) {\n          ctx.skip.add(node.consequent);\n        } else if (node.alternate) {\n          ctx.skip.add(node.alternate);\n        }\n      } else if (isStringLiteral(node.test.right) && isMemberExpression(node.test.left) && memberExpressionMatches(node.test.left, 'process.env.NODE_ENV')) {\n        // if (process.env.NODE_ENV === 'development') {}\n        ctx.replacements.push({\n          start: node.test.left.start,\n          end: node.test.left.end,\n          replacement: JSON.stringify(ctx.nodeEnv)\n        });\n\n        if (!test(node.test.right.value, ctx.nodeEnv)) {\n          ctx.skip.add(node.consequent);\n        } else if (node.alternate) {\n          ctx.skip.add(node.alternate);\n        }\n      }\n    }\n  }\n}\n\nfunction visitRequires(node, _parent, ctx) {\n  if (isCallExpression(node) && isNodeWithStartAndEnd(node.callee)) {\n    var callee = node.callee;\n\n    if (isIdentifier(callee) && isNodeWithStartAndEnd(callee) && callee.name === 'require') {\n      var firstArg = node.arguments[0];\n\n      if (isStringLiteral(firstArg) && isNodeWithStartAndEnd(firstArg)) {\n        ctx.requires.push({\n          spec: {\n            start: firstArg.start,\n            end: firstArg.end,\n            value: firstArg.value\n          },\n          callee: {\n            start: callee.start,\n            end: callee.end\n          }\n        });\n      } else {\n        console.warn('Non string-literal first arg to require', firstArg);\n      }\n    } else if (isMemberExpression(callee) && isIdentifier(callee.object) && callee.object.name === 'require' && isIdentifier(callee.property) && callee.property.name === 'resolve') {\n      var _firstArg = node.arguments[0];\n\n      if (isStringLiteral(_firstArg) && isNodeWithStartAndEnd(_firstArg)) {\n        ctx.requireResolves.push({\n          spec: {\n            start: _firstArg.start,\n            end: _firstArg.end,\n            value: _firstArg.value\n          },\n          callee: {\n            start: callee.start,\n            end: callee.end\n          }\n        });\n      } else {\n        console.warn('Non string-literal first arg to require.resolve', _firstArg);\n      }\n    }\n  }\n}\n\nfunction declareFunction(node, locals) {\n  node.params.forEach(function (node) {\n    declarePattern(node, locals);\n  });\n\n  if (node.id) {\n    locals[node.id.name] = true;\n  }\n}\n\nfunction declarePattern(node, locals) {\n  if (isIdentifier(node)) {\n    locals[node.name] = true;\n  } else if (isObjectPattern(node)) {\n    node.properties.forEach(function (node) {\n      return declarePattern(node.value, locals);\n    });\n  } else if (isArrayPattern(node)) {\n    node.elements.forEach(function (node) {\n      return node && declarePattern(node, locals);\n    });\n  } else if (isRestElement(node)) {\n    declarePattern(node.argument, locals);\n  } else if (isAssignmentPattern(node)) {\n    declarePattern(node.left, locals);\n  } else {\n    throw new Error(\"Invariant violation: Unexpected pattern type: \".concat(node.type));\n  }\n}\n\nfunction isBindingIdentifier(node) {\n  return isIdentifier(node) && !isPropertyOfMemberExpression(node) && !isKeyOfProperty(node);\n}\n\nfunction isKeyOfProperty(node) {\n  return node.parent && isProperty(node.parent) && node.parent.key === node;\n}\n\nfunction isPropertyOfMemberExpression(node) {\n  return node.parent && isMemberExpression(node.parent) && node.parent.object !== node;\n}\n\nfunction isScope(node) {\n  return isFunctionDeclaration(node) || isFunctionExpression(node) || isArrowFunctionExpression(node) || isProgram(node);\n}\n\nfunction isBlockScope(node) {\n  return isBlockStatement(node) || isScope(node);\n}\n\nfunction declaresArguments(node) {\n  return isFunctionDeclaration(node) || isFunctionExpression(node);\n}\n\nfunction declaresThis(node) {\n  return isFunctionDeclaration(node) || isFunctionExpression(node);\n}\n\nfunction memberExpressionMatches(node, pattern) {\n  var memberParts = pattern.split('.');\n\n  if (memberParts.length < 2) {\n    return false;\n  }\n\n  var object = memberParts.shift();\n  var property = memberParts.shift();\n\n  for (var i = memberParts.length - 1; i >= 0; i--) {\n    if (!isIdentifier(node.property) || node.property.name !== memberParts[i]) {\n      return false;\n    }\n\n    if (!isMemberExpression(node.object)) {\n      return false;\n    }\n\n    node = node.object;\n  }\n\n  if (!isIdentifier(node.object) || !isIdentifier(node.property)) {\n    return false;\n  }\n\n  return node.object.name === object && node.property.name === property;\n}\n\nvar Asset =\n/*#__PURE__*/\nfunction () {\n  function Asset(href, rootHref) {\n    _classCallCheck(this, Asset);\n\n    this.href = href;\n    this.rootHref = rootHref;\n    this.dependencies = [];\n    this.unresolvedDependencies = {};\n    this.deps = new Map();\n  }\n\n  _createClass(Asset, [{\n    key: \"setCode\",\n    value: function setCode(code) {\n      this.magicString = new MagicString(code, {\n        filename: this.href,\n        indentExclusionRanges: []\n      });\n      this.sourceMappingUrl = getSourceMappingUrl(code);\n      var parser = getParserForAsset(this);\n      var dependencies = parser.parse(this.href, this.magicString);\n      this.unresolvedDependencies.requireDependencies = dependencies.requireDependencies;\n      this.unresolvedDependencies.requireResolveDependencies = dependencies.requireResolveDependencies;\n      this.unresolvedDependencies.unboundSymbols = dependencies.unboundSymbols;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        href: this.href,\n        rootHref: this.rootHref,\n        dependencies: this.dependencies,\n        sourceMappingUrl: this.sourceMappingUrl,\n        code: this.magicString ? this.magicString.original : ''\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      var _asset$dependencies;\n\n      var asset = new Asset(json.href, json.rootHref);\n\n      (_asset$dependencies = asset.dependencies).push.apply(_asset$dependencies, _toConsumableArray(json.dependencies));\n\n      asset.sourceMappingUrl = json.sourceMappingUrl;\n      asset.setCode(json.code);\n      return asset;\n    }\n  }]);\n\n  return Asset;\n}();\n\n(function (Asset) {\n  var DependencyKind;\n\n  (function (DependencyKind) {\n    DependencyKind[\"Require\"] = \"require\";\n    DependencyKind[\"RequireResolve\"] = \"require.resolve\";\n    DependencyKind[\"InjectedGlobal\"] = \"injected_global\";\n  })(DependencyKind = Asset.DependencyKind || (Asset.DependencyKind = {}));\n})(Asset || (Asset = {}));\n\nfunction getParserForAsset(asset) {\n  if (asset.href.endsWith('.css')) {\n    return {\n      parse: function parse(_href, magicString) {\n        var cssCode = magicString.original;\n        var BACKSLASH = '\\\\'.charCodeAt(0);\n        var SINGLE_QUOTE = \"'\".charCodeAt(0);\n        var NL = '\\n'.charCodeAt(0);\n        var CR = '\\r'.charCodeAt(0);\n        var escaped = false;\n\n        for (var i = 0; i < cssCode.length; i++) {\n          var char = cssCode.charCodeAt(i);\n\n          if (char === BACKSLASH) {\n            escaped = !escaped;\n            continue;\n          }\n\n          if (!escaped) {\n            // Escape certain characters (if not already escaped)\n            switch (char) {\n              case CR:\n              case NL:\n                magicString.overwrite(i, i + 1, ' ');\n                break;\n\n              case SINGLE_QUOTE:\n                magicString.prependRight(i, '\\\\');\n                break;\n            }\n          }\n\n          escaped = false;\n        }\n\n        magicString.prepend(\"\\n          function reload(){\\n            var styleTag = document.createElement(\\\"style\\\");\\n            styleTag.type = \\\"text/css\\\";\\n            styleTag.innerHTML = '\");\n        magicString.append(\"';\\n            document.head.appendChild(styleTag);\\n\\n            return function() {    \\n              if (styleTag && styleTag.parentElement) {\\n                styleTag.parentElement.removeChild(styleTag);\\n              }\\n            };\\n          };\\n\\n          var remove = reload();\\n\\n          // if (module.hot && module.hot.accept) {\\n          //   module.hot.accept(function() {\\n          //     require(\".concat(JSON.stringify(asset.href), \");\\n          //   });\\n          // }\\n          if (module.hot && module.hot.dispose) {\\n            module.hot.dispose(function() {\\n              remove();\\n            });\\n          }\\n        \"));\n        return {\n          requireDependencies: [],\n          requireResolveDependencies: [],\n          unboundSymbols: new Map()\n        };\n      }\n    };\n  }\n\n  if (asset.href.endsWith('.json')) {\n    return {\n      parse: function parse(_href, magicString) {\n        magicString.prepend('module.exports = ');\n        return {\n          requireDependencies: [],\n          requireResolveDependencies: [],\n          unboundSymbols: new Map()\n        };\n      }\n    };\n  }\n\n  return {\n    parse: parseFile\n  };\n}\n\nvar version = \"0.25.0\"; // const BARE_MODULE_PREFIX = 'https://unpkg.com/';\n// const DEFAULT_SHIM_GLOBALS: { [key: string]: { spec: string; export?: string } } = {\n//   Buffer: {\n//     spec: `@velcro/node-libs@${nodeLibsVersion}/lib/buffer.js`,\n//     export: 'Buffer',\n//   },\n//   global: {\n//     spec: `@velcro/node-libs@${nodeLibsVersion}/lib/global.js`,\n//   },\n//   process: {\n//     spec: `@velcro/node-libs@${nodeLibsVersion}/lib/process.js`,\n//   },\n// };\n\nvar NODE_CORE_SHIMS = ['assert', 'buffer', 'constants', 'crypto', 'events', 'fs', 'http', 'https', 'net', 'os', 'path', 'process', 'querystring', 'stream', 'tls', 'url', 'util', 'vm', 'zlib'].reduce(function (shims, coreLibName) {\n  return Object.assign(shims, _defineProperty({}, coreLibName, \"@velcro/node-libs@\".concat(version, \"/lib/\").concat(coreLibName, \".js\")));\n}, {});\nNODE_CORE_SHIMS['string_decoder'] = 'string_decoder@1.2.0';\nNODE_CORE_SHIMS['punycode'] = 'punycode@2.1.1';\n\nvar resolveBareModuleToUnpkgWithDetails =\n/*#__PURE__*/\nfunction () {\n  var _ref5 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(resolver, resolveBareModule, href, parentHref) {\n    var _ref6,\n        syntheticDependencies,\n        token,\n        parsedSpec,\n        details,\n        resolvedSpecRoot,\n        unresolvedHref,\n        parentUrl,\n        parentPackageInfo,\n        consolidatedDependencies,\n        builtIn,\n        parsedBuiltInSpec,\n        stableUrl,\n        stableRootUrl,\n        resolveResult,\n        packageInfo,\n        _args = arguments;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _ref6 = _args.length > 4 && _args[4] !== undefined ? _args[4] : {}, syntheticDependencies = _ref6.syntheticDependencies, token = _ref6.token;\n            parsedSpec = parseBareModuleSpec(href);\n            details = {\n              bareModule: {},\n              resolvedUrl: undefined\n            }; // let resolvedSpec: string | undefined = undefined;\n\n            resolvedSpecRoot = undefined;\n            unresolvedHref = undefined;\n\n            if (!parsedSpec.spec) {\n              _context.next = 9;\n              break;\n            }\n\n            // A manually-specified spec means we should use that instead of looking for a parent package.json\n            resolvedSpecRoot = parsedSpec.nameSpec;\n            _context.next = 32;\n            break;\n\n          case 9:\n            if (!(syntheticDependencies && parsedSpec.name in syntheticDependencies)) {\n              _context.next = 13;\n              break;\n            }\n\n            resolvedSpecRoot = \"\".concat(parsedSpec.name, \"@\").concat(syntheticDependencies[parsedSpec.name]);\n            _context.next = 32;\n            break;\n\n          case 13:\n            if (!parentHref) {\n              _context.next = 32;\n              break;\n            }\n\n            _context.prev = 14;\n            parentUrl = new URL(parentHref);\n            _context.next = 21;\n            break;\n\n          case 18:\n            _context.prev = 18;\n            _context.t0 = _context[\"catch\"](14);\n            throw new Error(\"Error loading bare module \".concat(href, \" because the parent module \").concat(parentHref, \" could not be resolved to a URL\"));\n\n          case 21:\n            _context.prev = 21;\n            _context.next = 24;\n            return resolver.readParentPackageJson(parentUrl, {\n              token: token\n            });\n\n          case 24:\n            parentPackageInfo = _context.sent;\n\n            if (parentPackageInfo) {\n              consolidatedDependencies = _objectSpread({}, parentPackageInfo.packageJson.peerDependencies || {}, {}, parentPackageInfo.packageJson.devDependencies || {}, {}, parentPackageInfo.packageJson.dependencies || {});\n              details.bareModule.versionSpec = consolidatedDependencies[parsedSpec.name];\n\n              if (details.bareModule.versionSpec) {\n                resolvedSpecRoot = \"\".concat(parsedSpec.name, \"@\").concat(details.bareModule.versionSpec);\n              }\n            }\n\n            _context.next = 32;\n            break;\n\n          case 28:\n            _context.prev = 28;\n            _context.t1 = _context[\"catch\"](21);\n\n            if (!(_context.t1 instanceof CanceledError || _context.t1.name === 'CanceledError')) {\n              _context.next = 32;\n              break;\n            }\n\n            throw _context.t1;\n\n          case 32:\n            if (resolvedSpecRoot) {\n              // The name + spec was hard-coded or could be derived from a parent package.json. We just\n              // need to prepend the staic prefix and then append the requested pathname.\n              resolvedSpecRoot = resolveBareModule(resolvedSpecRoot).href;\n              unresolvedHref = \"\".concat(resolvedSpecRoot).concat(parsedSpec.pathname);\n            } else {\n              if (!parentHref) {\n                // There was no parent href from which to derive version constraints so we will take\n                // the provided 'namespec' and prefix it with the static prefix. That will be the root\n                // and the href can be determined by adding the requested pathname.\n                resolvedSpecRoot = resolveBareModule(\"\".concat(parsedSpec.nameSpec)).href;\n                unresolvedHref = resolveBareModule(\"\".concat(parsedSpec.nameSpec), parsedSpec.pathname).href;\n              } else {\n                builtIn = NODE_CORE_SHIMS[href];\n\n                if (builtIn) {\n                  parsedBuiltInSpec = parseBareModuleSpec(builtIn);\n                  resolvedSpecRoot = resolveBareModule(parsedBuiltInSpec.nameSpec).href;\n                  unresolvedHref = resolveBareModule(parsedBuiltInSpec.nameSpec, parsedBuiltInSpec.pathname).href;\n                  details.bareModule.isBuiltIn = true;\n                }\n              }\n            }\n\n            if (!(unresolvedHref && resolvedSpecRoot)) {\n              _context.next = 44;\n              break;\n            }\n\n            stableUrl = new URL(unresolvedHref);\n            stableRootUrl = new URL(resolvedSpecRoot);\n            _context.next = 38;\n            return resolver.resolve(stableUrl, {\n              token: token\n            });\n\n          case 38:\n            resolveResult = _context.sent;\n            details.ignored = resolveResult.ignored;\n            details.stableRootUrl = stableRootUrl;\n            details.stableUrl = stableUrl;\n\n            if (resolveResult.resolvedUrl) {\n              details.resolvedUrl = resolveResult.resolvedUrl;\n            }\n\n            details.rootUrl = resolveResult.rootUrl;\n\n          case 44:\n            if (!details.resolvedUrl) {\n              _context.next = 49;\n              break;\n            }\n\n            _context.next = 47;\n            return resolver.readParentPackageJson(details.resolvedUrl, {\n              token: token\n            });\n\n          case 47:\n            packageInfo = _context.sent;\n\n            if (packageInfo) {\n              details.bareModule.version = packageInfo.packageJson.version;\n            }\n\n          case 49:\n            return _context.abrupt(\"return\", details);\n\n          case 50:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[14, 18], [21, 28]]);\n  }));\n\n  return function resolveBareModuleToUnpkgWithDetails(_x, _x2, _x3, _x4) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nvar ExtendableError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(ExtendableError, _Error);\n\n  function ExtendableError(message) {\n    var _this2;\n\n    _classCallCheck(this, ExtendableError);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(ExtendableError).call(this, message));\n    _this2.name = _this2.constructor.name;\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(_assertThisInitialized(_this2), _this2.constructor);\n    } else {\n      _this2.stack = new Error(message).stack;\n    }\n\n    return _this2;\n  }\n\n  return ExtendableError;\n}(_wrapNativeSuper(Error));\n\nvar InvariantViolation =\n/*#__PURE__*/\nfunction (_ExtendableError) {\n  _inherits(InvariantViolation, _ExtendableError);\n\n  function InvariantViolation() {\n    _classCallCheck(this, InvariantViolation);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvariantViolation).apply(this, arguments));\n  }\n\n  return InvariantViolation;\n}(ExtendableError);\n\nvar ResolveError =\n/*#__PURE__*/\nfunction (_ExtendableError2) {\n  _inherits(ResolveError, _ExtendableError2);\n\n  function ResolveError(href, fromHref) {\n    var _this3;\n\n    _classCallCheck(this, ResolveError);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(ResolveError).call(this, \"Unable to resolve '\".concat(href, \"'\").concat(fromHref ? \" from '\".concat(fromHref, \"'\") : '')));\n    _this3.href = href;\n    _this3.fromHref = fromHref;\n    return _this3;\n  }\n\n  return ResolveError;\n}(ExtendableError); //@ts-check\n\n/**\n *\n * @param {import('./types').ImmediateExecutionManifest} manifest\n * @param {import('./types').RuntimeOptions} [options]\n * @returns {import('./types').IRuntime}\n */\n\n\nfunction createRuntime(manifest, options) {\n  /** @type {Record<string, string | undefined>} */\n  var aliases = Object.create(null);\n  /** @type {Record<string, Record<string, string | undefined> | undefined> } */\n\n  var mappings = Object.create(null);\n  /** @type {Record<string, Module | undefined>} */\n\n  var modules = Object.create(null);\n  /** @type {Record<string, import('./types').ModuleFactory | undefined>} */\n\n  var registry = Object.create(null);\n  /**\n   * @class\n   * @implements {import('./types').IRuntime}\n   * @property {Module} root\n   */\n\n  function Runtime() {\n    /**\n     * @readonly\n     */\n    this.root = new Module('velcro://root', this);\n    var self = this;\n    this.register('@@runtime', function (module) {\n      module.exports = self;\n    });\n  }\n  /**\n   * @param {string} name\n   * @param {string} id\n   */\n\n\n  Runtime.prototype.alias = function (name, id) {\n    aliases[name] = id;\n  };\n  /**\n   * @param {string} fromId\n   * @param {string} spec\n   * @param {string} toId\n   */\n\n\n  Runtime.prototype.dependency = function (fromId, spec, toId) {\n    var mappingsForId = mappings[fromId];\n\n    if (!mappingsForId) {\n      mappingsForId = {};\n      mappings[fromId] = mappingsForId;\n    }\n\n    mappingsForId[spec] = toId;\n  };\n  /**\n   * @param {string} id\n   */\n\n\n  Runtime.prototype.get = function (id) {\n    id = aliases[id] || id;\n    return modules[id];\n  };\n  /**\n   * @param {string} fromId\n   * @param {string} spec\n   * @returns {string}\n   */\n\n\n  Runtime.prototype.getId = function (fromId, spec) {\n    var alias = aliases[spec];\n\n    if (alias) {\n      return alias;\n    }\n\n    var mappingsForId = mappings[fromId];\n    return mappingsForId && mappingsForId[spec] || spec;\n  };\n  /**\n   * @param {import('./types').ImmediateExecutionManifest} manifest\n   * @param {boolean} [executeEntrypoints]\n   */\n\n\n  Runtime.prototype.init = function (manifest, executeEntrypoints) {\n    for (var href in manifest.modules) {\n      var module = manifest.modules[href];\n\n      for (var alias in module.dependencies) {\n        this.dependency(href, alias, module.dependencies[alias]);\n      }\n\n      this.register(href, module.factory);\n    }\n\n    for (var _alias in manifest.aliases) {\n      this.alias(_alias, manifest.aliases[_alias]);\n    }\n\n    for (var entrypoint in manifest.entrypoints) {\n      this.alias(entrypoint, manifest.entrypoints[entrypoint]);\n\n      if (executeEntrypoints) {\n        this.require(entrypoint);\n      }\n    }\n  };\n  /**\n   * @param {string} id\n   * @param {import('./types').ModuleFactory} factory\n   */\n\n\n  Runtime.prototype.register = function (id, factory) {\n    registry[id] = factory;\n  };\n  /**\n   * @param {string} id\n   * @returns {Module | undefined}\n   */\n\n\n  Runtime.prototype.remove = function (id) {\n    var module = this.get(id);\n\n    if (!module) {\n      return;\n    }\n\n    module.dependents.forEach(function (dependent) {\n      dependent.dependencies.delete(module);\n    });\n    module.dependencies.forEach(function (dependency) {\n      dependency.dependents.delete(module);\n    });\n    delete modules[module.id];\n    delete mappings[module.id];\n    delete registry[module.id];\n    return module;\n  };\n  /**\n   * @param {string} id\n   */\n\n\n  Runtime.prototype.require = function (id) {\n    return this.root.require(aliases[id] || id);\n  };\n  /**\n   * @class\n   * @param {Module} module\n   */\n\n\n  function HotModule(module) {\n    /** @private */\n    this.module = module;\n  }\n  /**\n   * @param {() => void} cb\n   */\n\n\n  HotModule.prototype.accept = function (cb) {\n    this.module.acceptCallbacks.push({\n      cb: cb\n    });\n  };\n  /**\n   * @param {() => void} cb\n   */\n\n\n  HotModule.prototype.dispose = function (cb) {\n    this.module.disposeCallbacks.push({\n      cb: cb\n    });\n  };\n  /**\n   * @class\n   * @param {string} id\n   * @param {Runtime} runtime\n   */\n\n\n  function Module(id, runtime) {\n    /** @type {Set<Module>} */\n    this.dependencies = new Set();\n    /** @type {Set<Module>} */\n\n    this.dependents = new Set();\n    this.id = id;\n    /** @type {import('./types').AcceptCallback[]} */\n\n    this.acceptCallbacks = [];\n    /** @type {import('./types').DisposeCallback[]} */\n\n    this.disposeCallbacks = [];\n    /** @readonly */\n\n    this.module = Object.seal({\n      exports: {},\n      id: id,\n      hot: new HotModule(this)\n    });\n    /** @readonly */\n\n    this.runtime = runtime;\n    Object.defineProperty(this, Symbol.toStringTag, {\n      configurable: false,\n      enumerable: false,\n      get: function get() {\n        return 'Module';\n      }\n    });\n  }\n  /**\n   * @param {string} id\n   */\n\n\n  Module.prototype.require = function (id) {\n    id = this.runtime.getId(this.id, id);\n    /** @type {Module | undefined} */\n\n    var module = modules[id];\n\n    if (!module) {\n      var factory = registry[id];\n\n      if (!factory) {\n        throw new Error(\"Factory missing for \".concat(id));\n      }\n\n      module = new Module(id, this.runtime);\n      modules[id] = module; // Free up the registry entry and release any refs for GC\n\n      delete registry[id];\n      var dirname = id;\n      var filename = id;\n      factory.call(module.module.exports, module.module, module.module.exports, module.require.bind(module), dirname, filename);\n    } // In a hot reload scenario there may be two generations\n    // of the same module. Don't record these dependencies.\n\n\n    if (module.id !== this.id) {\n      module.dependents.add(this);\n      this.dependencies.add(module);\n    }\n\n    return module.module.exports;\n  }; //@ts-ignore\n\n\n  var runtime = options && options.runtime && window[options.runtime] || new Runtime();\n  runtime.init(manifest, options && options.executeEntrypoints);\n  return runtime;\n}\n\nvar Bundle =\n/*#__PURE__*/\nfunction () {\n  function Bundle(assets, entrypointsToAssets, dependenciesToAssets) {\n    _classCallCheck(this, Bundle);\n\n    this.assets = assets;\n    this.entrypointsToAssets = entrypointsToAssets;\n    this.dependenciesToAssets = dependenciesToAssets;\n    this.assetsByHref = new Map();\n    var _iteratorNormalCompletion5 = true;\n    var _didIteratorError5 = false;\n    var _iteratorError5 = undefined;\n\n    try {\n      for (var _iterator5 = assets[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n        var asset = _step5.value;\n        this.assetsByHref.set(asset.href, asset);\n      }\n    } catch (err) {\n      _didIteratorError5 = true;\n      _iteratorError5 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n          _iterator5.return();\n        }\n      } finally {\n        if (_didIteratorError5) {\n          throw _iteratorError5;\n        }\n      }\n    }\n  }\n\n  _createClass(Bundle, [{\n    key: \"buildForImmediateExecution\",\n    value: function buildForImmediateExecution() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var bundle = new Bundle$1({\n        separator: '\\n\\t\\t,\\n'\n      });\n      var _iteratorNormalCompletion6 = true;\n      var _didIteratorError6 = false;\n      var _iteratorError6 = undefined;\n\n      try {\n        for (var _iterator6 = this.assets[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n          var asset = _step6.value;\n          bundle.addSource(buildAssetForImmediateExecution(asset));\n        }\n      } catch (err) {\n        _didIteratorError6 = true;\n        _iteratorError6 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion6 && _iterator6.return != null) {\n            _iterator6.return();\n          }\n        } finally {\n          if (_didIteratorError6) {\n            throw _iteratorError6;\n          }\n        }\n      }\n\n      var aliasMap = Array.from(this.dependenciesToAssets).reduce(function (acc, _ref7) {\n        var _ref8 = _slicedToArray(_ref7, 2),\n            name = _ref8[0],\n            asset = _ref8[1];\n\n        acc[name] = asset.href;\n        return acc;\n      }, {});\n      var entrypointMap = Array.from(this.entrypointsToAssets).reduce(function (acc, _ref9) {\n        var _ref10 = _slicedToArray(_ref9, 2),\n            name = _ref10[0],\n            asset = _ref10[1];\n\n        acc[name] = asset.href;\n        return acc;\n      }, {});\n      var runtimeOptions = {\n        executeEntrypoints: options.executeEntrypoints,\n        runtime: options.runtime\n      };\n      bundle.prepend(\"(\".concat(createRuntime.toString(), \")({\\n\\taliases:\").concat(JSON.stringify(aliasMap), \",\\n\\tentrypoints:\").concat(JSON.stringify(entrypointMap), \",\\n\\tmodules:{\\n\"));\n      bundle.append(\"\\n\\t}\\n}, \".concat(JSON.stringify(runtimeOptions), \");\"));\n      var code = bundle.toString();\n      var sourceMap = options.sourceMap ? this.generateSourceMap(bundle, '') : undefined;\n      return {\n        code: code,\n        sourceMap: sourceMap\n      };\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var _this$buildForImmedia = this.buildForImmediateExecution(options),\n          code = _this$buildForImmedia.code,\n          sourceMap = _this$buildForImmedia.sourceMap;\n\n      return code + (sourceMap ? \"\\n//# sourceMappingURL=\".concat(sourceMap.toDataUri()) : '');\n    }\n  }, {\n    key: \"generateSourceMap\",\n    value: function generateSourceMap(bundle, href) {\n      var _this4 = this;\n\n      var inputMap = bundle.generateMap({\n        includeContent: true,\n        hires: false,\n        source: href\n      }); // In case a source map seems to be self-referential, avoid crashing\n\n      var seen = new Set();\n      return new SourceMap(remapping(inputMap.toString(), function (uri) {\n        var asset = _this4.assetsByHref.get(uri);\n\n        if (asset && asset.sourceMappingUrl) {\n          if (seen.has(asset)) {\n            return null;\n          }\n\n          seen.add(asset);\n          var match = asset.sourceMappingUrl.match(/^data:application\\/json;(?:charset=([^;]+);)?base64,(.*)$/);\n\n          if (match) {\n            if (match[1] && match[1] !== 'utf-8') {\n              return null;\n            }\n\n            try {\n              var decoded = JSON.parse(Base64.decode(match[2]));\n              return decoded;\n            } catch (err) {\n              return null;\n            }\n          }\n        }\n\n        return null;\n      }, false));\n    }\n  }]);\n\n  return Bundle;\n}();\n\nvar SourceMap =\n/*#__PURE__*/\nfunction () {\n  function SourceMap(input) {\n    _classCallCheck(this, SourceMap);\n\n    this.file = input.file;\n    this.mappings = input.mappings;\n    this.sourceRoot = input.sourceRoot;\n    this.names = input.names;\n    this.sources = input.sources;\n    this.sourcesContent = input.sourcesContent;\n    this.version = input.version;\n  }\n\n  _createClass(SourceMap, [{\n    key: \"toString\",\n    value: function toString() {\n      return JSON.stringify(this);\n    }\n  }, {\n    key: \"toDataUri\",\n    value: function toDataUri() {\n      return \"data:application/json;charset=utf-8;base64,\".concat(Base64.encode(this.toString()));\n    }\n  }]);\n\n  return SourceMap;\n}();\n\nfunction buildAssetAndCollectDependencies(asset) {\n  var indent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '\\t';\n\n  if (!asset.magicString) {\n    throw new InvariantViolation(\"Invariant violation: asset is not loaded '\".concat(asset.href, \"'\"));\n  }\n\n  var dependencies = {};\n  var magicString = asset.magicString.clone();\n  magicString.trim();\n  magicString.indent(indent); // We'll replace each dependency string with the resolved stable href. The stable href doesn't require any\n  // information about where it is being resolved from, so it is useful as a long-term pointer whose target\n  // can change over time\n\n  var _iteratorNormalCompletion7 = true;\n  var _didIteratorError7 = false;\n  var _iteratorError7 = undefined;\n\n  try {\n    for (var _iterator7 = asset.dependencies[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n      var dependency = _step7.value;\n\n      switch (dependency.type) {\n        case Asset.DependencyKind.Require:\n          {\n            // magicString.overwrite(dependency.spec.start, dependency.spec.end, JSON.stringify(dependency.href));\n            // magicString.overwrite(dependency.callee.start, dependency.callee.end, '__velcro_require');\n            dependencies[dependency.spec.value] = dependency.href;\n            break;\n          }\n\n        case Asset.DependencyKind.RequireResolve:\n          {\n            // magicString.overwrite(dependency.spec.start, dependency.spec.end, JSON.stringify(dependency.href));\n            // magicString.overwrite(dependency.callee.start, dependency.callee.end, '__velcro_require_resolve');\n            dependencies[dependency.spec.value] = dependency.href;\n            break;\n          }\n\n        case Asset.DependencyKind.InjectedGlobal:\n          {\n            magicString.prepend(\"\\n\".concat(indent, \"const \").concat(dependency.symbolName, \" = require(\").concat(JSON.stringify(dependency.symbolName), \")\").concat(dependency.exportName ? \".\".concat(dependency.exportName) : '', \";\\n\"));\n            dependencies[dependency.symbolName] = dependency.href;\n            break;\n          }\n\n        default:\n          throw new Error(\"Invariant violation: Encountered unexpected dependency kind '\".concat(dependency.type, \"'\"));\n      }\n    }\n  } catch (err) {\n    _didIteratorError7 = true;\n    _iteratorError7 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion7 && _iterator7.return != null) {\n        _iterator7.return();\n      }\n    } finally {\n      if (_didIteratorError7) {\n        throw _iteratorError7;\n      }\n    }\n  }\n\n  return {\n    dependencies: dependencies,\n    magicString: magicString\n  };\n}\n\nfunction buildAssetForImmediateExecution(asset) {\n  var _buildAssetAndCollect = buildAssetAndCollectDependencies(asset, '\\t\\t\\t\\t'),\n      dependencies = _buildAssetAndCollect.dependencies,\n      magicString = _buildAssetAndCollect.magicString;\n\n  magicString.prepend(\"\\t\\t\".concat(JSON.stringify(asset.href), \": {\\n\\t\\t\\tdependencies: \").concat(JSON.stringify(dependencies), \",\\n\\t\\t\\tfactory: function(module, exports, require, __dirname, __filename){\\n\"));\n  magicString.append('\\n\\t\\t}}');\n  return magicString;\n}\n\nvar EMPTY_MODULE_URL = new URL('velcro://@empty');\nvar EMPTY_MODULE_CODE = 'module.exports = function(){};';\nvar DEFAULT_SHIM_GLOBALS = {\n  Buffer: {\n    spec: \"@velcro/node-libs@\".concat(version, \"/lib/buffer.js\"),\n    export: 'Buffer'\n  },\n  global: {\n    spec: \"@velcro/node-libs@\".concat(version, \"/lib/global.js\")\n  },\n  process: {\n    spec: \"@velcro/node-libs@\".concat(version, \"/lib/process.js\")\n  }\n};\n\nvar Bundler =\n/*#__PURE__*/\nfunction () {\n  function Bundler(options) {\n    _classCallCheck(this, Bundler);\n\n    this.assetsByHref = new Map(); // private readonly assetsByRootHref = new Map<string, Set<Asset>>();\n\n    this.pendingResolves = new Map();\n    this.onAssetAddedEmitter = new Emitter();\n    this.onAssetRemovedEmitter = new Emitter();\n    this.resolveBareModule = options.resolveBareModule;\n    this.resolver = options.resolver;\n  }\n\n  _createClass(Bundler, [{\n    key: \"dispose\",\n    value: function dispose() {\n      this.onAssetAddedEmitter.dispose();\n      this.onAssetRemovedEmitter.dispose();\n      this.assetsByHref.clear(); // this.assetsByRootHref.clear();\n\n      this.pendingResolves.clear();\n    }\n  }, {\n    key: \"getOrCreateAsset\",\n    value: function getOrCreateAsset(href, rootHref) {\n      var asset = this.assetsByHref.get(href);\n\n      if (!asset) {\n        asset = new Asset(href, rootHref);\n        this.assetsByHref.set(href, asset);\n        this.onAssetAddedEmitter.fire(asset);\n      }\n\n      return asset;\n    }\n  }, {\n    key: \"generateBundle\",\n    value: function () {\n      var _generateBundle = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(entrypoints) {\n        var _this5 = this;\n\n        var options,\n            tokenSource,\n            token,\n            pendingOperations,\n            assets,\n            dfd,\n            dependenciesToAssets,\n            entrypointsToAssets,\n            enqueue,\n            resolveDependencies,\n            resolveAsset,\n            _loop4,\n            name,\n            _loop5,\n            idx,\n            _args5 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                options = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {};\n\n                if (Array.isArray(entrypoints)) {\n                  _context5.next = 3;\n                  break;\n                }\n\n                throw new Error('Generating a bundle requires passing in an array of entrypoints');\n\n              case 3:\n                tokenSource = new CancellationTokenSource();\n                token = tokenSource.token;\n\n                if (options.token) {\n                  if (options.token.isCancellationRequested) {\n                    tokenSource.cancel();\n                    tokenSource.dispose();\n                  }\n\n                  options.token.onCancellationRequested(function () {\n                    tokenSource.cancel();\n                    tokenSource.dispose();\n                  });\n                }\n\n                pendingOperations = 0;\n                assets = new Set();\n                dfd = new Deferred(token);\n                dependenciesToAssets = new Map();\n                entrypointsToAssets = new Map();\n\n                enqueue =\n                /*#__PURE__*/\n                function () {\n                  var _ref11 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee2(op) {\n                    var result;\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            _context2.prev = 0;\n                            pendingOperations++;\n\n                            if (options.onEnqueueAsset) {\n                              options.onEnqueueAsset();\n                            }\n\n                            _context2.next = 5;\n                            return op();\n\n                          case 5:\n                            result = _context2.sent;\n\n                            if (options.onCompleteAsset) {\n                              options.onCompleteAsset();\n                            }\n\n                            pendingOperations--;\n\n                            if (!(pendingOperations < 0)) {\n                              _context2.next = 10;\n                              break;\n                            }\n\n                            throw new InvariantViolation('Pending operations fell below zero');\n\n                          case 10:\n                            if (pendingOperations === 0) {\n                              // Let's make sure this happens after the current microtask.\n                              setTimeout(function () {\n                                return dfd.resolve();\n                              }, 0);\n                            }\n\n                            return _context2.abrupt(\"return\", result);\n\n                          case 14:\n                            _context2.prev = 14;\n                            _context2.t0 = _context2[\"catch\"](0);\n\n                            // Let's make sure this happens 'later'.\n                            if (!dfd.isSettled) {\n                              Promise.resolve().then(function () {\n                                return dfd.reject(_context2.t0);\n                              }).catch(function (_) {\n                                return undefined;\n                              });\n                            }\n\n                            throw _context2.t0;\n\n                          case 18:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2, null, [[0, 14]]);\n                  }));\n\n                  return function enqueue(_x6) {\n                    return _ref11.apply(this, arguments);\n                  };\n                }();\n\n                resolveDependencies =\n                /*#__PURE__*/\n                function () {\n                  var _ref12 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee3(asset, code) {\n                    var _asset$dependencies2;\n\n                    var promises, _iteratorNormalCompletion8, _didIteratorError8, _iteratorError8, _loop, _iterator8, _step8, _ret, _iteratorNormalCompletion9, _didIteratorError9, _iteratorError9, _loop2, _iterator9, _step9, _iteratorNormalCompletion10, _didIteratorError10, _iteratorError10, _loop3, _iterator10, _step10, _ref14, dependencies;\n\n                    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                      while (1) {\n                        switch (_context3.prev = _context3.next) {\n                          case 0:\n                            asset.setCode(code);\n                            promises = [];\n                            _iteratorNormalCompletion8 = true;\n                            _didIteratorError8 = false;\n                            _iteratorError8 = undefined;\n                            _context3.prev = 5;\n\n                            _loop = function _loop() {\n                              var dependency = _step8.value;\n\n                              if (dependency.spec.value === '@@runtime') {\n                                return \"continue\";\n                              }\n\n                              promises.push(enqueue(function () {\n                                return resolveAsset(dependency.spec.value, asset.href);\n                              }).then(function (dependencyAsset) {\n                                return {\n                                  type: Asset.DependencyKind.Require,\n                                  href: dependencyAsset.href,\n                                  rootHref: dependencyAsset.rootHref,\n                                  callee: dependency.callee,\n                                  spec: dependency.spec,\n                                  value: dependency.spec.value\n                                };\n                              }));\n                            };\n\n                            _iterator8 = asset.unresolvedDependencies.requireDependencies[Symbol.iterator]();\n\n                          case 8:\n                            if (_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done) {\n                              _context3.next = 15;\n                              break;\n                            }\n\n                            _ret = _loop();\n\n                            if (!(_ret === \"continue\")) {\n                              _context3.next = 12;\n                              break;\n                            }\n\n                            return _context3.abrupt(\"continue\", 12);\n\n                          case 12:\n                            _iteratorNormalCompletion8 = true;\n                            _context3.next = 8;\n                            break;\n\n                          case 15:\n                            _context3.next = 21;\n                            break;\n\n                          case 17:\n                            _context3.prev = 17;\n                            _context3.t0 = _context3[\"catch\"](5);\n                            _didIteratorError8 = true;\n                            _iteratorError8 = _context3.t0;\n\n                          case 21:\n                            _context3.prev = 21;\n                            _context3.prev = 22;\n\n                            if (!_iteratorNormalCompletion8 && _iterator8.return != null) {\n                              _iterator8.return();\n                            }\n\n                          case 24:\n                            _context3.prev = 24;\n\n                            if (!_didIteratorError8) {\n                              _context3.next = 27;\n                              break;\n                            }\n\n                            throw _iteratorError8;\n\n                          case 27:\n                            return _context3.finish(24);\n\n                          case 28:\n                            return _context3.finish(21);\n\n                          case 29:\n                            _iteratorNormalCompletion9 = true;\n                            _didIteratorError9 = false;\n                            _iteratorError9 = undefined;\n                            _context3.prev = 32;\n\n                            _loop2 = function _loop2() {\n                              var dependency = _step9.value;\n                              promises.push(enqueue(function () {\n                                return resolveAsset(dependency.spec.value, asset.href);\n                              }).then(function (dependencyAsset) {\n                                return {\n                                  type: Asset.DependencyKind.RequireResolve,\n                                  href: dependencyAsset.href,\n                                  rootHref: dependencyAsset.rootHref,\n                                  callee: dependency.callee,\n                                  spec: dependency.spec,\n                                  value: dependency.spec.value\n                                };\n                              }));\n                            };\n\n                            for (_iterator9 = asset.unresolvedDependencies.requireResolveDependencies[Symbol.iterator](); !(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done); _iteratorNormalCompletion9 = true) {\n                              _loop2();\n                            }\n\n                            _context3.next = 41;\n                            break;\n\n                          case 37:\n                            _context3.prev = 37;\n                            _context3.t1 = _context3[\"catch\"](32);\n                            _didIteratorError9 = true;\n                            _iteratorError9 = _context3.t1;\n\n                          case 41:\n                            _context3.prev = 41;\n                            _context3.prev = 42;\n\n                            if (!_iteratorNormalCompletion9 && _iterator9.return != null) {\n                              _iterator9.return();\n                            }\n\n                          case 44:\n                            _context3.prev = 44;\n\n                            if (!_didIteratorError9) {\n                              _context3.next = 47;\n                              break;\n                            }\n\n                            throw _iteratorError9;\n\n                          case 47:\n                            return _context3.finish(44);\n\n                          case 48:\n                            return _context3.finish(41);\n\n                          case 49:\n                            _iteratorNormalCompletion10 = true;\n                            _didIteratorError10 = false;\n                            _iteratorError10 = undefined;\n                            _context3.prev = 52;\n\n                            _loop3 = function _loop3() {\n                              var _ref13 = _step10.value;\n                              _ref14 = _slicedToArray(_ref13, 2);\n                              var symbolName = _ref14[0];\n                              var references = _ref14[1];\n                              var shim = DEFAULT_SHIM_GLOBALS[symbolName];\n\n                              if (shim) {\n                                promises.push(enqueue(function () {\n                                  return resolveAsset(shim.spec, asset.href);\n                                }).then(function (dependencyAsset) {\n                                  return {\n                                    type: Asset.DependencyKind.InjectedGlobal,\n                                    href: dependencyAsset.href,\n                                    rootHref: dependencyAsset.rootHref,\n                                    references: references,\n                                    exportName: shim.export,\n                                    symbolName: symbolName,\n                                    value: \"\".concat(shim.spec).concat(shim.export ? \"[\".concat(JSON.stringify(shim.export), \"]\") : '')\n                                  };\n                                }));\n                              }\n                            };\n\n                            for (_iterator10 = asset.unresolvedDependencies.unboundSymbols[Symbol.iterator](); !(_iteratorNormalCompletion10 = (_step10 = _iterator10.next()).done); _iteratorNormalCompletion10 = true) {\n                              _loop3();\n                            }\n\n                            _context3.next = 61;\n                            break;\n\n                          case 57:\n                            _context3.prev = 57;\n                            _context3.t2 = _context3[\"catch\"](52);\n                            _didIteratorError10 = true;\n                            _iteratorError10 = _context3.t2;\n\n                          case 61:\n                            _context3.prev = 61;\n                            _context3.prev = 62;\n\n                            if (!_iteratorNormalCompletion10 && _iterator10.return != null) {\n                              _iterator10.return();\n                            }\n\n                          case 64:\n                            _context3.prev = 64;\n\n                            if (!_didIteratorError10) {\n                              _context3.next = 67;\n                              break;\n                            }\n\n                            throw _iteratorError10;\n\n                          case 67:\n                            return _context3.finish(64);\n\n                          case 68:\n                            return _context3.finish(61);\n\n                          case 69:\n                            _context3.next = 71;\n                            return Promise.all(promises);\n\n                          case 71:\n                            dependencies = _context3.sent;\n\n                            (_asset$dependencies2 = asset.dependencies).splice.apply(_asset$dependencies2, [0, asset.dependencies.length].concat(_toConsumableArray(dependencies)));\n\n                            return _context3.abrupt(\"return\", asset);\n\n                          case 74:\n                          case \"end\":\n                            return _context3.stop();\n                        }\n                      }\n                    }, _callee3, null, [[5, 17, 21, 29], [22,, 24, 28], [32, 37, 41, 49], [42,, 44, 48], [52, 57, 61, 69], [62,, 64, 68]]);\n                  }));\n\n                  return function resolveDependencies(_x7, _x8) {\n                    return _ref12.apply(this, arguments);\n                  };\n                }();\n\n                resolveAsset =\n                /*#__PURE__*/\n                function () {\n                  var _ref15 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee4(spec, fromSpec) {\n                    var resolvedSpec, asset, code;\n                    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                      while (1) {\n                        switch (_context4.prev = _context4.next) {\n                          case 0:\n                            _context4.next = 2;\n                            return _this5.resolveWithDetails(spec, fromSpec, {\n                              syntheticDependencies: options.dependencies,\n                              token: token\n                            });\n\n                          case 2:\n                            resolvedSpec = _context4.sent;\n                            asset = _this5.getOrCreateAsset(resolvedSpec.resolvedHref, resolvedSpec.rootHref); // No need to re-process the same asset during the same operation\n\n                            if (assets.has(asset)) {\n                              _context4.next = 10;\n                              break;\n                            }\n\n                            assets.add(asset);\n                            _context4.next = 8;\n                            return _this5.readCode(asset, {\n                              token: token\n                            });\n\n                          case 8:\n                            code = _context4.sent;\n                            // No need to wait for this, but we do need to make sure it doesn't\n                            // generate an unhandled rejection.\n                            resolveDependencies(asset, code).catch(function (_) {\n                              return undefined;\n                            });\n\n                          case 10:\n                            return _context4.abrupt(\"return\", asset);\n\n                          case 11:\n                          case \"end\":\n                            return _context4.stop();\n                        }\n                      }\n                    }, _callee4);\n                  }));\n\n                  return function resolveAsset(_x9, _x10) {\n                    return _ref15.apply(this, arguments);\n                  };\n                }();\n\n                if (options.dependencies) {\n                  _loop4 = function _loop4(name) {\n                    var dependency = options.dependencies[name];\n                    enqueue(function () {\n                      return resolveAsset(\"\".concat(name, \"@\").concat(dependency));\n                    }).then(function (asset) {\n                      return dependenciesToAssets.set(name, asset);\n                    }, function (_) {\n                      return undefined;\n                    });\n                  };\n\n                  for (name in options.dependencies) {\n                    _loop4(name);\n                  }\n                }\n\n                _loop5 = function _loop5(idx) {\n                  var entrypoint = entrypoints[idx]; // We need to add a catch handler because we might not catch all thrown exceptions,\n                  // only the first, via the dfd.promise.\n\n                  switch (entrypoint.type) {\n                    case 'href':\n                      {\n                        enqueue(function () {\n                          return resolveAsset(entrypoint.href);\n                        }).then(function (asset) {\n                          return entrypointsToAssets.set(entrypoint.href, asset);\n                        }, function (_) {\n                          return undefined;\n                        });\n                        break;\n                      }\n\n                    case 'inline':\n                      {\n                        enqueue(function () {\n                          var asset = _this5.getOrCreateAsset(entrypoint.href, 'velcro:///');\n\n                          if (!assets.has(asset)) {\n                            assets.add(asset);\n                            return resolveDependencies(asset, entrypoint.code);\n                          }\n\n                          return asset;\n                        }).then(function (asset) {\n                          return entrypointsToAssets.set(entrypoint.href, asset);\n                        }, function (_) {\n                          return undefined;\n                        });\n                        break;\n                      }\n\n                    default:\n                      {\n                        throw new Error(\"Unexpected entrypoint type '\".concat(entrypoint.type));\n                      }\n                  }\n                };\n\n                for (idx in entrypoints) {\n                  _loop5(idx);\n                }\n\n                _context5.next = 19;\n                return dfd.promise;\n\n              case 19:\n                return _context5.abrupt(\"return\", new Bundle(assets, entrypointsToAssets, dependenciesToAssets));\n\n              case 20:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      function generateBundle(_x5) {\n        return _generateBundle.apply(this, arguments);\n      }\n\n      return generateBundle;\n    }()\n  }, {\n    key: \"invalidate\",\n    value: function () {\n      var _invalidate = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(spec) {\n        var _ref16,\n            token,\n            asset,\n            resolveResult,\n            combinedUri,\n            _args6 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _ref16 = _args6.length > 1 && _args6[1] !== undefined ? _args6[1] : {}, token = _ref16.token;\n                asset = this.assetsByHref.get(spec);\n\n                if (asset) {\n                  _context6.next = 25;\n                  break;\n                }\n\n                // We can't use Bundler::resolveWithDetails() because that will throw\n                // when a module isn't found. We just want to attempt to resolve and\n                // return true / false accordingly.\n                resolveResult = undefined;\n                _context6.prev = 4;\n\n                if (!isBareModuleSpecifier(spec)) {\n                  _context6.next = 11;\n                  break;\n                }\n\n                _context6.next = 8;\n                return resolveBareModuleToUnpkgWithDetails(this.resolver, this.resolveBareModule, spec, undefined, {\n                  token: token\n                });\n\n              case 8:\n                resolveResult = _context6.sent;\n                _context6.next = 15;\n                break;\n\n              case 11:\n                combinedUri = new URL(spec);\n                _context6.next = 14;\n                return this.resolver.resolve(combinedUri, {\n                  token: token\n                });\n\n              case 14:\n                resolveResult = _context6.sent;\n\n              case 15:\n                _context6.next = 22;\n                break;\n\n              case 17:\n                _context6.prev = 17;\n                _context6.t0 = _context6[\"catch\"](4);\n\n                if (!(_context6.t0 instanceof EntryNotFoundError)) {\n                  _context6.next = 21;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", false);\n\n              case 21:\n                throw _context6.t0;\n\n              case 22:\n                if (!(!resolveResult || !resolveResult.resolvedUrl)) {\n                  _context6.next = 24;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", false);\n\n              case 24:\n                asset = this.assetsByHref.get(resolveResult.resolvedUrl.href);\n\n              case 25:\n                if (!asset) {\n                  _context6.next = 28;\n                  break;\n                }\n\n                this.removeAsset(asset);\n                return _context6.abrupt(\"return\", true);\n\n              case 28:\n                return _context6.abrupt(\"return\", false);\n\n              case 29:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[4, 17]]);\n      }));\n\n      function invalidate(_x11) {\n        return _invalidate.apply(this, arguments);\n      }\n\n      return invalidate;\n    }()\n  }, {\n    key: \"removeAsset\",\n    value: function removeAsset(asset) {\n      var hadAsset = this.assetsByHref.delete(asset.href);\n\n      if (hadAsset) {\n        this.onAssetRemovedEmitter.fire(asset);\n      }\n    }\n  }, {\n    key: \"readCode\",\n    value: function () {\n      var _readCode = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(asset, _ref17) {\n        var token, buf, code;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                token = _ref17.token;\n\n                if (!(asset.href === EMPTY_MODULE_URL.href)) {\n                  _context7.next = 3;\n                  break;\n                }\n\n                return _context7.abrupt(\"return\", EMPTY_MODULE_CODE);\n\n              case 3:\n                _context7.next = 5;\n                return this.resolver.host.readFileContent(this.resolver, new URL(asset.href), {\n                  token: token\n                });\n\n              case 5:\n                buf = _context7.sent;\n                code = this.resolver.decoder.decode(buf);\n                return _context7.abrupt(\"return\", code);\n\n              case 8:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function readCode(_x12, _x13) {\n        return _readCode.apply(this, arguments);\n      }\n\n      return readCode;\n    }()\n  }, {\n    key: \"resolveWithDetails\",\n    value: function () {\n      var _resolveWithDetails = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8(uri, fromUri, _ref18) {\n        var syntheticDependencies, token, resolved, bareModuleResolveResult, resolvedHref, combinedUri, resolveResult, resolvedUri, _resolvedHref, rootHref;\n\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                syntheticDependencies = _ref18.syntheticDependencies, token = _ref18.token;\n\n                if (!isBareModuleSpecifier(uri)) {\n                  _context8.next = 13;\n                  break;\n                }\n\n                _context8.next = 4;\n                return resolveBareModuleToUnpkgWithDetails(this.resolver, this.resolveBareModule, uri, fromUri, {\n                  syntheticDependencies: syntheticDependencies,\n                  token: token\n                });\n\n              case 4:\n                bareModuleResolveResult = _context8.sent;\n\n                if (bareModuleResolveResult.stableUrl) {\n                  _context8.next = 7;\n                  break;\n                }\n\n                throw new Error(\"Failed to resolve bare module '\".concat(uri, \"' from '\").concat(fromUri || '@root', \"' to a stable url\"));\n\n              case 7:\n                if (bareModuleResolveResult.stableRootUrl) {\n                  _context8.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Failed to resolve bare module '\".concat(uri, \"' from '\").concat(fromUri || '@root', \"' to a stable root url\"));\n\n              case 9:\n                resolvedHref = bareModuleResolveResult.resolvedUrl ? bareModuleResolveResult.resolvedUrl.href : EMPTY_MODULE_URL.href;\n                resolved = {\n                  type: Bundler.ResolveDetailsKind.BareModule,\n                  bareModule: {\n                    isBuiltIn: bareModuleResolveResult.bareModule.isBuiltIn,\n                    version: bareModuleResolveResult.bareModule.version,\n                    versionSpec: bareModuleResolveResult.bareModule.versionSpec\n                  },\n                  ignored: bareModuleResolveResult.ignored,\n                  resolvedHref: resolvedHref,\n                  rootHref: bareModuleResolveResult.rootUrl.href,\n                  stableHref: bareModuleResolveResult.stableUrl.href,\n                  stableRootHref: bareModuleResolveResult.stableRootUrl.href\n                };\n                _context8.next = 21;\n                break;\n\n              case 13:\n                combinedUri = new URL(uri, fromUri);\n                _context8.next = 16;\n                return this.resolver.resolve(combinedUri);\n\n              case 16:\n                resolveResult = _context8.sent;\n\n                if (!resolveResult.resolvedUrl) {\n                  resolvedUri = EMPTY_MODULE_URL;\n                } else {\n                  resolvedUri = resolveResult.resolvedUrl;\n                }\n\n                _resolvedHref = resolvedUri.href;\n                rootHref = resolveResult.rootUrl.href;\n                resolved = {\n                  type: Bundler.ResolveDetailsKind.Relative,\n                  ignored: resolveResult.ignored,\n                  resolvedHref: _resolvedHref,\n                  rootHref: rootHref,\n                  stableHref: _resolvedHref,\n                  stableRootHref: rootHref\n                };\n\n              case 21:\n                return _context8.abrupt(\"return\", resolved);\n\n              case 22:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function resolveWithDetails(_x14, _x15, _x16) {\n        return _resolveWithDetails.apply(this, arguments);\n      }\n\n      return resolveWithDetails;\n    }()\n  }, {\n    key: \"onAssetAdded\",\n    get: function get() {\n      return this.onAssetAddedEmitter.event;\n    }\n  }, {\n    key: \"onAssetRemoved\",\n    get: function get() {\n      return this.onAssetRemovedEmitter.event;\n    }\n  }]);\n\n  return Bundler;\n}();\n\n(function (Bundler) {\n  var ResolveDetailsKind;\n\n  (function (ResolveDetailsKind) {\n    ResolveDetailsKind[\"BareModule\"] = \"bare_module\";\n    ResolveDetailsKind[\"Relative\"] = \"relative\";\n  })(ResolveDetailsKind = Bundler.ResolveDetailsKind || (Bundler.ResolveDetailsKind = {}));\n})(Bundler || (Bundler = {}));\n\nvar base64 = {\n  decode: Base64.decode,\n  encode: Base64.encode\n};\nexport { Asset, Bundler, InvariantViolation, ResolveError, base64, getSourceMappingUrl };","import _slicedToArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport { AbstractResolverHost } from '@velcro/resolver';\n\nvar ResolverHostCompound =\n/*#__PURE__*/\nfunction (_AbstractResolverHost) {\n  _inherits(ResolverHostCompound, _AbstractResolverHost);\n\n  function ResolverHostCompound(hosts) {\n    var _this;\n\n    _classCallCheck(this, ResolverHostCompound);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ResolverHostCompound).call(this));\n    _this.hosts = new Map();\n\n    for (var prefix in hosts) {\n      _this.hosts.set(prefix, hosts[prefix]);\n    }\n\n    return _this;\n  }\n\n  _createClass(ResolverHostCompound, [{\n    key: \"getCanonicalUrl\",\n    value: function getCanonicalUrl(resolver, url) {\n      var href = url.href; // TODO: Decide whether a more efficient solution is needed\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this.hosts[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var _ref3 = _step.value;\n\n          var _ref2 = _slicedToArray(_ref3, 2);\n\n          var prefix = _ref2[0];\n          var child = _ref2[1];\n\n          if (href.startsWith(prefix)) {\n            if (typeof child.getCanonicalUrl === 'function') {\n              // console.error(`getCanonicalUrl(%s): %s`, url.href, prefix);\n              return child.getCanonicalUrl(resolver, url);\n            }\n\n            break;\n          }\n        } // If the resolved child doesn't have this method, treat it as an identity function\n\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return Promise.resolve(url);\n    }\n  }, {\n    key: \"getResolveRoot\",\n    value: function getResolveRoot(resolver, url) {\n      var href = url.href; // TODO: Decide whether a more efficient solution is needed\n\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = this.hosts[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var _ref6 = _step2.value;\n\n          var _ref5 = _slicedToArray(_ref6, 2);\n\n          var prefix = _ref5[0];\n          var child = _ref5[1];\n\n          if (href.startsWith(prefix)) {\n            // console.error(`getResolveRoot(%s): %s`, url.href, prefix);\n            return child.getResolveRoot(resolver, url);\n          }\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      return Promise.reject(new Error(\"No suitable host found for url \".concat(href)));\n    }\n  }, {\n    key: \"listEntries\",\n    value: function listEntries(resolver, url) {\n      var href = url.href; // TODO: Decide whether a more efficient solution is needed\n\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = this.hosts[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var _ref9 = _step3.value;\n\n          var _ref8 = _slicedToArray(_ref9, 2);\n\n          var prefix = _ref8[0];\n          var child = _ref8[1];\n\n          if (href.startsWith(prefix)) {\n            // console.error(`listEntries(%s): %s`, url.href, prefix);\n            return child.listEntries(resolver, url);\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      return Promise.reject(new Error(\"No suitable host found for url \".concat(href)));\n    }\n  }, {\n    key: \"readFileContent\",\n    value: function readFileContent(resolver, url) {\n      var href = url.href; // TODO: Decide whether a more efficient solution is needed\n\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = this.hosts[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var _ref12 = _step4.value;\n\n          var _ref11 = _slicedToArray(_ref12, 2);\n\n          var prefix = _ref11[0];\n          var child = _ref11[1];\n\n          if (href.startsWith(prefix)) {\n            // console.error(`readFileContent(%s): %s`, url.href, prefix);\n            return child.readFileContent(resolver, url);\n          }\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n\n      return Promise.reject(new Error(\"No suitable host found for url \".concat(href)));\n    }\n  }]);\n\n  return ResolverHostCompound;\n}(AbstractResolverHost);\n\nexport { ResolverHostCompound };","export interface Diagnostic {\n  message: string;\n  start?: { lineNumber: number; column: number };\n  end?: { lineNumber: number; column: number };\n  href?: string;\n}\n\nexport class ExtendableError extends Error {\n  constructor(message?: string) {\n    super(message);\n\n    this.name = this.constructor.name;\n  }\n}\n\nexport class InvariantError extends ExtendableError {}\n\nexport class TimeoutError extends ExtendableError {}\n\nexport class TranspileError extends ExtendableError {\n  constructor(message: string, readonly diagnostics: Diagnostic[]) {\n    super(message);\n  }\n}\n","import { Resolver, ResolvedEntryKind, AbstractResolverHost, ResolvedEntry } from '@velcro/resolver';\nimport * as Monaco from 'monaco-editor';\nimport { timeout } from 'ts-primitives';\n\nimport { InvariantError, TimeoutError, TranspileError, Diagnostic } from './error';\n\nconst LANGUAGE_TYPESCRIPT = 'typescript';\nconst MAX_TRANSPILE_ATTEMPTS = 3;\nconst TRANSPILE_TIMEOUT = 2000;\nconst TRANSPILE_TIMEOUT_BACKOFF = 500;\n\ntype Model = Monaco.editor.ITextModel;\n\nexport class ResolverHostMonaco extends AbstractResolverHost {\n  constructor(private readonly rootUri: Monaco.Uri = Monaco.Uri.file('/')) {\n    super();\n  }\n\n  get rootHref() {\n    return this.rootUri.toString(true);\n  }\n\n  async getResolveRoot() {\n    return new URL(this.rootUri.toString(true));\n  }\n\n  async listEntries(_resolver: Resolver, url: URL) {\n    const href = url.href.replace(/\\/?$/, '/');\n    const rootHref = this.rootUri.toString(true);\n\n    if (!href.startsWith(rootHref)) {\n      return [];\n    }\n\n    return Monaco.editor.getModels().reduce(\n      (entries, model) => {\n        const modelHref = model.uri.toString(true);\n        const seenDirs = new Set<string>();\n\n        if (modelHref.startsWith(href)) {\n          const nestedPath = modelHref.slice(href.length);\n          const nextDirIdx = nestedPath.indexOf('/');\n\n          if (nextDirIdx === 0) {\n            throw new Error('Invariant error: WAT?');\n          }\n\n          if (nextDirIdx > 0) {\n            // This is an intermediate directory\n            const url = new URL(nestedPath.slice(0, nextDirIdx + 1), href);\n\n            if (!seenDirs.has(url.href)) {\n              entries.push({\n                type: ResolvedEntryKind.Directory,\n                url,\n              });\n            }\n          } else {\n            entries.push({\n              type: ResolvedEntryKind.File,\n              url: new URL(modelHref),\n            });\n          }\n        }\n\n        return entries;\n      },\n      [] as ResolvedEntry[]\n    );\n  }\n\n  async readFileContent(_resolver: Resolver, url: URL) {\n    const href = url.href;\n\n    if (!href.startsWith(this.rootHref)) {\n      throw new InvariantError(\n        `Attempting to read file content for a model at '${href}' outside of this host's root '${this.rootHref}'`\n      );\n    }\n\n    const pathname = href.slice(this.rootHref.length);\n    const model = Monaco.editor.getModel(Monaco.Uri.file(pathname));\n\n    if (!model) {\n      throw new InvariantError(`Attempting to read file content for a model that doesn't exist at '${href}'`);\n    }\n\n    const encoder = new TextEncoder();\n    const output = await this.getTranspiledValue(model);\n\n    return encoder.encode(output);\n  }\n\n  private async getTranspiledValue(model: Monaco.editor.ITextModel) {\n    if (model.getModeId() === LANGUAGE_TYPESCRIPT) {\n      const href = model.uri.toString(true);\n\n      const tryLoadFromWorker = async () => {\n        const workerFactory = await Monaco.languages.typescript.getTypeScriptWorker();\n        const workerClient = await workerFactory(model.uri);\n        const [emitOutput, syntacticDiagnostics] = (await Promise.all([\n          workerClient.getEmitOutput(href),\n          workerClient.getSyntacticDiagnostics(href),\n        ])) as [import('typescript').EmitOutput, import('typescript').Diagnostic[]];\n\n        if (emitOutput.emitSkipped) {\n          throw new InvariantError(`Emit skipped when trying to read '${model.uri.fsPath}'`);\n        }\n\n        if (syntacticDiagnostics.length) {\n          const diagnostics: Diagnostic[] = syntacticDiagnostics.map(diagnostic => {\n            const startPosition =\n              typeof diagnostic.start === 'number' ? model.getPositionAt(diagnostic.start) : undefined;\n            const endPosition =\n              typeof diagnostic.start === 'number' && typeof diagnostic.length === 'number'\n                ? model.getPositionAt(diagnostic.start + diagnostic.length)\n                : undefined;\n\n            return {\n              message: flattenDiagnosticMessageText(diagnostic.messageText),\n              start: startPosition ? { lineNumber: startPosition.lineNumber, column: startPosition.column } : undefined,\n              end: endPosition ? { lineNumber: endPosition.lineNumber, column: endPosition.column } : undefined,\n              href: diagnostic.source,\n            };\n          });\n          throw new TranspileError(`${syntacticDiagnostics[0].messageText} at ${model.uri.fsPath}`, diagnostics);\n        }\n\n        return emitOutput.outputFiles[0].text;\n      };\n\n      let attempt = 0;\n\n      while (attempt++ < MAX_TRANSPILE_ATTEMPTS) {\n        try {\n          const code = await raceTimeout(tryLoadFromWorker(), TRANSPILE_TIMEOUT);\n\n          return code;\n        } catch (err) {\n          if (err instanceof TimeoutError) {\n            await timeout(TRANSPILE_TIMEOUT_BACKOFF * Math.pow(2, attempt));\n            continue;\n          }\n\n          throw err;\n        }\n      }\n\n      throw new TimeoutError(`Timed out while trying to transpile '${href}'`);\n    }\n\n    return model.getValue();\n  }\n}\n\nexport function flattenDiagnosticMessageText(\n  diag: string | import('typescript').DiagnosticMessageChain | undefined,\n  newLine: string = '\\n',\n  indent = 0\n): string {\n  if (typeof diag === 'string') {\n    return diag;\n  } else if (diag === undefined) {\n    return '';\n  }\n  let result = '';\n  if (indent) {\n    result += newLine;\n\n    for (let i = 0; i < indent; i++) {\n      result += '  ';\n    }\n  }\n  result += diag.messageText;\n  indent++;\n  if (diag.next) {\n    for (const kid of diag.next) {\n      result += flattenDiagnosticMessageText(kid, newLine, indent);\n    }\n  }\n  return result;\n}\n\nfunction raceTimeout<T>(promise: Promise<T>, timeoutMs: number): Promise<T> {\n  return Promise.race([\n    promise,\n    timeout(timeoutMs).then(() => {\n      return Promise.reject(new TimeoutError());\n    }),\n  ]);\n}\n","import _slicedToArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _createClass from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _classCallCheck from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport { ResolvedEntryKind, AbstractResolverHost, CanceledError, Resolver, util } from '@velcro/resolver';\nimport LRU from 'lru-cache';\nimport { validRange, satisfies } from 'semver';\n\nvar ExtendableError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(ExtendableError, _Error);\n\n  function ExtendableError(message) {\n    var _this;\n\n    _classCallCheck(this, ExtendableError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ExtendableError).call(this, message));\n    _this.name = _this.constructor.name;\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(_assertThisInitialized(_this), _this.constructor);\n    } else {\n      _this.stack = new Error(message).stack;\n    }\n\n    return _this;\n  }\n\n  return ExtendableError;\n}(_wrapNativeSuper(Error));\n\nvar EntryNotFoundError =\n/*#__PURE__*/\nfunction (_ExtendableError) {\n  _inherits(EntryNotFoundError, _ExtendableError);\n\n  function EntryNotFoundError(url) {\n    _classCallCheck(this, EntryNotFoundError);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(EntryNotFoundError).call(this, \"Not found \".concat(url.href)));\n  }\n\n  return EntryNotFoundError;\n}(ExtendableError);\n\nvar FetchError =\n/*#__PURE__*/\nfunction (_ExtendableError2) {\n  _inherits(FetchError, _ExtendableError2);\n\n  function FetchError(href, err) {\n    _classCallCheck(this, FetchError);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(FetchError).call(this, \"Error while fetching \".concat(href, \": \").concat(err.name || Error, \": \").concat(err.message)));\n  }\n\n  return FetchError;\n}(ExtendableError);\n\nfunction isValidEntry(entry) {\n  if (!entry || typeof entry !== 'object') return false;\n  return isValidFile(entry) || isValidDirectory(entry);\n}\n\nfunction isValidDirectory(entry) {\n  return typeof entry === 'object' && entry && entry.type === ResolvedEntryKind.Directory && typeof entry.path === 'string' && entry.path && (typeof entry.files === 'undefined' || Array.isArray(entry.files) && entry.files.every(isValidEntry));\n}\n\nfunction isValidFile(entry) {\n  return typeof entry === 'object' && entry && entry.type === ResolvedEntryKind.File && typeof entry.path === 'string' && entry.path;\n}\n\nfunction signalFromCancellationToken(token, AbortControllerConstructor) {\n  if (!token || !AbortControllerConstructor) {\n    return;\n  }\n\n  var abortController = new AbortControllerConstructor();\n\n  if (token.isCancellationRequested) {\n    abortController.abort();\n  } else {\n    token.onCancellationRequested(function () {\n      return abortController.abort();\n    });\n  }\n\n  return abortController.signal;\n}\n\nvar UnpkgCdn =\n/*#__PURE__*/\nfunction () {\n  function UnpkgCdn() {\n    _classCallCheck(this, UnpkgCdn);\n\n    this.name = 'unpkg';\n    this.UNPKG_SPEC_RX = /^\\/((@[^/]+\\/[^/@]+|[^/@]+)(?:@([^/]+))?)(.*)?$/;\n  }\n\n  _createClass(UnpkgCdn, [{\n    key: \"isValidUrl\",\n    value: function isValidUrl(url) {\n      return url.protocol !== UnpkgCdn.protocol || url.hostname !== UnpkgCdn.host;\n    }\n  }, {\n    key: \"normalizePackageListing\",\n    value: function normalizePackageListing(result) {\n      if (!isValidDirectory(result)) {\n        throw new Error(\"Error normalizing directory listing\");\n      }\n\n      return result;\n    }\n  }, {\n    key: \"parseUrl\",\n    value: function parseUrl(url) {\n      if (url instanceof URL) {\n        url = url.pathname;\n      }\n      /**\r\n       * 1: scope + name + version\r\n       * 2: scope + name\r\n       * 3: version?\r\n       * 4: pathname\r\n       */\n\n\n      var matches = url.match(this.UNPKG_SPEC_RX);\n\n      if (!matches) {\n        throw new Error(\"Unable to parse unexpected unpkg url: \".concat(url));\n      }\n\n      return {\n        spec: matches[1],\n        name: matches[2],\n        version: matches[3] || '',\n        pathname: matches[4] || ''\n      };\n    }\n  }, {\n    key: \"urlForPackageFile\",\n    value: function urlForPackageFile(spec, pathname) {\n      return new URL(\"\".concat(UnpkgCdn.protocol, \"//\").concat(UnpkgCdn.host, \"/\").concat(spec).concat(pathname));\n    }\n  }, {\n    key: \"urlForPackageList\",\n    value: function urlForPackageList(spec) {\n      return new URL(\"\".concat(UnpkgCdn.protocol, \"//\").concat(UnpkgCdn.host, \"/\").concat(spec, \"/?meta\"));\n    }\n  }]);\n\n  return UnpkgCdn;\n}();\n\nUnpkgCdn.protocol = 'https:';\nUnpkgCdn.host = 'unpkg.com';\n\nvar JSDelivrCdn =\n/*#__PURE__*/\nfunction () {\n  function JSDelivrCdn() {\n    _classCallCheck(this, JSDelivrCdn);\n\n    this.name = 'jsdelivr';\n    this.JSDELIVR_SPEC_RX = /^\\/npm\\/((@[^/]+\\/[^/@]+|[^/@]+)(?:@([^/]+))?)(.*)?$/;\n  }\n\n  _createClass(JSDelivrCdn, [{\n    key: \"isValidUrl\",\n    value: function isValidUrl(url) {\n      return url.protocol !== JSDelivrCdn.protocol || url.hostname !== JSDelivrCdn.host;\n    }\n  }, {\n    key: \"normalizePackageListing\",\n    value: function normalizePackageListing(result) {\n      if (!result || typeof result !== 'object') {\n        throw new Error(\"Unexpected package listing contents\");\n      }\n\n      var files = result.files;\n\n      if (!Array.isArray(files)) {\n        throw new Error(\"Unexpected package listing contents\");\n      }\n\n      var mapChildEntry = function mapChildEntry(parent, child) {\n        if (!child || typeof child !== 'object') {\n          throw new Error(\"Unexpected entry in package listing contents\");\n        }\n\n        var name = child.name;\n\n        if (typeof name !== 'string') {\n          throw new Error(\"Unexpected entry in package listing contents\");\n        }\n\n        var path = \"\".concat(parent, \"/\").concat(name);\n\n        if (child.type === ResolvedEntryKind.Directory) {\n          var _files = child.files;\n\n          if (!Array.isArray(_files)) {\n            throw new Error(\"Unexpected entry in package listing contents\");\n          }\n\n          return {\n            type: ResolvedEntryKind.Directory,\n            path: path,\n            files: _files.map(function (file) {\n              return mapChildEntry(path, file);\n            })\n          };\n        } else if (child.type === ResolvedEntryKind.File) {\n          return {\n            type: ResolvedEntryKind.File,\n            path: path\n          };\n        }\n\n        throw new Error(\"Error mapping child entry in package file listing\");\n      };\n\n      return {\n        type: ResolvedEntryKind.Directory,\n        path: '/',\n        files: files.map(function (file) {\n          return mapChildEntry('', file);\n        })\n      };\n    }\n  }, {\n    key: \"parseUrl\",\n    value: function parseUrl(url) {\n      if (url instanceof URL) {\n        url = url.pathname;\n      }\n      /**\r\n       * 1: scope + name + version\r\n       * 2: scope + name\r\n       * 3: version?\r\n       * 4: pathname\r\n       */\n\n\n      var matches = url.match(this.JSDELIVR_SPEC_RX);\n\n      if (!matches) {\n        throw new Error(\"Unable to parse unexpected unpkg url: \".concat(url));\n      }\n\n      return {\n        spec: matches[1],\n        name: matches[2],\n        version: matches[3] || '',\n        pathname: matches[4] || ''\n      };\n    }\n  }, {\n    key: \"urlForPackageFile\",\n    value: function urlForPackageFile(spec, pathname) {\n      return new URL(\"\".concat(JSDelivrCdn.protocol, \"//\").concat(JSDelivrCdn.host, \"/npm/\").concat(spec).concat(pathname));\n    }\n  }, {\n    key: \"urlForPackageList\",\n    value: function urlForPackageList(spec) {\n      return new URL(\"\".concat(JSDelivrCdn.protocol, \"//\").concat(JSDelivrCdn.dataHost, \"/v1/package/npm/\").concat(spec, \"/tree\"));\n    }\n  }]);\n\n  return JSDelivrCdn;\n}();\n\nJSDelivrCdn.protocol = 'https:';\nJSDelivrCdn.host = 'cdn.jsdelivr.net';\nJSDelivrCdn.dataHost = 'data.jsdelivr.com';\n\nvar ResolverHostUnpkg =\n/*#__PURE__*/\nfunction (_AbstractResolverHost) {\n  _inherits(ResolverHostUnpkg, _AbstractResolverHost);\n\n  function ResolverHostUnpkg() {\n    var _this2;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, ResolverHostUnpkg);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(ResolverHostUnpkg).call(this));\n    _this2.contentCache = new LRU({\n      length: function length(buf) {\n        return buf.byteLength;\n      },\n      max: 1024 * 1024 * 5\n    });\n    _this2.inflightContentRequests = new Map();\n    _this2.packageLock = new Map();\n    _this2.packageEntriesCache = new Map();\n    _this2.packageJsonCache = new Map();\n\n    if (!options.fetch && typeof fetch !== 'function') {\n      throw new TypeError(\"A fetch function must be provided to the \".concat(_this2.constructor.name, \" if the environment doesn't provide one\"));\n    }\n\n    _this2.AbortController = options.AbortController;\n\n    _this2.fetch = options.fetch || function (input, init) {\n      return fetch(input, init);\n    };\n\n    _this2.cdn = options.cdn === 'jsdelivr' ? new JSDelivrCdn() : new UnpkgCdn();\n    return _this2;\n  }\n\n  _createClass(ResolverHostUnpkg, [{\n    key: \"getCanonicalUrl\",\n    value: function () {\n      var _getCanonicalUrl = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(resolver, url) {\n        var _ref,\n            token,\n            unresolvedSpec,\n            packageJson,\n            _args = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref = _args.length > 2 && _args[2] !== undefined ? _args[2] : {}, token = _ref.token;\n\n                if (!this.cdn.isValidUrl(url)) {\n                  _context.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Unable to list non-\".concat(this.cdn.name, \" entries for \").concat(url.href));\n\n              case 3:\n                unresolvedSpec = this.cdn.parseUrl(url);\n                _context.next = 6;\n                return this.readPackageJsonWithCache(resolver, unresolvedSpec, {\n                  token: token\n                });\n\n              case 6:\n                packageJson = _context.sent;\n\n                if (packageJson.name) {\n                  _context.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Missing name property in package.json for '\".concat(url.href, \"'\"));\n\n              case 9:\n                if (packageJson.version) {\n                  _context.next = 11;\n                  break;\n                }\n\n                throw new Error(\"Missing version property in package.json for '\".concat(url.href, \"'\"));\n\n              case 11:\n                return _context.abrupt(\"return\", this.cdn.urlForPackageFile(\"\".concat(packageJson.name, \"@\").concat(packageJson.version), unresolvedSpec.pathname));\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getCanonicalUrl(_x, _x2) {\n        return _getCanonicalUrl.apply(this, arguments);\n      }\n\n      return getCanonicalUrl;\n    }()\n  }, {\n    key: \"getResolveRoot\",\n    value: function () {\n      var _getResolveRoot = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(resolver, url) {\n        var _ref2,\n            token,\n            unresolvedSpec,\n            packageJson,\n            _args2 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _ref2 = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : {}, token = _ref2.token;\n\n                if (!this.cdn.isValidUrl(url)) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Unable to list non-\".concat(this.cdn.name, \" entries for \").concat(url.href));\n\n              case 3:\n                unresolvedSpec = this.cdn.parseUrl(url);\n                _context2.next = 6;\n                return this.readPackageJsonWithCache(resolver, unresolvedSpec, {\n                  token: token\n                });\n\n              case 6:\n                packageJson = _context2.sent;\n\n                if (packageJson.name) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Missing name property in package.json for '\".concat(url.href, \"'\"));\n\n              case 9:\n                if (packageJson.version) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                throw new Error(\"Missing version property in package.json for '\".concat(url.href, \"'\"));\n\n              case 11:\n                return _context2.abrupt(\"return\", this.cdn.urlForPackageFile(\"\".concat(packageJson.name, \"@\").concat(packageJson.version), '/'));\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getResolveRoot(_x3, _x4) {\n        return _getResolveRoot.apply(this, arguments);\n      }\n\n      return getResolveRoot;\n    }()\n  }, {\n    key: \"getRoot\",\n    value: function getRoot() {\n      return this.cdn.urlForPackageFile('', '');\n    }\n  }, {\n    key: \"listEntries\",\n    value: function () {\n      var _listEntries = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(resolver, url) {\n        var _ref3,\n            token,\n            rootUrl,\n            unresolvedSpec,\n            packageJson,\n            parentEntry,\n            traversalSegments,\n            _loop,\n            _args3 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _ref3 = _args3.length > 2 && _args3[2] !== undefined ? _args3[2] : {}, token = _ref3.token;\n\n                if (!this.cdn.isValidUrl(url)) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Unable to list non-\".concat(this.cdn.name, \" entries for \").concat(url.href));\n\n              case 3:\n                _context3.next = 5;\n                return resolver.host.getResolveRoot(resolver, url, {\n                  token: token\n                });\n\n              case 5:\n                rootUrl = _context3.sent;\n                unresolvedSpec = this.cdn.parseUrl(url);\n                _context3.next = 9;\n                return this.readPackageJsonWithCache(resolver, unresolvedSpec, {\n                  token: token\n                });\n\n              case 9:\n                packageJson = _context3.sent;\n                url = this.cdn.urlForPackageFile(\"\".concat(packageJson.name, \"@\").concat(packageJson.version), unresolvedSpec.pathname);\n                _context3.next = 13;\n                return this.readPackageEntriesWithCache(this.cdn.parseUrl(url), {\n                  token: token\n                });\n\n              case 13:\n                parentEntry = _context3.sent;\n\n                if (!(token && token.isCancellationRequested)) {\n                  _context3.next = 16;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 16:\n                traversalSegments = unresolvedSpec.pathname.split('/').filter(Boolean);\n\n                _loop = function _loop() {\n                  var segment = traversalSegments.shift();\n\n                  if (parentEntry.type !== ResolvedEntryKind.Directory || !parentEntry.files) {\n                    throw new EntryNotFoundError(url);\n                  }\n\n                  parentEntry = parentEntry.files.find(function (file) {\n                    return file.type === ResolvedEntryKind.Directory && Resolver.path.basename(file.path) === segment;\n                  });\n                };\n\n                while (parentEntry && traversalSegments.length) {\n                  _loop();\n                }\n\n                if (parentEntry) {\n                  _context3.next = 21;\n                  break;\n                }\n\n                throw new EntryNotFoundError(url);\n\n              case 21:\n                if (parentEntry.files) {\n                  _context3.next = 23;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", []);\n\n              case 23:\n                return _context3.abrupt(\"return\", parentEntry.files.map(function (entry) {\n                  return {\n                    type: entry.type,\n                    url: new URL(\".\".concat(entry.path), rootUrl)\n                  };\n                }));\n\n              case 24:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function listEntries(_x5, _x6) {\n        return _listEntries.apply(this, arguments);\n      }\n\n      return listEntries;\n    }()\n  }, {\n    key: \"readFileContent\",\n    value: function () {\n      var _readFileContent = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(_, url) {\n        var _ref4,\n            token,\n            href,\n            cached,\n            inflight,\n            signal,\n            fetch,\n            promise,\n            buf,\n            _args4 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _ref4 = _args4.length > 2 && _args4[2] !== undefined ? _args4[2] : {}, token = _ref4.token;\n\n                if (!this.cdn.isValidUrl(url)) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Unable to read file contents for non-\".concat(this.cdn.name, \" entries for \").concat(url.href));\n\n              case 3:\n                href = url.href;\n                cached = this.contentCache.get(href);\n\n                if (!cached) {\n                  _context4.next = 7;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", cached);\n\n              case 7:\n                inflight = this.inflightContentRequests.get(href);\n\n                if (!inflight) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", inflight);\n\n              case 10:\n                // console.log('[MISS] readFileContent(%s)', href);\n                signal = signalFromCancellationToken(token, this.AbortController);\n                fetch = this.fetch;\n                promise = fetch(href, {\n                  redirect: 'follow',\n                  signal: signal\n                }).then(function (res) {\n                  if (!res.ok) {\n                    throw new Error(\"Error reading file content for \".concat(href, \": \").concat(res.status));\n                  }\n\n                  return res.arrayBuffer();\n                }, function (err) {\n                  throw new FetchError(href, err);\n                }).catch(function (err) {\n                  if (signal && signal.aborted) {\n                    throw new CanceledError('Canceled');\n                  }\n\n                  throw err;\n                });\n                this.inflightContentRequests.set(href, promise);\n                _context4.prev = 14;\n                _context4.next = 17;\n                return promise;\n\n              case 17:\n                buf = _context4.sent;\n                this.contentCache.set(href, buf);\n                return _context4.abrupt(\"return\", buf);\n\n              case 20:\n                _context4.prev = 20;\n                this.inflightContentRequests.delete(href);\n                return _context4.finish(20);\n\n              case 23:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[14,, 20, 23]]);\n      }));\n\n      function readFileContent(_x7, _x8) {\n        return _readFileContent.apply(this, arguments);\n      }\n\n      return readFileContent;\n    }()\n  }, {\n    key: \"resolveBareModule\",\n    value: function resolveBareModule(spec) {\n      var pathname = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      return this.cdn.urlForPackageFile(spec, pathname);\n    }\n  }, {\n    key: \"readPackageEntriesWithCache\",\n    value: function () {\n      var _readPackageEntriesWithCache = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(spec) {\n        var _ref5,\n            token,\n            lockKey,\n            lock,\n            range,\n            packageEntriesCacheForModule,\n            exactMatch,\n            _iteratorNormalCompletion,\n            _didIteratorError,\n            _iteratorError,\n            _iterator,\n            _step,\n            _ref8,\n            _ref7,\n            version,\n            _packageEntries,\n            promise,\n            packageEntries,\n            _args5 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _ref5 = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {}, token = _ref5.token;\n                lockKey = \"entries:\".concat(spec.name);\n                lock = this.packageLock.get(lockKey);\n\n                if (!lock) {\n                  _context5.next = 6;\n                  break;\n                }\n\n                _context5.next = 6;\n                return lock;\n\n              case 6:\n                range = validRange(spec.version);\n\n                if (range) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Invalid SemVer range for spec \".concat(spec.spec));\n\n              case 9:\n                packageEntriesCacheForModule = this.packageEntriesCache.get(spec.name);\n\n                if (!packageEntriesCacheForModule) {\n                  _context5.next = 45;\n                  break;\n                }\n\n                exactMatch = packageEntriesCacheForModule.get(spec.version);\n\n                if (!exactMatch) {\n                  _context5.next = 14;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", exactMatch);\n\n              case 14:\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context5.prev = 17;\n                _iterator = packageEntriesCacheForModule[Symbol.iterator]();\n\n              case 19:\n                if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                  _context5.next = 29;\n                  break;\n                }\n\n                _ref8 = _step.value;\n                _ref7 = _slicedToArray(_ref8, 2);\n                version = _ref7[0];\n                _packageEntries = _ref7[1];\n\n                if (!satisfies(version, range)) {\n                  _context5.next = 26;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", _packageEntries);\n\n              case 26:\n                _iteratorNormalCompletion = true;\n                _context5.next = 19;\n                break;\n\n              case 29:\n                _context5.next = 35;\n                break;\n\n              case 31:\n                _context5.prev = 31;\n                _context5.t0 = _context5[\"catch\"](17);\n                _didIteratorError = true;\n                _iteratorError = _context5.t0;\n\n              case 35:\n                _context5.prev = 35;\n                _context5.prev = 36;\n\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n\n              case 38:\n                _context5.prev = 38;\n\n                if (!_didIteratorError) {\n                  _context5.next = 41;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 41:\n                return _context5.finish(38);\n\n              case 42:\n                return _context5.finish(35);\n\n              case 43:\n                _context5.next = 47;\n                break;\n\n              case 45:\n                packageEntriesCacheForModule = new Map();\n                this.packageEntriesCache.set(spec.name, packageEntriesCacheForModule);\n\n              case 47:\n                // console.log('[MISS] readPackageEntriesWithCache(%s)', spec.spec);\n                promise = this.readPackageEntries(spec.spec, {\n                  token: token\n                });\n                this.packageLock.set(lockKey, promise);\n                _context5.next = 51;\n                return promise;\n\n              case 51:\n                packageEntries = _context5.sent;\n                this.packageLock.delete(lockKey);\n                packageEntriesCacheForModule.set(spec.version, packageEntries);\n                return _context5.abrupt(\"return\", packageEntries);\n\n              case 55:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[17, 31, 35, 43], [36,, 38, 42]]);\n      }));\n\n      function readPackageEntriesWithCache(_x9) {\n        return _readPackageEntriesWithCache.apply(this, arguments);\n      }\n\n      return readPackageEntriesWithCache;\n    }()\n  }, {\n    key: \"readPackageJsonWithCache\",\n    value: function () {\n      var _readPackageJsonWithCache = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(resolver, spec) {\n        var _ref9,\n            token,\n            lockKey,\n            lock,\n            packageJsonCacheForModule,\n            exactMatch,\n            range,\n            _iteratorNormalCompletion2,\n            _didIteratorError2,\n            _iteratorError2,\n            _iterator2,\n            _step2,\n            _ref12,\n            _ref11,\n            version,\n            _packageJson,\n            promise,\n            packageJson,\n            _args6 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _ref9 = _args6.length > 2 && _args6[2] !== undefined ? _args6[2] : {}, token = _ref9.token;\n                lockKey = \"packageJson:\".concat(spec.spec);\n                lock = this.packageLock.get(lockKey);\n\n                if (!lock) {\n                  _context6.next = 6;\n                  break;\n                }\n\n                _context6.next = 6;\n                return lock;\n\n              case 6:\n                packageJsonCacheForModule = this.packageJsonCache.get(spec.name);\n\n                if (!packageJsonCacheForModule) {\n                  _context6.next = 44;\n                  break;\n                }\n\n                exactMatch = packageJsonCacheForModule.get(spec.version);\n\n                if (!exactMatch) {\n                  _context6.next = 11;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", exactMatch);\n\n              case 11:\n                range = validRange(spec.version);\n\n                if (!range) {\n                  _context6.next = 42;\n                  break;\n                }\n\n                _iteratorNormalCompletion2 = true;\n                _didIteratorError2 = false;\n                _iteratorError2 = undefined;\n                _context6.prev = 16;\n                _iterator2 = packageJsonCacheForModule[Symbol.iterator]();\n\n              case 18:\n                if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n                  _context6.next = 28;\n                  break;\n                }\n\n                _ref12 = _step2.value;\n                _ref11 = _slicedToArray(_ref12, 2);\n                version = _ref11[0];\n                _packageJson = _ref11[1];\n\n                if (!satisfies(version, range)) {\n                  _context6.next = 25;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", _packageJson);\n\n              case 25:\n                _iteratorNormalCompletion2 = true;\n                _context6.next = 18;\n                break;\n\n              case 28:\n                _context6.next = 34;\n                break;\n\n              case 30:\n                _context6.prev = 30;\n                _context6.t0 = _context6[\"catch\"](16);\n                _didIteratorError2 = true;\n                _iteratorError2 = _context6.t0;\n\n              case 34:\n                _context6.prev = 34;\n                _context6.prev = 35;\n\n                if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n                  _iterator2.return();\n                }\n\n              case 37:\n                _context6.prev = 37;\n\n                if (!_didIteratorError2) {\n                  _context6.next = 40;\n                  break;\n                }\n\n                throw _iteratorError2;\n\n              case 40:\n                return _context6.finish(37);\n\n              case 41:\n                return _context6.finish(34);\n\n              case 42:\n                _context6.next = 46;\n                break;\n\n              case 44:\n                packageJsonCacheForModule = new Map();\n                this.packageJsonCache.set(spec.name, packageJsonCacheForModule);\n\n              case 46:\n                // console.log('[MISS] readPackageJsonWithCache(%s)', spec.spec);\n                promise = this.readPackageJson(resolver, spec.spec, {\n                  token: token\n                });\n                this.packageLock.set(lockKey, promise);\n                _context6.next = 50;\n                return promise;\n\n              case 50:\n                packageJson = _context6.sent;\n                this.packageLock.delete(lockKey);\n\n                if (packageJson.version) {\n                  _context6.next = 54;\n                  break;\n                }\n\n                throw new Error(\"Manifest missing a version identifier for \".concat(spec));\n\n              case 54:\n                packageJsonCacheForModule.set(packageJson.version, packageJson);\n                return _context6.abrupt(\"return\", packageJson);\n\n              case 56:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[16, 30, 34, 42], [35,, 37, 41]]);\n      }));\n\n      function readPackageJsonWithCache(_x10, _x11) {\n        return _readPackageJsonWithCache.apply(this, arguments);\n      }\n\n      return readPackageJsonWithCache;\n    }()\n  }, {\n    key: \"readPackageJson\",\n    value: function () {\n      var _readPackageJson = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(resolver, spec) {\n        var _ref13,\n            token,\n            url,\n            content,\n            manifest,\n            _args7 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _ref13 = _args7.length > 2 && _args7[2] !== undefined ? _args7[2] : {}, token = _ref13.token;\n                // console.log('readPackageJson(%s)', spec);\n                url = this.cdn.urlForPackageFile(spec, '/package.json');\n                _context7.next = 4;\n                return this.readFileContent(resolver, url, {\n                  token: token\n                });\n\n              case 4:\n                content = _context7.sent;\n                _context7.prev = 5;\n                manifest = util.parseBufferAsPackageJson(resolver.decoder, content, spec);\n                _context7.next = 12;\n                break;\n\n              case 9:\n                _context7.prev = 9;\n                _context7.t0 = _context7[\"catch\"](5);\n                throw new Error(\"Error parsing manifest as json for package \".concat(spec, \": \").concat(_context7.t0.message));\n\n              case 12:\n                return _context7.abrupt(\"return\", manifest);\n\n              case 13:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this, [[5, 9]]);\n      }));\n\n      function readPackageJson(_x12, _x13) {\n        return _readPackageJson.apply(this, arguments);\n      }\n\n      return readPackageJson;\n    }()\n  }, {\n    key: \"readPackageEntries\",\n    value: function () {\n      var _readPackageEntries = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8(spec) {\n        var _ref14,\n            token,\n            url,\n            href,\n            signal,\n            fetch,\n            res,\n            json,\n            _args8 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _ref14 = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : {}, token = _ref14.token;\n                // console.log('readPackageEntries(%s)', spec);\n                url = this.cdn.urlForPackageList(spec);\n                href = url.href;\n                signal = signalFromCancellationToken(token, this.AbortController);\n                fetch = this.fetch;\n                _context8.next = 7;\n                return fetch(href, {\n                  signal: signal\n                }).catch(function (err) {\n                  if (signal && signal.aborted) {\n                    throw new CanceledError('Canceled');\n                  }\n\n                  throw new FetchError(href, err);\n                });\n\n              case 7:\n                res = _context8.sent;\n\n                if (res.ok) {\n                  _context8.next = 10;\n                  break;\n                }\n\n                throw new Error(\"Error listing package contents for \".concat(spec, \": \").concat(res.status));\n\n              case 10:\n                _context8.next = 12;\n                return res.json();\n\n              case 12:\n                json = _context8.sent;\n                return _context8.abrupt(\"return\", this.cdn.normalizePackageListing(json));\n\n              case 14:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function readPackageEntries(_x14) {\n        return _readPackageEntries.apply(this, arguments);\n      }\n\n      return readPackageEntries;\n    }()\n  }]);\n\n  return ResolverHostUnpkg;\n}(AbstractResolverHost);\n\nexport { ResolverHostUnpkg, isValidDirectory, isValidEntry, isValidFile };","import { Bundler } from '@velcro/bundler';\nimport { Resolver, AbstractResolverHost, ResolverHost } from '@velcro/resolver';\nimport { openDB } from 'idb';\nimport { timeout } from 'ts-primitives';\nimport { TimeoutError } from './error';\n\ntype ThenArg<T> = T extends Promise<infer U> ? U : T;\n\nexport class ResolverHostWithCache extends AbstractResolverHost {\n  private readonly idbPromise = openDB('velcro', Bundler.schemaVersion, {\n    async upgrade(db, oldVersion, newVersion, transaction) {\n      if (!oldVersion) {\n        db.createObjectStore('getCanonicalUrl');\n        db.createObjectStore('getResolveRoot');\n        db.createObjectStore('listEntries');\n        db.createObjectStore('readFileContent');\n      }\n\n      await transaction.objectStore('getCanonicalUrl').clear();\n      await transaction.objectStore('getResolveRoot').clear();\n      await transaction.objectStore('listEntries').clear();\n      await transaction.objectStore('readFileContent').clear();\n    },\n  }).catch(err => {\n    console.error(err, 'error opening IndexedDB');\n\n    return null;\n  });\n\n  private readonly hostTimeout: number;\n  private readonly idbTimeout: number;\n\n  private readonly inflightGetCanonicalUrl = new Map<string, ReturnType<ResolverHost['getCanonicalUrl']>>();\n  private readonly inflightGetResolveRoot = new Map<string, ReturnType<ResolverHost['getResolveRoot']>>();\n  private readonly inflightListEntries = new Map<string, ReturnType<ResolverHost['listEntries']>>();\n  private readonly inflightReadFileContent = new Map<string, ReturnType<ResolverHost['readFileContent']>>();\n\n  private readonly getCanonicalUrlCache = new Map<string, ThenArg<ReturnType<ResolverHost['getCanonicalUrl']>>>();\n  private readonly getResolveRootCache = new Map<string, ThenArg<ReturnType<ResolverHost['getResolveRoot']>>>();\n  private readonly listEntriesCache = new Map<string, ThenArg<ReturnType<ResolverHost['listEntries']>>>();\n  private readonly readFileContentCache = new Map<string, ThenArg<ReturnType<ResolverHost['readFileContent']>>>();\n\n  constructor(readonly host: ResolverHost, { idbTimeout = 1000, hostTimeout = 10000 } = {}) {\n    super();\n\n    this.hostTimeout = hostTimeout;\n    this.idbTimeout = idbTimeout;\n  }\n\n  private async withCache<T, C = unknown>(\n    href: string,\n    loadFn: () => Promise<T>,\n    cache: Map<string, T>,\n    inflightMap: Map<string, Promise<T>>,\n    storeName: string,\n    serialize?: (result: T) => C,\n    deserialize?: (cached: C) => T\n  ): Promise<T> {\n    if (cache.has(href)) {\n      return cache.get(href)!;\n    }\n\n    const idb = await withTimeout(this.idbTimeout, this.idbPromise, `this.idbPromise`).catch(_ => undefined);\n\n    if (idb) {\n      const cached = await withTimeout(\n        this.idbTimeout,\n        idb.get(storeName, href),\n        `idb.get(${storeName}, ${href})`\n      ).catch(_ => undefined);\n\n      if (cached) {\n        const result = (deserialize ? deserialize(cached as any) : cached) as T;\n\n        cache.set(href, result);\n\n        return result;\n      }\n    }\n\n    let inflight = inflightMap.get(href);\n\n    if (!inflight) {\n      inflight = withTimeout(this.hostTimeout, loadFn(), `Timed out on operation '${storeName}' for '${href}'`);\n      inflightMap.set(href, inflight);\n\n      // Make sure we don't get an uncaught rejection\n      inflight\n        .then(result => {\n          cache.set(href, result);\n\n          if (idb) {\n            idb.put(storeName, serialize ? serialize(result) : result, href).catch(_ => undefined);\n          }\n        })\n        .catch(_ => undefined)\n        .then(() => {\n          inflightMap.delete(href);\n        });\n    }\n\n    return inflight;\n  }\n\n  async getCanonicalUrl(resolver: Resolver, url: URL) {\n    const result = await this.withCache(\n      url.href,\n      () => this.host.getCanonicalUrl(resolver, url),\n      this.getCanonicalUrlCache,\n      this.inflightGetCanonicalUrl,\n      'getCanonicalUrl',\n      url => url.href,\n      href => new URL(href)\n    );\n\n    return result;\n  }\n\n  async getResolveRoot(resolver: Resolver, url: URL) {\n    const result = await this.withCache(\n      url.href,\n      () => this.host.getResolveRoot(resolver, url),\n      this.getResolveRootCache,\n      this.inflightGetResolveRoot,\n      'getResolveRoot',\n      url => url.href,\n      href => new URL(href)\n    );\n\n    return result;\n  }\n\n  async listEntries(resolver: Resolver, url: URL) {\n    const result = await this.withCache(\n      url.href,\n      () => this.host.listEntries(resolver, url),\n      this.listEntriesCache,\n      this.inflightListEntries,\n      'listEntries',\n      entries =>\n        entries.map(entry => ({\n          type: entry.type,\n          href: entry.url.href,\n        })),\n      cached =>\n        cached.map(entry => ({\n          type: entry.type,\n          url: new URL(entry.href),\n        }))\n    );\n\n    return result;\n  }\n\n  async readFileContent(resolver: Resolver, url: URL) {\n    try {\n      const result = await this.withCache(\n        url.href,\n        () => this.host.readFileContent(resolver, url),\n        this.readFileContentCache,\n        this.inflightReadFileContent,\n        'readFileContent'\n      );\n\n      return result;\n    } catch (err) {\n      throw err;\n    }\n  }\n}\n\nfunction withTimeout<T>(duration: number, promise: Promise<T>, message: string) {\n  return Promise.race([\n    promise,\n    timeout(duration).then(() => {\n      return Promise.reject(new TimeoutError(message));\n    }),\n  ]);\n}\n","import * as Monaco from 'monaco-editor';\nimport { Emitter, IDisposable, DisposableStore, ThrottledDelayer } from 'ts-primitives';\nimport { useState, useEffect, useContext, createContext } from 'react';\nimport { TypeAcquirer } from './typeAcquisition';\nimport { Bundler } from '@velcro/bundler';\nimport { Resolver } from '@velcro/resolver';\nimport { ResolverHostCompound } from '@velcro/resolver-host-compound';\nimport { ResolverHostMonaco } from '../lib/ResolverHostMonaco';\nimport { ResolverHostUnpkg } from '@velcro/resolver-host-unpkg';\nimport { ResolverHostWithCache } from '../lib/ResolverHostWithCache';\n\nconst rootUri = Monaco.Uri.file('/');\n\nexport class EditorManager implements IDisposable {\n  readonly unpkgCdn = new ResolverHostUnpkg({\n    cdn: 'unpkg',\n  });\n\n  readonly bundler = new Bundler({\n    resolveBareModule: this.unpkgCdn.resolveBareModule.bind(this.unpkgCdn),\n    resolver: new Resolver(\n      new ResolverHostCompound({\n        [this.unpkgCdn.getRoot().href]: new ResolverHostWithCache(this.unpkgCdn),\n        [rootUri.toString(true)]: new ResolverHostMonaco(rootUri),\n      }),\n      {\n        extensions: ['.js', '.jsx', '.ts', '.tsx'],\n        packageMain: ['browser', 'main'],\n      }\n    ),\n  });\n\n  editor: Monaco.editor.IStandaloneCodeEditor | null = null;\n\n  private readonly disposableStore = new DisposableStore();\n  private readonly initialPath: string | undefined;\n\n  private readonly typeAcquirer = new TypeAcquirer(\n    this.bundler.resolver,\n    this.unpkgCdn.resolveBareModule.bind(this.unpkgCdn)\n  );\n  private readonly viewState = new WeakMap<Monaco.editor.ITextModel, Monaco.editor.ICodeEditorViewState>();\n\n  private readonly onWillFocusModelEmitter = new Emitter<Monaco.editor.ITextModel>();\n  private readonly onDidChangeEmitter = new Emitter<{ model: Monaco.editor.ITextModel }>();\n\n  constructor(options: { files?: Record<string, string>; initialPath?: string } = {}) {\n    this.disposableStore.add(this.onWillFocusModelEmitter);\n    this.disposableStore.add(this.onDidChangeEmitter);\n\n    Monaco.languages.typescript.typescriptDefaults.setEagerModelSync(true);\n    Monaco.languages.typescript.typescriptDefaults.setMaximumWorkerIdleTime(-1);\n    Monaco.languages.typescript.typescriptDefaults.setCompilerOptions({\n      allowJs: true,\n      allowNonTsExtensions: true,\n      allowSyntheticDefaultImports: true,\n      baseUrl: '.',\n      checkJs: true,\n      esModuleInterop: true,\n      experimentalDecorators: true,\n      inlineSourceMap: true,\n      inlineSources: true,\n      isolatedModules: false,\n      jsx: Monaco.languages.typescript.JsxEmit.React,\n      lib: ['dom'],\n      module: Monaco.languages.typescript.ModuleKind.CommonJS,\n      moduleResolution: Monaco.languages.typescript.ModuleResolutionKind.NodeJs,\n      noEmit: false,\n      outDir: `dist`,\n      resolveJsonModule: true,\n      rootDir: '/',\n      sourceMap: true,\n      target: Monaco.languages.typescript.ScriptTarget.ES2015,\n      typeRoots: ['node_modules/@types'],\n    });\n    Monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({\n      noSemanticValidation: true,\n      noSyntaxValidation: false,\n    });\n\n    if (options.files) {\n      for (const pathname in options.files) {\n        const content = options.files[pathname];\n\n        this.createModel(pathname, content);\n      }\n    }\n\n    Monaco.editor.onDidCreateModel(model => {\n      const onDidChangePackageJson = async () => {\n        const value = model.getValue();\n\n        let dependencies = {\n          typescript: Monaco.languages.typescript.typescriptVersion,\n        };\n\n        try {\n          const pkgJson = JSON.parse(value);\n\n          if (pkgJson.dependencies) {\n            dependencies = { ...dependencies, ...pkgJson.dependencies };\n          }\n        } catch (_) {\n          // Ignore\n        }\n\n        Monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({ noSemanticValidation: true });\n        await this.typeAcquirer.importTypesForSpecs(dependencies);\n        Monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({ noSemanticValidation: false });\n      };\n\n      if (model.uri.toString(true) === `${rootUri.toString(true)}package.json`) {\n        const throttler = new ThrottledDelayer(1500);\n        throttler.trigger(onDidChangePackageJson);\n\n        this.disposableStore.add(model.onDidChangeContent(() => throttler.trigger(onDidChangePackageJson)));\n        this.disposableStore.add(throttler);\n      }\n    });\n\n    this.disposableStore.add(\n      this.typeAcquirer.onTypeFile(file => {\n        this.disposableStore.add(\n          Monaco.languages.typescript.typescriptDefaults.addExtraLib(\n            file.content,\n            Monaco.Uri.file(file.pathname).toString(true)\n          )\n        );\n      })\n    );\n\n    this.initialPath = options.initialPath;\n  }\n\n  get dispose() {\n    return this.disposableStore.dispose;\n  }\n\n  get onDidChange() {\n    return this.onDidChangeEmitter.event;\n  }\n\n  get onWillFocusModel() {\n    return this.onWillFocusModelEmitter.event;\n  }\n\n  createModel(pathname: string, content = '') {\n    const language = this.inferLanguage(pathname);\n\n    let uri: Monaco.Uri;\n\n    try {\n      uri = Monaco.Uri.file(pathname);\n    } catch (err) {\n      throw new Error(`Invalid path '${pathname}': ${err && err.message}`);\n    }\n\n    if (Monaco.editor.getModel(uri)) {\n      throw new Error(`Cannot create file because it exists '${pathname}'`);\n    }\n\n    return Monaco.editor.createModel(content, language, uri);\n  }\n\n  focusHref(\n    href: string,\n    options: { lineNumber?: number; columnNumber?: number; markers?: Monaco.editor.IMarkerData[] } = {}\n  ) {\n    const model = this.getModelByHref(href);\n\n    if (model) {\n      this.focusModel(model, options);\n    }\n  }\n\n  focusModel(\n    model: Monaco.editor.ITextModel,\n    options: { lineNumber?: number; columnNumber?: number; markers?: Monaco.editor.IMarkerData[] } = {}\n  ) {\n    if (this.editor) {\n      this.editor.setModel(model);\n      if (options.lineNumber) {\n        this.editor.revealLineInCenter(options.lineNumber, Monaco.editor.ScrollType.Smooth);\n        this.editor.setPosition({\n          column: options.columnNumber || 0,\n          lineNumber: options.lineNumber,\n        });\n      }\n      if (options.markers) {\n        Monaco.editor.setModelMarkers(model, 'editorManager', options.markers);\n      }\n      this.editor.focus();\n    }\n  }\n\n  focusPath(\n    path: string,\n    options: { lineNumber?: number; columnNumber?: number; markers?: Monaco.editor.IMarkerData[] } = {}\n  ) {\n    const model = this.getModelByPath(path);\n\n    if (model) {\n      this.focusModel(model, options);\n    }\n  }\n\n  getModelByHref(href: string) {\n    try {\n      const uri = Monaco.Uri.parse(href);\n      return Monaco.editor.getModel(uri);\n    } catch (_) {\n      return null;\n    }\n  }\n\n  getModelByPath(path: string) {\n    return Monaco.editor.getModel(Monaco.Uri.file(path));\n  }\n\n  mount(el: HTMLElement) {\n    if (this.editor) {\n      throw new Error('Invariant violation: Editor already mounted');\n    }\n\n    this.editor = Monaco.editor.create(el, {\n      model: null,\n      automaticLayout: true,\n      minimap: {\n        enabled: false,\n      },\n      showUnused: true,\n      scrollBeyondLastLine: false,\n      theme: 'vs',\n      wordWrap: 'bounded',\n      wrappingIndent: 'same',\n    });\n\n    this.editor.onDidDispose(() => {\n      this.editor = null;\n    });\n\n    this.editor.onDidChangeModel(e => {\n      if (e.newModelUrl && this.editor) {\n        const model = Monaco.editor.getModel(e.newModelUrl)!;\n        const viewState = this.viewState.get(model);\n\n        if (viewState) {\n          this.editor.restoreViewState(viewState);\n        }\n      }\n    });\n\n    this.editor.onDidBlurEditorText(() => {\n      if (this.editor) {\n        const model = this.editor.getModel();\n        const viewState = this.editor.saveViewState();\n\n        if (model && viewState) {\n          this.viewState.set(model, viewState);\n        }\n      }\n    });\n\n    this.disposableStore.add(this.editor);\n\n    if (this.initialPath) {\n      this.focusPath(this.initialPath);\n    }\n\n    return this.editor;\n  }\n\n  inferLanguage(pathname: string) {\n    return pathname.match(/\\.(?:tsx?|jsx?)$/) ? 'typescript' : undefined;\n  }\n}\n\nexport const EditorManagerContext = createContext(new EditorManager());\n\nexport function useActiveModel() {\n  const workbench = useContext(EditorManagerContext);\n  const [activeModel, setActiveModel] = useState<Monaco.editor.ITextModel | null>(\n    workbench.editor ? workbench.editor.getModel() : null\n  );\n\n  useEffect(() => {\n    const disposable = new DisposableStore();\n\n    const trackEditor = (editor: Monaco.editor.ICodeEditor) => {\n      editor.onDidChangeModel(e => {\n        const model = e.newModelUrl ? Monaco.editor.getModel(e.newModelUrl) : null;\n\n        setActiveModel(model);\n      });\n\n      disposable.add(\n        editor.onDidBlurEditorText(() => {\n          setActiveModel(null);\n        })\n      );\n\n      disposable.add(\n        editor.onDidFocusEditorText(() => {\n          setActiveModel(editor.getModel());\n        })\n      );\n\n      if (editor.hasTextFocus()) {\n        setActiveModel(editor.getModel());\n      }\n    };\n\n    disposable.add(Monaco.editor.onDidCreateEditor(trackEditor));\n    if (workbench.editor) {\n      trackEditor(workbench.editor);\n    }\n\n    return () => disposable.dispose();\n  }, [workbench.editor, activeModel]);\n\n  return activeModel;\n}\n","import styled from '@emotion/styled/macro';\nimport React, { useRef, useEffect, useContext } from 'react';\nimport { EditorManagerContext } from '../lib/EditorManager';\n\nconst Editor: React.FC<{\n  className?: string;\n}> = ({ className }) => {\n  const el = useRef<HTMLDivElement | null>(null);\n  const editorManager = useContext(EditorManagerContext);\n\n  useEffect(() => {\n    if (!el.current) {\n      return;\n    }\n\n    const editor = editorManager.mount(el.current);\n\n    return () => {\n      editor.dispose();\n    };\n  }, [editorManager, el]);\n\n  return (\n    <div className={className} ref={el}>\n      <div></div>\n    </div>\n  );\n};\n\nexport default styled(Editor)``;\n","import styled from '@emotion/styled/macro';\nimport { InvariantViolation, Runtime } from '@velcro/bundler';\nimport { CanceledError } from '@velcro/resolver';\nimport * as Monaco from 'monaco-editor';\nimport React, { useEffect, useRef, useContext, useState } from 'react';\nimport {\n  Delayer,\n  Throttler,\n  DisposableStore,\n  CancellationTokenSource,\n  IDisposable,\n  Emitter,\n  Event,\n  timeout,\n} from 'ts-primitives';\n\nimport { EditorManagerContext } from '../lib/EditorManager';\nimport { TimeoutError } from '../lib/error';\nimport { Bundle } from '@velcro/bundler/dist/dist-main/bundle';\n\nexport interface DeferredExecutionModuleRecord {\n  code: string;\n  dependencies: Record<string, string>;\n}\n\nexport interface DeferredExecutionManifest {\n  aliases: Record<string, string>;\n  entrypoints: Record<string, string>;\n  modules: Record<string, DeferredExecutionModuleRecord>;\n}\n\ninterface MessageLine {\n  isInternal: boolean;\n  text: string;\n}\ninterface Message {\n  lines: MessageLine[];\n}\n\nconst PreviewProgress = styled.div<{ completed: number; total: number }>`\n  z-index: 1;\n  position: absolute;\n  top: 0;\n  width: ${props => (props.total ? `${Math.round((100 * props.completed) / props.total)}%` : 0)};\n  left: 0;\n  height: ${props => (props.total ? '2px' : '0')};\n  background-color: #008cba;\n  transition: width 0.5s 0s cubic-bezier(0.455, 0.03, 0.515, 0.955);\n`;\nconst PreviewIframeWrap = styled.div`\n  position: relative;\n  overflow: hidden;\n\n  & > iframe {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    border: none;\n    width: 100%;\n    height: 100%;\n  }\n`;\nconst PreviewWrap = styled.div`\n  position: relative;\n  background: white;\n\n  ${PreviewIframeWrap} {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n`;\nconst PreviewMessageError = styled.ul`\n  margin: 0;\n  padding: 1em 2em;\n  font-family: monospace;\n  font-size: 16px;\n  background-color: rgba(255, 0, 0, 0.5);\n  backdrop-filter: brightness(50%);\n  color: white;\n  list-style: none;\n`;\nconst PreviewMessageErrorText = styled.li<{ isInternal: boolean }>`\n  white-space: pre-wrap;\n  opacity: ${props => (props.isInternal ? 0.7 : 1.0)};\n`;\nconst PreviewMessages = styled.div`\n  z-index: 1;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  display: flex;\n  flex-direction: column-reverse;\n`;\nconst PreviewMessageLine: React.FC<{ line: MessageLine }> = ({ line }) => {\n  return <PreviewMessageErrorText isInternal={line.isInternal}>{line.text}</PreviewMessageErrorText>;\n};\nconst PreviewMessage: React.FC<{ message: Message }> = ({ message }) => {\n  return message.lines.length ? (\n    <PreviewMessageError>\n      {message.lines.map((line, i) => (\n        <PreviewMessageLine key={i} line={line}></PreviewMessageLine>\n      ))}\n    </PreviewMessageError>\n  ) : null;\n};\n\nconst Preview: React.FC<{ className?: string }> = props => {\n  const invalidations = useRef(new Set<string>());\n  const previewWrapRef = useRef<HTMLDivElement | null>(null);\n  const hmrClientRef = useRef<HmrClient | null>(null);\n  const previewIframeRef = useRef<HTMLIFrameElement | null>(null);\n  const editorManager = useContext(EditorManagerContext);\n  const [messages, setMessages] = useState([] as Message[]);\n  const [buildProgress, setBuildProgress] = useState({ completed: 0, total: 0 });\n  const runtimeBundleString = useRef('');\n\n  useEffect(() => {\n    const disposable = new DisposableStore();\n    const delayer = new Delayer(500);\n    const throttler = new Throttler();\n\n    let tokenSource = new CancellationTokenSource();\n\n    const queueRefreshPreview = (uris: string[]) => {\n      tokenSource.cancel();\n      tokenSource.dispose();\n\n      tokenSource = new CancellationTokenSource();\n\n      for (const uri of uris) {\n        invalidations.current.add(uri);\n      }\n\n      delayer.trigger(() => throttler.queue(() => refreshPreview(tokenSource.token)));\n    };\n\n    const refreshPreview = async (token: Monaco.CancellationToken) => {\n      const toInvalidate = Array.from(invalidations.current);\n\n      setMessages([]);\n\n      invalidations.current.clear();\n\n      setBuildProgress({ completed: 0, total: 0 });\n\n      let building = true;\n\n      try {\n        await Promise.all(\n          toInvalidate.map(spec => {\n            return editorManager.bundler.invalidate(spec, { token });\n          })\n        );\n\n        if (!runtimeBundleString.current) {\n          const runtimeBundle = await editorManager.bundler.generateBundle(\n            [\n              {\n                type: 'inline',\n                code: `(${createBundleRuntime.toString().replace(/velcroRequire/g, 'require')})();`,\n                href: 'playground:///runtime.js',\n              },\n            ],\n            {\n              dependencies: {\n                'react-error-overlay': '^6.0.3',\n              },\n              onCompleteAsset: () => {\n                if (building) {\n                  setBuildProgress(buildProgress => {\n                    return {\n                      completed: buildProgress.completed + 1,\n                      total: buildProgress.total,\n                    };\n                  });\n                }\n              },\n              onEnqueueAsset: () => {\n                if (building) {\n                  setBuildProgress(buildProgress => {\n                    return {\n                      completed: buildProgress.completed,\n                      total: buildProgress.total + 1,\n                    };\n                  });\n                }\n              },\n              token,\n            }\n          );\n\n          runtimeBundleString.current = runtimeBundle.toString({ executeEntrypoints: true, sourceMap: false });\n        }\n\n        let build: Bundle | Error;\n\n        try {\n          const unresolvedEntrypointHref = Monaco.Uri.file('/').toString(true);\n          const resolvedEntrypoint = await editorManager.bundler.resolver.resolve(unresolvedEntrypointHref);\n\n          if (!resolvedEntrypoint.resolvedUrl) {\n            throw new Error(`Unable to determine the entrypoing to your code`);\n          }\n\n          const resolvedEntrypointHref = resolvedEntrypoint.resolvedUrl.href;\n\n          build = await editorManager.bundler.generateBundle(\n            [\n              {\n                type: 'href',\n                href: resolvedEntrypointHref,\n              },\n            ],\n            {\n              onCompleteAsset: () => {\n                if (building) {\n                  setBuildProgress(buildProgress => {\n                    return {\n                      completed: buildProgress.completed + 1,\n                      total: buildProgress.total,\n                    };\n                  });\n                }\n              },\n              onEnqueueAsset: () => {\n                if (building) {\n                  setBuildProgress(buildProgress => {\n                    return {\n                      completed: buildProgress.completed,\n                      total: buildProgress.total + 1,\n                    };\n                  });\n                }\n              },\n              token,\n            }\n          );\n        } catch (err) {\n          build = err;\n        }\n\n        if (hmrClientRef.current) {\n          if (build instanceof CanceledError || (build instanceof Error && build.name === 'CanceledError')) {\n            return;\n          } else if (build instanceof Error) {\n            hmrClientRef.current.send({\n              type: 'build_error',\n              message: build.message,\n              stack: build.stack,\n            });\n          } else {\n            const updatedBundleFile = new File(\n              [build.toString({ executeEntrypoints: false, runtime: '__velcroRuntime', sourceMap: true })],\n              'playground:///runtime.js',\n              {\n                type: 'text/javascript',\n              }\n            );\n            const updatedBundleHref = URL.createObjectURL(updatedBundleFile);\n\n            hmrClientRef.current.send({\n              type: 'reload',\n              invalidations: toInvalidate,\n              href: updatedBundleHref,\n            });\n          }\n\n          await Promise.race([\n            Event.toPromise(hmrClientRef.current.onReload),\n            timeout(5000).then(() => {\n              throw new TimeoutError(`HMR refresh timed out`);\n            }),\n          ]);\n        } else {\n          let bundledCode: string;\n\n          if (build instanceof Error) {\n            bundledCode = `ReactErrorOverlay.reportBuildError(${JSON.stringify(build.message)});\\n`;\n          } else {\n            bundledCode = `__velcroRuntime = ${build.toString({ executeEntrypoints: true, sourceMap: true })}`;\n          }\n\n          const runtimeFile = new File([runtimeBundleString.current], 'playground:///runtime.js', {\n            type: 'text/javascript',\n          });\n          const bundleFile = new File([bundledCode], 'playground:///index.js', {\n            type: 'text/javascript',\n          });\n          const markup = new File(\n            [\n              `\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n<title>Document</title>\n<script src=\"${URL.createObjectURL(runtimeFile)}\"></script>\n</head>\n<body>\n<div id=\"root\"></div>\n<script src=\"${URL.createObjectURL(bundleFile)}\"></script>\n</body>\n</html>`,\n            ],\n            Monaco.Uri.file('/index.html').toString(true),\n            {\n              type: 'text/html',\n            }\n          );\n          const htmlUrl = URL.createObjectURL(markup);\n          const iframe = document.createElement('iframe');\n          iframe.style.display = 'none';\n          iframe.src = htmlUrl;\n\n          if (previewWrapRef.current) {\n            previewWrapRef.current.appendChild(iframe);\n          }\n\n          try {\n            await new Promise((resolve, reject) => {\n              iframe.onload = () => resolve();\n              iframe.onerror = reject;\n            });\n\n            if (previewIframeRef.current) {\n              previewIframeRef.current.remove();\n            }\n\n            iframe.style.display = '';\n\n            previewIframeRef.current = iframe;\n          } catch (err) {\n            iframe.remove();\n\n            throw err;\n          }\n        }\n      } catch (err) {\n        tokenSource.cancel();\n\n        if (!(err instanceof CanceledError) && (err && err.name !== 'CanceledError')) {\n          setMessages(messages => [...messages, { lines: [{ isInternal: false, text: err.message }] }]);\n        }\n      } finally {\n        if (tokenSource) {\n          tokenSource.dispose();\n        }\n\n        building = false;\n\n        setBuildProgress({ completed: 0, total: 0 });\n      }\n    };\n\n    disposable.add(delayer);\n\n    for (const model of Monaco.editor.getModels()) {\n      disposable.add(\n        model.onDidChangeContent(() => {\n          queueRefreshPreview([model.uri.toString(true)]);\n        })\n      );\n    }\n\n    disposable.add(\n      Monaco.editor.onDidCreateModel(model => {\n        queueRefreshPreview([model.uri.toString(true)]);\n\n        disposable.add(\n          model.onDidChangeContent(() => {\n            queueRefreshPreview([model.uri.toString(true)]);\n          })\n        );\n      })\n    );\n\n    disposable.add(\n      Monaco.editor.onWillDisposeModel(model => {\n        queueRefreshPreview([model.uri.toString(true)]);\n      })\n    );\n\n    disposable.add(\n      (() => {\n        const onMessage = async (e: MessageEvent) => {\n          if (\n            (previewIframeRef.current && e.source !== previewIframeRef.current.contentWindow) ||\n            !e.data ||\n            typeof e.data.type !== 'string' ||\n            !e.data.payload\n          ) {\n            return;\n          }\n\n          switch (e.data.type) {\n            case 'error_open': {\n              if (!editorManager.editor) {\n                return;\n              }\n\n              const model = editorManager.getModelByHref(e.data.payload.fileName);\n\n              if (model) {\n                let lineNumber: number | undefined = e.data.payload.lineNumber;\n                let columnNumber: number | undefined = undefined;\n\n                if (lineNumber !== undefined) {\n                  const row = model.getLineContent(lineNumber);\n                  const matches = row.match(/^(\\s*)/);\n\n                  columnNumber = matches ? matches[1].length + 1 : undefined;\n                }\n\n                editorManager.focusModel(model, {\n                  lineNumber,\n                  columnNumber,\n                });\n              }\n\n              break;\n            }\n            case 'hmr_ready': {\n              if (!(e.data.payload instanceof MessagePort)) {\n                console.warn(\n                  'Received \"hmr_ready\" message from preview but did not receive the expected MessagePort payload',\n                  e.data\n                );\n                return;\n              }\n\n              hmrClientRef.current = new HmrClient(e.data.payload);\n              break;\n            }\n            default: {\n              console.debug({ message: e.data }, 'Unknown message received from preview iframe');\n            }\n          }\n        };\n\n        window.addEventListener('message', onMessage);\n        return {\n          dispose() {\n            window.removeEventListener('message', onMessage);\n          },\n        };\n      })()\n    );\n\n    disposable.add({\n      dispose() {\n        if (hmrClientRef.current) {\n          hmrClientRef.current.dispose();\n        }\n      },\n    });\n\n    queueRefreshPreview([]);\n\n    return () => disposable.dispose();\n  }, [editorManager.bundler, editorManager, invalidations]);\n\n  return (\n    <PreviewWrap className={props.className}>\n      <PreviewProgress completed={buildProgress.completed} total={buildProgress.total}></PreviewProgress>\n      {previewIframeRef.current ? null : 'Building the preview...'}\n      <PreviewIframeWrap ref={previewWrapRef}></PreviewIframeWrap>\n      <PreviewMessages>\n        {messages.map((message, idx) => (\n          <PreviewMessage key={idx} message={message}></PreviewMessage>\n        ))}\n      </PreviewMessages>\n    </PreviewWrap>\n  );\n};\n\nexport default styled(Preview)``;\n\ndeclare var velcroRequire: NodeRequire;\ndeclare var __velcroRuntime: Runtime;\n\n/**\n * Important: This function needs to be fully self-contained because it will be stringified.\n * @param filename\n */\nfunction createBundleRuntime() {\n  const ReactErrorOverlay = velcroRequire('react-error-overlay') as typeof import('react-error-overlay');\n  const channel = new MessageChannel();\n\n  //@ts-ignore\n  window.ReactErrorOverlay = ReactErrorOverlay;\n\n  ReactErrorOverlay.setEditorHandler(err => {\n    window.parent.postMessage({ type: 'error_open', payload: err }, '*');\n  });\n  ReactErrorOverlay.startReportingRuntimeErrors({\n    onError: () => undefined,\n  });\n\n  channel.port2.onmessage = function(e) {\n    if (!e.data || typeof e.data !== 'object') {\n      throw new Error(`Unexpected message received by HMR server`);\n    }\n\n    switch (e.data.type) {\n      case 'build_error': {\n        ReactErrorOverlay.dismissRuntimeErrors();\n        ReactErrorOverlay.reportBuildError(e.data.message || e.data);\n\n        channel.port2.postMessage({\n          type: 'reload',\n        });\n        break;\n      }\n      case 'reload': {\n        if (isValidReload(e.data)) {\n          ReactErrorOverlay.dismissBuildError();\n          ReactErrorOverlay.dismissRuntimeErrors();\n          const reload = e.data;\n          const runtime = __velcroRuntime;\n          const queue = reload.invalidations.slice();\n          const seen = new Set<string>();\n          const potentialOrphans = new Set<string>();\n          const requireReload = [] as string[];\n          const acceptCallbackQueue = [] as ({ module: typeof runtime.root; cb: () => void })[];\n          const disposeCallbackQueue = [] as ({ module: typeof runtime.root; cb: () => void })[];\n\n          while (queue.length) {\n            const href = queue.shift()!;\n\n            if (seen.has(href)) continue;\n            seen.add(href);\n\n            const module = runtime.get(href);\n\n            if (!module) {\n              continue;\n            }\n\n            module.dependencies.forEach(dependency => {\n              potentialOrphans.add(dependency.id);\n            });\n\n            potentialOrphans.delete(module.id);\n\n            for (const disposeCallback of module.disposeCallbacks) {\n              disposeCallbackQueue.push({ module, cb: disposeCallback.cb });\n            }\n\n            if (module.acceptCallbacks.length) {\n              for (const acceptCallback of module.acceptCallbacks) {\n                acceptCallbackQueue.push({ module, cb: acceptCallback.cb });\n              }\n            } else {\n              const isEntrypoint = module.dependents.has(runtime.root);\n\n              if (isEntrypoint) {\n                requireReload.push(module.id);\n              } else {\n                module.dependents.forEach(dependent => {\n                  if (!seen.has(dependent.id)) {\n                    queue.push(dependent.id);\n                  }\n                });\n              }\n            }\n          }\n\n          seen.forEach(href => {\n            runtime.remove(href);\n          });\n\n          const script = document.createElement('script');\n          script.src = reload.href;\n          script.onerror = function(err) {\n            channel.port2.postMessage({\n              type: 'reload',\n              err,\n            });\n          };\n          script.onload = function() {\n            disposeCallbackQueue.forEach(({ cb, module }) => {\n              cb();\n            });\n            acceptCallbackQueue.forEach(({ cb, module }) => {\n              cb();\n            });\n\n            for (const toReload of requireReload) {\n              runtime.require(toReload);\n            }\n\n            // Find any module that will become orphaned by this change and\n            // dispose it\n            potentialOrphans.forEach(potentialOrphan => {\n              const potentialOrphanModule = runtime.get(potentialOrphan);\n\n              if (potentialOrphanModule && potentialOrphanModule.dependents.size === 0) {\n                for (const disposeCallback of potentialOrphanModule.disposeCallbacks) {\n                  disposeCallback.cb();\n                }\n\n                runtime.remove(potentialOrphan);\n              }\n            });\n\n            channel.port2.postMessage({\n              type: 'reload',\n            });\n          };\n\n          document.head.appendChild(script);\n        }\n      }\n    }\n  };\n\n  window.parent.postMessage({ type: 'hmr_ready', payload: channel.port1 }, '*', [channel.port1]);\n\n  //#region Type Guards\n\n  function isObject(val: unknown): val is Record<string | number, unknown> {\n    return val && typeof val === 'object';\n  }\n\n  function isString(val: unknown): val is string {\n    return typeof val === 'string';\n  }\n\n  function isValidReload(message: unknown): message is HmrReloadRequest {\n    if (!isObject(message)) return false;\n\n    if (message.type !== 'reload') return false;\n\n    if (!Array.isArray(message.invalidations) || message.invalidations.find(entry => typeof entry !== 'string')) {\n      return false;\n    }\n\n    return isString(message.href);\n  }\n  //#endregion\n}\n\ninterface HmrBuildErrorRequest {\n  type: 'build_error';\n  message?: string;\n  stack?: string;\n}\ninterface HmrReloadRequest {\n  type: 'reload';\n  href: string;\n  invalidations: string[];\n}\n\ninterface HmrReloadResponse {}\n\nclass HmrClient implements IDisposable {\n  private readonly onReloadEmitter = new Emitter<HmrReloadResponse>();\n\n  constructor(private readonly port: MessagePort) {\n    port.onmessage = e => {\n      if (!e.data || typeof e.data !== 'object') {\n        throw new InvariantViolation('Unexpected message received from HMR client');\n      }\n\n      switch (e.data.type) {\n        case 'reload': {\n          this.onReloadEmitter.fire(e.data);\n          break;\n        }\n        default: {\n          throw new InvariantViolation(`Unexpected message with type '${e.data.type}' received from HMR client`);\n        }\n      }\n    };\n  }\n\n  get onReload() {\n    return this.onReloadEmitter.event;\n  }\n\n  dispose() {\n    this.port.close();\n  }\n\n  send(message: HmrBuildErrorRequest | HmrReloadRequest) {\n    this.port.postMessage(message);\n  }\n}\n","import * as Monaco from 'monaco-editor';\nimport { useEffect, useState } from 'react';\nimport { DisposableStore } from 'ts-primitives';\n\n// import { EditorContext } from './context';\n\nexport enum EntryKind {\n  Directory = 'directory',\n  File = 'file',\n}\n\nexport interface IDirectory {\n  type: EntryKind.Directory;\n  uri: Monaco.Uri;\n}\nexport interface IFile {\n  type: EntryKind.File;\n  uri: Monaco.Uri;\n  model: Monaco.editor.ITextModel;\n}\n\nexport type DirectoryEntry = IDirectory | IFile;\n\nexport function useDirectory(uri: Monaco.Uri) {\n  // Make sure the URI always ends with a trailing slash\n  const prefix = uri.toString(true).replace(/\\/?$/, '/');\n  const sortEntries = (models: (DirectoryEntry)[]) => {\n    return [...models].sort((a, b) => (a.uri.fsPath > b.uri.fsPath ? 1 : -1));\n  };\n\n  const initialEntries = sortEntries(\n    Monaco.editor.getModels().reduce(\n      (entries, model) => {\n        const modelUri = model.uri.toString(true);\n\n        if (modelUri.startsWith(prefix)) {\n          const nestedPath = modelUri.slice(prefix.length);\n          const nextDirIdx = nestedPath.indexOf('/');\n\n          if (nextDirIdx === 0) {\n            throw new Error('Invariant error: WAT?');\n          }\n\n          if (nextDirIdx > 0) {\n            // This is an intermediate directory\n            const uri = Monaco.Uri.parse(`${prefix}${nestedPath.slice(0, nextDirIdx + 1)}`);\n\n            entries.push({\n              type: EntryKind.Directory,\n              uri,\n            });\n          } else {\n            entries.push({\n              type: EntryKind.File,\n              uri: model.uri,\n              model,\n            });\n          }\n        }\n\n        return entries;\n      },\n      [] as DirectoryEntry[]\n    )\n  );\n  const [entries, setEntries] = useState(initialEntries);\n\n  useEffect(() => {\n    const disposable = new DisposableStore();\n    const prefix = uri.toString(true).replace(/\\/?$/, '/');\n\n    disposable.add(\n      Monaco.editor.onDidCreateModel((model: Monaco.editor.ITextModel) => {\n        const modelUri = model.uri.toString(true);\n\n        if (modelUri.startsWith(prefix)) {\n          const nestedPath = modelUri.slice(prefix.length);\n          const nextDirIdx = nestedPath.indexOf('/');\n\n          if (nextDirIdx === 0) {\n            throw new Error('Invariant error: WAT?');\n          }\n\n          if (nextDirIdx > 0) {\n            // This is an intermediate directory\n            const uri = Monaco.Uri.parse(`${prefix}${nestedPath.slice(0, nextDirIdx)}`);\n\n            // It is possible that we already have this directory\n            const entry = entries.find(entry => entry.uri.toString(true) === uri.toString(true));\n\n            if (entry) {\n              if (entry.type !== EntryKind.Directory) {\n                throw new Error(\n                  `Invariant violation: A file in '${prefix}' conflicts with the path of the new file '${modelUri}'`\n                );\n              }\n\n              return;\n            }\n\n            entries.push({ type: EntryKind.Directory, uri });\n\n            return setEntries(sortEntries(entries));\n          }\n\n          if (\n            !entries.find(\n              entry => entry.type === EntryKind.File && entry.uri.toString(true) === model.uri.toString(true)\n            )\n          ) {\n            entries.push({ type: EntryKind.File, uri: model.uri, model });\n\n            setEntries(sortEntries(entries));\n          }\n        }\n      })\n    );\n\n    disposable.add(\n      Monaco.editor.onWillDisposeModel(model => {\n        const idx = entries.findIndex(entry => entry.type === EntryKind.File && entry.model === model);\n\n        if (idx === -1) {\n          throw new Error(`Invariant violation: Removing an untracked model: '${model.uri.fsPath}'`);\n        }\n\n        entries.splice(idx, 1);\n\n        setEntries(sortEntries(entries));\n      })\n    );\n\n    return () => disposable.dispose();\n  }, [entries, uri]);\n\n  return entries;\n}\n","import styled from '@emotion/styled/macro';\nimport * as Monaco from 'monaco-editor';\nimport React, { useContext, useRef } from 'react';\nimport { Button } from 'reakit/Button';\nimport { Tooltip, TooltipReference, useTooltipState } from 'reakit/Tooltip';\nimport { useDirectory, EntryKind } from '../lib/hooks';\nimport { useActiveModel, EditorManagerContext } from '../lib/EditorManager';\n\nconst Entry = styled.div<{ modelFocused: boolean }>`\n  background-color: ${props => (props.modelFocused ? '#008cba' : 'inherit')};\n  text-decoration: none;\n  color: ${props => (props.modelFocused ? '#fff' : '#262626')};\n\n  height: 25px;\n  padding: 0 0 0 8px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n\n  & > span {\n    flex: 1;\n  }\n\n  & > button {\n    display: none;\n  }\n\n  &:hover > button {\n    display: block;\n  }\n\n  ${props =>\n    props.modelFocused\n      ? {\n          ':hover': {\n            color: '#f5f5f5',\n            cursor: 'pointer',\n          },\n        }\n      : {\n          ':hover': {\n            backgroundColor: '#eee',\n            color: '#262626',\n            cursor: 'pointer',\n          },\n        }}\n`;\n\nconst CreateEntry = styled.div`\n  text-decoration: none;\n  color: '#262626';\n\n  height: 25px;\n  padding: 0 0 0 8px;\n  display: flex;\n  align-items: center;\n\n  :hover {\n    background-color: #eee;\n    cursor: pointer;\n  }\n`;\n\nconst SidebarFileDelete = styled(Button)`\n  border: none;\n  background: none;\n\n  :hover {\n    cursor: pointer;\n  }\n`;\n\nconst StyledTooltip = styled.div`\n  font-family: Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  line-height: 1.4;\n  background-color: #333;\n  color: #fff;\n  border-radius: 4px;\n  opacity: 0.9;\n  padding: 0.2em 0.4em;\n`;\n\nconst SidebarFile: React.FC<{ className?: string; model: Monaco.editor.ITextModel }> = ({ className, model }) => {\n  const activeModel = useActiveModel();\n  const editorManager = useContext(EditorManagerContext);\n  const tooltip = useTooltipState({ gutter: 0 });\n\n  const onClickDelete = () => {\n    model.dispose();\n  };\n\n  return (\n    <Entry className={className} modelFocused={model === activeModel}>\n      <span onClick={() => editorManager.focusModel(model)}>{model.uri.fsPath.slice(1)}</span>\n      <TooltipReference {...tooltip} as={SidebarFileDelete} onClick={() => onClickDelete()}>\n        <span role=\"img\" aria-label=\"Delete file\">\n          \n        </span>\n      </TooltipReference>\n      <Tooltip {...tooltip} as={StyledTooltip}>\n        Delete file\n      </Tooltip>\n    </Entry>\n  );\n};\n\nconst Sidebar: React.FC<{ className?: string }> = props => {\n  const rootDir = useRef(Monaco.Uri.file('/'));\n  const entries = useDirectory(rootDir.current);\n  const editorManager = useContext(EditorManagerContext);\n\n  const onClickCreate = () => {\n    const filename = prompt('Filename?');\n\n    if (filename) {\n      editorManager.createModel(filename);\n    }\n  };\n\n  return (\n    <div className={props.className}>\n      {entries.map(entry =>\n        entry.type === EntryKind.Directory ? (\n          <div>{entry.uri.fsPath.slice(1)}</div>\n        ) : (\n          <SidebarFile key={entry.uri.toString(true)} model={entry.model}></SidebarFile>\n        )\n      )}\n      <CreateEntry onClick={() => onClickCreate()}>Create...</CreateEntry>\n    </div>\n  );\n};\n\nexport default styled(Sidebar)`\n  display: flex;\n  flex-direction: column;\n`;\n","import styled from '@emotion/styled/macro';\nimport React from 'react';\n\nimport Editor from './Editor';\nimport Preview from './Preview';\nimport Sidebar from './Sidebar';\nimport { EditorManager, EditorManagerContext } from '../lib/EditorManager';\n\nconst PlaygroundCmp: React.FC<{ className?: string; initialPath: string; project: Record<string, string> }> = ({\n  className,\n  initialPath,\n  project,\n}) => {\n  const editorManager = new EditorManager({ files: project, initialPath: initialPath });\n\n  return (\n    <div className={className}>\n      <EditorManagerContext.Provider value={editorManager}>\n        <Sidebar></Sidebar>\n        <Editor></Editor>\n        <Preview></Preview>\n      </EditorManagerContext.Provider>\n    </div>\n  );\n};\n\nexport const Playground = styled(PlaygroundCmp)`\n  display: flex;\n  flex-direction: row;\n\n  font-family: Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  line-height: 1.4;\n\n  color: #222;\n\n  ${Sidebar} {\n    flex: 1 1 100px;\n    min-width: 100px;\n    max-width: 400px;\n    border-right: 1px solid #ccc;\n  }\n\n  ${Editor} {\n    border-right: 1px solid #ccc;\n  }\n\n  ${Editor}, ${Preview} {\n    flex: 10;\n  }\n`;\n","export const files = {\n  'package.json':\n    JSON.stringify(\n      {\n        dependencies: {\n          'github-markdown-css': '^3.0.1',\n          react: '^16.9.0',\n          'react-dom': '^16.9.0',\n        },\n      },\n      null,\n      2\n    ) + '\\n',\n  'app.jsx': `\nimport React, { Component } from 'react';\n\nimport 'github-markdown-css';\nimport './style.css';\n\nimport { Explanation } from './explanation';\nimport { name } from './name';\n\nclass Hello extends Component {\n  render() {\n    return <div className=\"markdown-body\">\n      <h1>Hello {name}</h1>\n      <blockquote>There is no <del>spoon</del> server</blockquote>\n      <Explanation/>\n    </div>;\n  }\n}\n\nexport default Hello\n  `.trim(),\n  'explanation.jsx':\n    `\nimport React from 'react';\n\nexport const Explanation = () => <>\n  <section>\n    <h2>What is this?</h2>\n    <p>\n      This is a demo of bundling and serving a browser-based sandbox fully from the browser. <strong>There are <em>no</em> servers involved</strong> except the static server hosting this demo and <a href=\"https://unpkg.com\" target=\"_blank\" rel=\"noopener\">unpkg.com</a>. All module resolution, transpilation and bundling is happening in the browser.\n    </p>\n    <p>\n      Try it. Go offline, and reload...\n    </p>\n    <p>\n      <strong>I dare you.</strong>\n    </p>\n  </section>\n  <section>\n    <h2>Features</h2>\n    <ul>\n      <li>Full offline support. Once your cache is seeded, you can cut the cord.</li>\n      <li>Fully browser-based bundling.</li>\n      <li>Add (almost) any node module and no server is involved.</li>\n      <li>If you want to add another module, make sure to add it to <code>package.json</code> first.</li>\n      <li>Automatic type acquisition for full typings support in the browser, in JavaScript!</li>\n      <li>Resolve source locations in stack traces</li>\n      <li>Hot module reloading</li>\n    </ul>\n  </section>\n</>;\n    `.trim() + '\\n',\n  'index.jsx':\n    `\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './app';\n  \nReactDOM.render(\n  <App/>,\n  document.getElementById('root')\n);\n      `.trim() + '\\n',\n  'name.js':\n    `\nexport const name = 'Velcro';\n    `.trim() + '\\n',\n  'style.css':\n    `\n.markdown-body {\n  box-sizing: border-box;\n  min-width: 200px;\n  max-width: 980px;\n  margin: 0 auto;\n  padding: 45px;\n}\n\n@media (max-width: 767px) {\n  .markdown-body {\n    padding: 15px;\n  }\n}\n    `.trim() + '\\n',\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n\n      navigator.serviceWorker.ready.then(registration => {\n        config && config.onSuccess && config.onSuccess(registration);\n      });\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\n\nimport * as serviceWorker from './serviceWorker';\n\ninterface ServiceWorkerEvent extends Event {\n  target: Partial<ServiceWorker> & EventTarget | null;\n}\n\ninterface ServiceWorkerContextValue {\n  assetsUpdateReady: boolean;\n  assetsCached: boolean;\n  updateAssets(): void;\n}\n\nconst ServiceWorkerContext = React.createContext<ServiceWorkerContextValue | undefined>(undefined);\n\nexport function ServiceWorkerProvider(props: React.PropsWithChildren<{}>) {\n  const [waitingServiceWorker, setWaitingServiceWorker] = React.useState<ServiceWorker | null>(null);\n  const [assetsUpdateReady, setAssetsUpdateReady] = React.useState(false);\n  const [assetsCached, setAssetsCached] = React.useState(false);\n\n  const value = React.useMemo(() => {\n    return {\n      assetsUpdateReady,\n      assetsCached,\n      // Call when the user confirm update of application and reload page\n      updateAssets: () => {\n        if (waitingServiceWorker) {\n          waitingServiceWorker.addEventListener('statechange', (event: ServiceWorkerEvent) => {\n            if (event.target && event.target.state === 'activated') {\n              window.location.reload();\n            }\n          });\n\n          waitingServiceWorker.postMessage({ type: 'SKIP_WAITING' });\n        }\n      },\n    };\n  }, [assetsUpdateReady, assetsCached, waitingServiceWorker]);\n\n  // Once on component mounted subscribe to Update and Succes events in\n  // CRA's service worker wrapper\n  React.useEffect(() => {\n    serviceWorker.register({\n      onUpdate: registration => {\n        setWaitingServiceWorker(registration.waiting);\n        setAssetsUpdateReady(true);\n      },\n      onSuccess: registration => {\n        setAssetsCached(true);\n\n        if (registration.active) {\n          registration.active.addEventListener('statechange', (event: ServiceWorkerEvent) => {\n            if (!navigator.serviceWorker.controller) {\n              setAssetsCached(false);\n            }\n          });\n        }\n      },\n    });\n  }, []);\n\n  return <ServiceWorkerContext.Provider value={value} {...props} />;\n}\n\nexport function useServiceWorker() {\n  const context = React.useContext(ServiceWorkerContext);\n\n  if (!context) {\n    throw new Error('useServiceWorker must be used within a ServiceWorkerProvider');\n  }\n\n  return context;\n}\n","import { Global, css } from '@emotion/core';\nimport styled from '@emotion/styled/macro';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { OfflineBolt, Update } from '@material-ui/icons';\nimport React from 'react';\nimport { Tooltip, TooltipReference, useTooltipState } from 'reakit/Tooltip';\n\nimport { Playground } from './playground';\nimport { files } from './templates/react';\nimport { useServiceWorker, ServiceWorkerProvider } from './useServiceWorker';\nimport { Button } from 'reakit/Button';\n\nconst PlaygroundWrapper = styled.div`\n  background: white;\n  color: #666;\n  display: flex;\n  flex-direction: column;\n\n  ${Playground} {\n    border-bottom: 1px solid #ccc;\n    flex: 1;\n  }\n`;\n\nconst StatusBarItem = styled.span`\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n`;\n\nconst ReloadButton = styled(Button)`\n  border: 0;\n  background: #008cba;\n  margin: 0 0.5em;\n  color: white;\n  border-radius: 2px;\n  font-weight: 600;\n\n  :hover {\n    cursor: pointer;\n    text-decoration: underline;\n  }\n`;\n\nconst StyledTooltip = styled.div`\n  font-family: Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  line-height: 1.4;\n  background-color: #333;\n  color: #fff;\n  border-radius: 4px;\n  opacity: 0.9;\n  padding: 0.2em 0.4em;\n`;\n\nconst StatusBar: React.FC = () => {\n  const serviceWorker = useServiceWorker();\n  const offlineTooltip = useTooltipState({ gutter: 0 });\n  const reloadTooltip = useTooltipState({ gutter: 0 });\n\n  return (\n    <StatusBarStyles>\n      {serviceWorker.assetsCached ? (\n        <TooltipReference {...offlineTooltip} as={StatusBarItem}>\n          <OfflineBolt color=\"inherit\" fontSize=\"small\" />\n          &nbsp;Offline ready\n        </TooltipReference>\n      ) : null}\n      <Tooltip {...offlineTooltip} as={StyledTooltip}>\n        This application has been fully cached and can now be used offline.\n      </Tooltip>\n\n      {serviceWorker.assetsUpdateReady ? (\n        <TooltipReference {...reloadTooltip} as={StatusBarItem}>\n          <Update color=\"inherit\" fontSize=\"small\" />\n          &nbsp;Update ready:\n          <ReloadButton onClick={() => serviceWorker.updateAssets()}>Reload</ReloadButton>\n        </TooltipReference>\n      ) : null}\n      <Tooltip {...reloadTooltip} as={StyledTooltip}>\n        There is an update of this application ready to install. Click install reload to install the update and reload\n        the page.\n      </Tooltip>\n    </StatusBarStyles>\n  );\n};\n\nconst StatusBarStyles = styled.div`\n  display: flex;\n  flex-direction: row;\n\n  font-size: 90%;\n\n  height: 24px;\n  padding: 0 0.5em;\n\n  ${StatusBarItem} {\n    margin-left: 0.5em;\n    margin-right: 0.5em;\n  }\n`;\n\nconst AppWrapper = styled.div`\n  width: 100%;\n  min-width: 200px;\n  max-width: 80vw;\n  margin: 0 auto;\n  padding: 0 0 45px 0;\n\n  @media (max-width: 960px) {\n    padding: 0 15px 15px 15px;\n    max-width: initial;\n  }\n\n  display: flex;\n  flex-direction: column;\n\n  ${PlaygroundWrapper} {\n    flex: 1;\n    background: #f5f5f5;\n    border-radius: 2px;\n    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);\n\n    ${StatusBarStyles} {\n    }\n  }\n`;\n\nconst Title = styled.div`\n  font-family: 'Raleway', sans-serif;\n  font-size: 250%;\n  font-weight: 800;\n  font-variant: small-caps;\n  font-variant-caps: small-caps;\n  color: #00bfff;\n`;\n\nconst Subtitle = styled.div`\n  color: #ddd;\n  font-size: 120%;\n  font-weight: 400;\n`;\n\nconst Link = styled.a`\n  color: white;\n  text-decoration: none;\n\n  :hover {\n    text-decoration: underline;\n  }\n`;\n\nconst Links = styled.div`\n  display: flex;\n  flex-direction: row;\n\n  & > *:not(:last-child):after {\n    padding: 0 0.5em;\n    content: '';\n    color: #aaa;\n    text-decoration: none;\n  }\n\n  ${Link} {\n    color: #ccc;\n  }\n`;\n\nconst Header = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: baseline;\n  padding: 0.8em 0 0.3em 0;\n  text-shadow: #000 1px 1px 5px;\n\n  ${Title} {\n    margin-right: 0.5em;\n  }\n\n  ${Subtitle} {\n    margin-right: 0.5em;\n  }\n\n  ${Links} {\n    flex: 1;\n    justify-content: flex-end;\n  }\n`;\n\nconst globalCss = css`\n  @import url('https://fonts.googleapis.com/css?family=Raleway:900&display=swap');\n\n  *,\n  *::before,\n  *::after {\n    box-sizing: border-box;\n  }\n\n  html,\n  body {\n    margin: 0;\n    padding: 0;\n    min-height: 100vh;\n\n    font-family: Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif;\n    font-size: 14px;\n    line-height: 1.4;\n\n    background: #333;\n    color: #fff;\n\n    display: flex;\n    flex-direction: column;\n\n    #root {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n\n      ${AppWrapper} {\n        flex: 1;\n      }\n    }\n  }\n`;\n\nexport const App: React.FC = () => {\n  return (\n    <ServiceWorkerProvider>\n      <CssBaseline />\n      <AppWrapper>\n        <Global styles={globalCss}></Global>\n        <Header>\n          <Title>Velcro</Title>\n          <Subtitle>The client-side bundler and playground</Subtitle>\n          <Links>\n            <div>\n              <Link href=\"https://twitter.com/filearts\" target=\"_blank\" rel=\"nofollow noreferrer\">\n                @filearts\n              </Link>\n            </div>\n            <div>\n              <Link href=\"https://github.com/ggoodman/velcro\" target=\"_blank\" rel=\"nofollow noreferrer\">\n                View on GitHub\n              </Link>\n            </div>\n          </Links>\n        </Header>\n        <PlaygroundWrapper>\n          <Playground project={files} initialPath=\"index.jsx\"></Playground>\n          <StatusBar></StatusBar>\n        </PlaygroundWrapper>\n      </AppWrapper>\n    </ServiceWorkerProvider>\n  );\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { App } from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","import _defineProperty from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _slicedToArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _possibleConstructorReturn from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport _classCallCheck from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { CancellationTokenSource, CanceledError } from 'ts-primitives';\nexport { CanceledError, CancellationToken, CancellationTokenSource } from 'ts-primitives';\nvar ResolvedEntryKind;\n\n(function (ResolvedEntryKind) {\n  ResolvedEntryKind[\"Directory\"] = \"directory\";\n  ResolvedEntryKind[\"File\"] = \"file\";\n})(ResolvedEntryKind || (ResolvedEntryKind = {}));\n\nfunction isValidPackageJson(json) {\n  return typeof json === 'object' && json !== null && !hasInvalidOptionalStringField(json, 'name') && !hasInvalidOptionalStringField(json, 'version') && !hasInvalidBrowserField(json) && !hasInvalidOptionalStringField(json, 'main') && !hasInvalidOptionalStringField(json, 'module') && !hasInvalidOptionalStringField(json, 'jsnext:main') && !hasInvalidOptionalStringField(json, 'unpkg') && !hasInvalidDependenciesField(json, 'dependencies') && !hasInvalidDependenciesField(json, 'devDependencies') && !hasInvalidDependenciesField(json, 'peerDependencies');\n}\n\nfunction hasInvalidBrowserField(json) {\n  var error = '';\n  var browser = json.browser;\n\n  if (browser) {\n    if (typeof browser === 'object') {\n      for (var key in browser) {\n        if (typeof key !== 'string') {\n          error = \"The key \".concat(key, \" of .browser must be a string\");\n          break;\n        }\n\n        if (typeof browser[key] !== 'string' && browser[key] !== false) {\n          error = \"The value \".concat(key, \" of .browser must be a string or false\");\n          break;\n        }\n      }\n    }\n  }\n\n  return error;\n}\n\nfunction hasInvalidOptionalStringField(json, field) {\n  return json[field] !== undefined && typeof json[field] !== 'string';\n}\n\nfunction hasInvalidDependenciesField(json, field) {\n  return json[field] !== undefined && typeof json[field] === 'object' && json[field] !== null && !Object.keys(json[field]).every(function (key) {\n    return typeof key === 'string' && typeof json[field][key] === 'string';\n  });\n}\n\nvar CHAR_DOT = 46;\n/* . */\n\nvar CHAR_FORWARD_SLASH = 47;\n/* / */\n\nvar TRAILING_SLASH_RX = /\\/?$/;\n\nfunction ensureTrailingSlash(pathname) {\n  return pathname.replace(TRAILING_SLASH_RX, '/');\n}\n\nfunction parseBufferAsPackageJson(decoder, content, spec) {\n  try {\n    var text = decoder.decode(content);\n    return parseTextAsPackageJson(text, spec);\n  } catch (err) {\n    throw new Error(\"Error decoding manifest buffer for package \".concat(spec, \": \").concat(err.message));\n  }\n}\n\nfunction parseTextAsPackageJson(text, spec) {\n  var json;\n\n  try {\n    json = JSON.parse(text);\n  } catch (err) {\n    throw new Error(\"Error parsing manifest as json for package \".concat(spec, \": \").concat(err.message));\n  }\n\n  if (!isValidPackageJson(json)) {\n    throw new Error(\"Invalid manifest for the package \".concat(spec));\n  }\n\n  return json;\n}\n\nfunction getFirstPathSegmentAfterPrefix(child, parent) {\n  var childHref = child.pathname;\n  var parentHref = parent.pathname;\n  var parentOffset = parentHref.charAt(parentHref.length - 1) === '/' ? -1 : 0;\n\n  for (var i = 0; i <= childHref.length; i++) {\n    if (i < parentHref.length) {\n      if (childHref.charAt(i) !== parentHref.charAt(i)) {\n        throw new Error(\"The child entry \".concat(child.href, \" does not have the pathname of \").concat(parent.href, \" as a prefix\"));\n      }\n    } else if (i === parentHref.length + parentOffset) {\n      if (childHref.charAt(i) !== '/') {\n        throw new Error(\"The child entry \".concat(child.href, \" does not have the pathname of \").concat(parent.href, \" as a prefix\"));\n      }\n    } else if (childHref.charAt(i) === '/') {\n      return childHref.slice(parentHref.length + 1 + parentOffset, i);\n    }\n  }\n\n  return childHref.slice(parentHref.length + 1 + parentOffset);\n}\n\nfunction validateString(value, name) {\n  if (typeof value !== 'string') {\n    throw new TypeError(\"The '\".concat(name, \"' argument must be of type string but got \").concat(typeof value));\n  }\n}\n\nfunction basename(path, ext) {\n  if (ext !== undefined) {\n    validateString(ext, 'ext');\n  }\n\n  validateString(path, 'path');\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n    if (ext.length === path.length && ext === path) {\n      return '';\n    }\n\n    var extIdx = ext.length - 1;\n    var firstNonSlashEnd = -1;\n\n    for (i = path.length - 1; i >= start; --i) {\n      var code = path.charCodeAt(i);\n\n      if (isPathSeparator(code)) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else {\n        if (firstNonSlashEnd === -1) {\n          // We saw the first non-path separator, remember this index in case\n          // we need it if the extension ends up not matching\n          matchedSlash = false;\n          firstNonSlashEnd = i + 1;\n        }\n\n        if (extIdx >= 0) {\n          // Try to match the explicit extension\n          if (code === ext.charCodeAt(extIdx)) {\n            if (--extIdx === -1) {\n              // We matched the extension, so mark this as the end of our path\n              // component\n              end = i;\n            }\n          } else {\n            // Extension does not match, so our result is the entire path\n            // component\n            extIdx = -1;\n            end = firstNonSlashEnd;\n          }\n        }\n      }\n    }\n\n    if (start === end) {\n      end = firstNonSlashEnd;\n    } else if (end === -1) {\n      end = path.length;\n    }\n\n    return path.slice(start, end);\n  } else {\n    for (i = path.length - 1; i >= start; --i) {\n      if (isPathSeparator(path.charCodeAt(i))) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // path component\n        matchedSlash = false;\n        end = i + 1;\n      }\n    }\n\n    if (end === -1) {\n      return '';\n    }\n\n    return path.slice(start, end);\n  }\n}\n\nfunction extname(path) {\n  validateString(path, 'path');\n  var start = 0;\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true; // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n\n  var preDotState = 0;\n\n  for (var i = path.length - 1; i >= start; --i) {\n    var code = path.charCodeAt(i);\n\n    if (isPathSeparator(code)) {\n      // If we reached a path separator that was not part of a set of path\n      // separators at the end of the string, stop now\n      if (!matchedSlash) {\n        startPart = i + 1;\n        break;\n      }\n\n      continue;\n    }\n\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n\n    if (code === CHAR_DOT) {\n      // If this is our first dot, mark it as the start of our extension\n      if (startDot === -1) {\n        startDot = i;\n      } else if (preDotState !== 1) {\n        preDotState = 1;\n      }\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 || // We saw a non-dot character immediately before the dot\n  preDotState === 0 || // The (right-most) trimmed path component is exactly '..'\n  preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n\n  return path.slice(startDot, end);\n}\n\nfunction dirname(path) {\n  validateString(path, 'path');\n  var len = path.length;\n\n  if (len === 0) {\n    return '.';\n  }\n\n  var rootEnd = -1;\n  var end = -1;\n  var matchedSlash = true;\n  var offset = 0;\n  var code = path.charCodeAt(0); // Try to match a root\n\n  if (len > 1) {\n    if (isPathSeparator(code)) {\n      // Possible UNC root\n      rootEnd = offset = 1;\n\n      if (isPathSeparator(path.charCodeAt(1))) {\n        // Matched double path separator at beginning\n        var j = 2;\n        var last = j; // Match 1 or more non-path separators\n\n        for (; j < len; ++j) {\n          if (isPathSeparator(path.charCodeAt(j))) {\n            break;\n          }\n        }\n\n        if (j < len && j !== last) {\n          // Matched!\n          last = j; // Match 1 or more path separators\n\n          for (; j < len; ++j) {\n            if (!isPathSeparator(path.charCodeAt(j))) {\n              break;\n            }\n          }\n\n          if (j < len && j !== last) {\n            // Matched!\n            last = j; // Match 1 or more non-path separators\n\n            for (; j < len; ++j) {\n              if (isPathSeparator(path.charCodeAt(j))) {\n                break;\n              }\n            }\n\n            if (j === len) {\n              // We matched a UNC root only\n              return path;\n            }\n\n            if (j !== last) {\n              // We matched a UNC root with leftovers\n              // Offset by 1 to include the separator after the UNC root to\n              // treat it as a \"normal root\" on top of a (UNC) root\n              rootEnd = offset = j + 1;\n            }\n          }\n        }\n      }\n    }\n  } else if (isPathSeparator(code)) {\n    // `path` contains just a path separator, exit early to avoid\n    // unnecessary work\n    return path;\n  }\n\n  for (var i = len - 1; i >= offset; --i) {\n    if (isPathSeparator(path.charCodeAt(i))) {\n      if (!matchedSlash) {\n        end = i;\n        break;\n      }\n    } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) {\n    if (rootEnd === -1) {\n      return '.';\n    } else {\n      end = rootEnd;\n    }\n  }\n\n  return path.slice(0, end);\n}\n\nfunction join(initialSegment) {\n  var pathname = initialSegment;\n\n  for (var i = 0; i < (arguments.length <= 1 ? 0 : arguments.length - 1); i++) {\n    var segment = i + 1 < 1 || arguments.length <= i + 1 ? undefined : arguments[i + 1];\n\n    if (segment.startsWith('/')) {\n      segment = segment.slice(1);\n    }\n\n    if (pathname.endsWith('/')) {\n      pathname += segment;\n    } else {\n      pathname += \"/\".concat(segment);\n    }\n  }\n\n  return pathname;\n}\n\nfunction resolve() {\n  var resolvedPath = '';\n  var resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = void 0;\n\n    if (i >= 0) {\n      path = i < 0 || arguments.length <= i ? undefined : arguments[i];\n    } else {\n      break;\n    }\n\n    validateString(path, 'path'); // Skip empty entries\n\n    if (path.length === 0) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\n  } // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n  // Normalize the path\n\n\n  resolvedPath = normalizeString(resolvedPath, !resolvedAbsolute, '/', isPathSeparator);\n\n  if (resolvedAbsolute) {\n    if (resolvedPath.length > 0) {\n      return '/' + resolvedPath;\n    } else {\n      return '/';\n    }\n  } else if (resolvedPath.length > 0) {\n    return resolvedPath;\n  } else {\n    return '.';\n  }\n}\n\nfunction isPathSeparator(code) {\n  return code === CHAR_FORWARD_SLASH;\n}\n\nfunction normalizeString(path, allowAboveRoot, separator, isPathSeparator) {\n  var res = '';\n  var lastSegmentLength = 0;\n  var lastSlash = -1;\n  var dots = 0;\n  var code = -1;\n\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length) {\n      code = path.charCodeAt(i);\n    } else if (isPathSeparator(code)) {\n      break;\n    } else {\n      code = CHAR_FORWARD_SLASH;\n    }\n\n    if (isPathSeparator(code)) {\n      if (lastSlash === i - 1 || dots === 1) ;else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 || lastSegmentLength !== 2 || res.charCodeAt(res.length - 1) !== CHAR_DOT || res.charCodeAt(res.length - 2) !== CHAR_DOT) {\n          if (res.length > 2) {\n            var lastSlashIndex = res.lastIndexOf(separator);\n\n            if (lastSlashIndex === -1) {\n              res = '';\n              lastSegmentLength = 0;\n            } else {\n              res = res.slice(0, lastSlashIndex);\n              lastSegmentLength = res.length - 1 - res.lastIndexOf(separator);\n            }\n\n            lastSlash = i;\n            dots = 0;\n            continue;\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSegmentLength = 0;\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n\n        if (allowAboveRoot) {\n          if (res.length > 0) {\n            res += \"\".concat(separator, \"..\");\n          } else {\n            res = '..';\n          }\n\n          lastSegmentLength = 2;\n        }\n      } else {\n        if (res.length > 0) {\n          res += separator + path.slice(lastSlash + 1, i);\n        } else {\n          res = path.slice(lastSlash + 1, i);\n        }\n\n        lastSegmentLength = i - lastSlash - 1;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === CHAR_DOT && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n\n  return res;\n}\n\nvar util =\n/*#__PURE__*/\nObject.freeze({\n  ensureTrailingSlash: ensureTrailingSlash,\n  parseBufferAsPackageJson: parseBufferAsPackageJson,\n  getFirstPathSegmentAfterPrefix: getFirstPathSegmentAfterPrefix,\n  basename: basename,\n  extname: extname,\n  dirname: dirname,\n  join: join,\n  resolve: resolve\n});\n\nvar Decoder =\n/*#__PURE__*/\nfunction () {\n  function Decoder() {\n    _classCallCheck(this, Decoder);\n\n    if (typeof TextDecoder !== 'undefined') {\n      this.decoder = new TextDecoder();\n    }\n  }\n\n  _createClass(Decoder, [{\n    key: \"decode\",\n    value: function decode(buf) {\n      var str = this.decoder ? this.decoder.decode(buf) : Buffer.from(buf).toString('utf-8');\n      return str.charCodeAt(0) === 0xfeff ? str.slice(1) : str;\n    }\n  }]);\n\n  return Decoder;\n}();\n\nvar ExtendableError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(ExtendableError, _Error);\n\n  function ExtendableError(message) {\n    var _this;\n\n    _classCallCheck(this, ExtendableError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ExtendableError).call(this, message));\n    _this.name = _this.constructor.name;\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(_assertThisInitialized(_this), _this.constructor);\n    } else {\n      _this.stack = new Error(message).stack;\n    }\n\n    return _this;\n  }\n\n  return ExtendableError;\n}(_wrapNativeSuper(Error));\n\nvar EntryNotFoundError =\n/*#__PURE__*/\nfunction (_ExtendableError) {\n  _inherits(EntryNotFoundError, _ExtendableError);\n\n  function EntryNotFoundError(url) {\n    var _this2;\n\n    _classCallCheck(this, EntryNotFoundError);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(EntryNotFoundError).call(this, \"Not found \".concat(url.href)));\n    _this2.url = url;\n    return _this2;\n  }\n\n  return EntryNotFoundError;\n}(ExtendableError);\n\nvar AbstractResolverHost =\n/*#__PURE__*/\nfunction () {\n  function AbstractResolverHost() {\n    _classCallCheck(this, AbstractResolverHost);\n  }\n\n  _createClass(AbstractResolverHost, [{\n    key: \"getCanonicalUrl\",\n    value: function getCanonicalUrl(_resolver, url) {\n      return Promise.resolve(url);\n    }\n  }]);\n\n  return AbstractResolverHost;\n}();\n\nvar TRAILING_SLASH_RX$1 = /\\/?$/;\n\nvar Resolver =\n/*#__PURE__*/\nfunction () {\n  function Resolver(host) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Resolver);\n\n    this.host = host;\n    this.decoder = new Decoder();\n    this.extensions = Array.from(options.extensions || Resolver.defaultExtensions);\n    this.packageMain = options.packageMain || ['main'];\n  }\n\n  _createClass(Resolver, [{\n    key: \"resolve\",\n    value: function () {\n      var _resolve = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(url) {\n        var options,\n            token,\n            tokenSource,\n            optionsWithDefaults,\n            canonicalUrlPromise,\n            _ref,\n            _ref2,\n            canonicalUrl,\n            rootUrl,\n            rootHref,\n            rootHrefWithoutTrailingSlash,\n            canonicalHref,\n            resolvedUrl,\n            _args = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n\n                if (url instanceof URL) {\n                  _context.next = 9;\n                  break;\n                }\n\n                _context.prev = 2;\n                url = new URL(url);\n                _context.next = 9;\n                break;\n\n              case 6:\n                _context.prev = 6;\n                _context.t0 = _context[\"catch\"](2);\n                throw new Error(\"Invalid URL: \".concat(url, \": \").concat(_context.t0.message));\n\n              case 9:\n                token = options.token;\n\n                if (!token) {\n                  tokenSource = new CancellationTokenSource();\n                  token = tokenSource.token;\n                }\n\n                optionsWithDefaults = {\n                  extensions: options.extensions || this.extensions,\n                  ignoreBrowserOverrides: typeof options.ignoreBrowserOverrides === 'undefined' ? false : options.ignoreBrowserOverrides,\n                  packageMain: options.packageMain || this.packageMain,\n                  token: token\n                };\n                canonicalUrlPromise = this.host.getCanonicalUrl(this, url, {\n                  token: token\n                }); // To figure out if the url should be resolved as a file or as a directory, we need to first canonicalize the url\n                // if the host supports this and resolve the root url for the given asset.\n\n                _context.next = 15;\n                return Promise.all([canonicalUrlPromise, this.host.getResolveRoot(this, url, {\n                  token: token\n                })]);\n\n              case 15:\n                _ref = _context.sent;\n                _ref2 = _slicedToArray(_ref, 2);\n                canonicalUrl = _ref2[0];\n                rootUrl = _ref2[1];\n\n                if (!token.isCancellationRequested) {\n                  _context.next = 21;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 21:\n                rootHref = rootUrl.href;\n                rootHrefWithoutTrailingSlash = rootHref.replace(TRAILING_SLASH_RX$1, '');\n                canonicalHref = canonicalUrl.href;\n\n                if (canonicalHref.startsWith(rootHrefWithoutTrailingSlash)) {\n                  _context.next = 26;\n                  break;\n                }\n\n                throw new Error(\"Unable to resolve a module whose path \".concat(canonicalHref, \" is above the host's root \").concat(rootHref));\n\n              case 26:\n                if (!(rootHrefWithoutTrailingSlash === canonicalHref || rootHref == canonicalHref)) {\n                  _context.next = 32;\n                  break;\n                }\n\n                _context.next = 29;\n                return this.resolveAsDirectory(canonicalUrl, optionsWithDefaults);\n\n              case 29:\n                _context.t1 = _context.sent;\n                _context.next = 35;\n                break;\n\n              case 32:\n                _context.next = 34;\n                return this.resolveAsFile(canonicalUrl, optionsWithDefaults);\n\n              case 34:\n                _context.t1 = _context.sent;\n\n              case 35:\n                resolvedUrl = _context.t1;\n\n                if (!token.isCancellationRequested) {\n                  _context.next = 38;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 38:\n                return _context.abrupt(\"return\", {\n                  ignored: resolvedUrl === false,\n                  resolvedUrl: resolvedUrl || undefined,\n                  rootUrl: rootUrl\n                });\n\n              case 39:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 6]]);\n      }));\n\n      function resolve(_x) {\n        return _resolve.apply(this, arguments);\n      }\n\n      return resolve;\n    }()\n    /**\r\n     * Resolve a reference treating it as a directory\r\n     *\r\n     * 1. If there is a `package.json` file and this has a `main` entry, use that\r\n     * 2. Assume `index` if no main file is found in the `package.json` manifest\r\n     *\r\n     * The outcome of this process will then be resolved as if it were a file.\r\n     */\n\n  }, {\n    key: \"resolveAsDirectory\",\n    value: function () {\n      var _resolveAsDirectory = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(url, options) {\n        var _ref3, _ref4, rootUrl, entries, mainPathname, packageJsonEntry, packageJsonContent, packageJson, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, packageMain, pathname, mainUrl;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return Promise.all([this.host.getResolveRoot(this, url, {\n                  token: options.token\n                }), this.host.listEntries(this, url, {\n                  token: options.token\n                })]);\n\n              case 2:\n                _ref3 = _context2.sent;\n                _ref4 = _slicedToArray(_ref3, 2);\n                rootUrl = _ref4[0];\n                entries = _ref4[1];\n\n                if (!options.token.isCancellationRequested) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 8:\n                mainPathname = 'index'; // Step 1: Look for a package.json with an main field\n\n                packageJsonEntry = entries.find(function (entry) {\n                  return basename(entry.url.pathname) === 'package.json';\n                });\n\n                if (!packageJsonEntry) {\n                  _context2.next = 45;\n                  break;\n                }\n\n                _context2.next = 13;\n                return this.host.readFileContent(this, packageJsonEntry.url, {\n                  token: options.token\n                });\n\n              case 13:\n                packageJsonContent = _context2.sent;\n\n                if (!options.token.isCancellationRequested) {\n                  _context2.next = 16;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 16:\n                packageJson = parseBufferAsPackageJson(this.decoder, packageJsonContent, url.href);\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context2.prev = 20;\n                _iterator = this.packageMain[Symbol.iterator]();\n\n              case 22:\n                if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                  _context2.next = 31;\n                  break;\n                }\n\n                packageMain = _step.value;\n                pathname = packageJson[packageMain];\n\n                if (!(typeof pathname === 'string')) {\n                  _context2.next = 28;\n                  break;\n                }\n\n                mainPathname = pathname;\n                return _context2.abrupt(\"break\", 31);\n\n              case 28:\n                _iteratorNormalCompletion = true;\n                _context2.next = 22;\n                break;\n\n              case 31:\n                _context2.next = 37;\n                break;\n\n              case 33:\n                _context2.prev = 33;\n                _context2.t0 = _context2[\"catch\"](20);\n                _didIteratorError = true;\n                _iteratorError = _context2.t0;\n\n              case 37:\n                _context2.prev = 37;\n                _context2.prev = 38;\n\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n\n              case 40:\n                _context2.prev = 40;\n\n                if (!_didIteratorError) {\n                  _context2.next = 43;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 43:\n                return _context2.finish(40);\n\n              case 44:\n                return _context2.finish(37);\n\n              case 45:\n                mainUrl = new URL(resolve(url.pathname, mainPathname), rootUrl);\n                return _context2.abrupt(\"return\", this.resolveAsFile(mainUrl, options));\n\n              case 47:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[20, 33, 37, 45], [38,, 40, 44]]);\n      }));\n\n      function resolveAsDirectory(_x2, _x3) {\n        return _resolveAsDirectory.apply(this, arguments);\n      }\n\n      return resolveAsDirectory;\n    }()\n    /**\r\n     * Resolve a reference treating it as a file\r\n     *\r\n     * 1. List entries in the containing directory\r\n     * 2. Look for an exact file match or a file match with one of the supplied extensions\r\n     * 3. Look for a matching child directory and attempt to resolve that as a directory\r\n     */\n\n  }, {\n    key: \"resolveAsFile\",\n    value: function () {\n      var _resolveAsFile = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(url, options) {\n        var rootUrl, parentPackageJson, browserOverrides, browserMap, packageJsonDir, entry, impliedUrl, targetSpec, target, containingUrl, filename, entries, entryDirectoryMap, entryFileMap, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, _entry, childFilename, _childFilename, _iteratorNormalCompletion3, _didIteratorError3, _iteratorError3, _iterator3, _step3, ext, mapping, _match, match;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(url.pathname === '' || url.pathname === '/')) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                throw new TypeError(\"Unable to resolve the root as a file: \".concat(url.href));\n\n              case 2:\n                _context3.next = 4;\n                return this.host.getResolveRoot(this, url, {\n                  token: options.token\n                });\n\n              case 4:\n                rootUrl = _context3.sent;\n\n                if (!options.token.isCancellationRequested) {\n                  _context3.next = 7;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 7:\n                if (!(this.packageMain.includes('browser') && !options.ignoreBrowserOverrides)) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                _context3.next = 10;\n                return this.readParentPackageJson(url, {\n                  token: options.token\n                });\n\n              case 10:\n                _context3.t0 = _context3.sent;\n                _context3.next = 14;\n                break;\n\n              case 13:\n                _context3.t0 = undefined;\n\n              case 14:\n                parentPackageJson = _context3.t0;\n\n                if (!options.token.isCancellationRequested) {\n                  _context3.next = 17;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 17:\n                browserOverrides = new Map();\n\n                if (!(parentPackageJson && typeof parentPackageJson.packageJson.browser === 'object')) {\n                  _context3.next = 34;\n                  break;\n                }\n\n                browserMap = parentPackageJson.packageJson.browser;\n                packageJsonDir = dirname(parentPackageJson.url.pathname);\n                _context3.t1 = _regeneratorRuntime.keys(browserMap);\n\n              case 22:\n                if ((_context3.t2 = _context3.t1()).done) {\n                  _context3.next = 34;\n                  break;\n                }\n\n                entry = _context3.t2.value;\n                impliedUrl = new URL(resolve(packageJsonDir, entry), parentPackageJson.url);\n                targetSpec = browserMap[entry];\n                target = targetSpec === false ? false : new URL(resolve(packageJsonDir, targetSpec), parentPackageJson.url);\n\n                if (!(impliedUrl.href === url.href)) {\n                  _context3.next = 31;\n                  break;\n                }\n\n                if (!(target === false)) {\n                  _context3.next = 30;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", false);\n\n              case 30:\n                return _context3.abrupt(\"return\", this.resolveAsFile(target, _objectSpread({}, options, {\n                  ignoreBrowserOverrides: true\n                })));\n\n              case 31:\n                browserOverrides.set(impliedUrl.href, target);\n                _context3.next = 22;\n                break;\n\n              case 34:\n                containingUrl = new URL(ensureTrailingSlash(dirname(url.pathname)), rootUrl);\n                filename = basename(url.pathname);\n                _context3.next = 38;\n                return this.host.listEntries(this, containingUrl, {\n                  token: options.token\n                });\n\n              case 38:\n                entries = _context3.sent;\n\n                if (!options.token.isCancellationRequested) {\n                  _context3.next = 41;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 41:\n                entryDirectoryMap = new Map();\n                entryFileMap = new Map();\n                _iteratorNormalCompletion2 = true;\n                _didIteratorError2 = false;\n                _iteratorError2 = undefined;\n                _context3.prev = 46;\n                _iterator2 = entries[Symbol.iterator]();\n\n              case 48:\n                if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n                  _context3.next = 56;\n                  break;\n                }\n\n                _entry = _step2.value;\n\n                if (!(_entry.url.href === url.href && _entry.type == ResolvedEntryKind.File)) {\n                  _context3.next = 52;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", _entry.url);\n\n              case 52:\n                if (_entry.type === ResolvedEntryKind.Directory) {\n                  childFilename = getFirstPathSegmentAfterPrefix(_entry.url, containingUrl);\n                  entryDirectoryMap.set(childFilename, _entry);\n                } else if (_entry.type === ResolvedEntryKind.File) {\n                  _childFilename = basename(_entry.url.pathname);\n                  entryFileMap.set(_childFilename, _entry);\n                }\n\n              case 53:\n                _iteratorNormalCompletion2 = true;\n                _context3.next = 48;\n                break;\n\n              case 56:\n                _context3.next = 62;\n                break;\n\n              case 58:\n                _context3.prev = 58;\n                _context3.t3 = _context3[\"catch\"](46);\n                _didIteratorError2 = true;\n                _iteratorError2 = _context3.t3;\n\n              case 62:\n                _context3.prev = 62;\n                _context3.prev = 63;\n\n                if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n                  _iterator2.return();\n                }\n\n              case 65:\n                _context3.prev = 65;\n\n                if (!_didIteratorError2) {\n                  _context3.next = 68;\n                  break;\n                }\n\n                throw _iteratorError2;\n\n              case 68:\n                return _context3.finish(65);\n\n              case 69:\n                return _context3.finish(62);\n\n              case 70:\n                // Look for browser overrides\n                _iteratorNormalCompletion3 = true;\n                _didIteratorError3 = false;\n                _iteratorError3 = undefined;\n                _context3.prev = 73;\n                _iterator3 = options.extensions[Symbol.iterator]();\n\n              case 75:\n                if (_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done) {\n                  _context3.next = 92;\n                  break;\n                }\n\n                ext = _step3.value;\n                mapping = browserOverrides.get(\"\".concat(url.href).concat(ext));\n\n                if (!(mapping === false)) {\n                  _context3.next = 82;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", false);\n\n              case 82:\n                if (!mapping) {\n                  _context3.next = 84;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", this.resolveAsFile(mapping, _objectSpread({}, options, {\n                  ignoreBrowserOverrides: true\n                })));\n\n              case 84:\n                _match = entryFileMap.get(\"\".concat(filename).concat(ext));\n\n                if (!_match) {\n                  _context3.next = 89;\n                  break;\n                }\n\n                if (!(_match.type !== ResolvedEntryKind.File)) {\n                  _context3.next = 88;\n                  break;\n                }\n\n                return _context3.abrupt(\"continue\", 89);\n\n              case 88:\n                return _context3.abrupt(\"return\", _match.url);\n\n              case 89:\n                _iteratorNormalCompletion3 = true;\n                _context3.next = 75;\n                break;\n\n              case 92:\n                _context3.next = 98;\n                break;\n\n              case 94:\n                _context3.prev = 94;\n                _context3.t4 = _context3[\"catch\"](73);\n                _didIteratorError3 = true;\n                _iteratorError3 = _context3.t4;\n\n              case 98:\n                _context3.prev = 98;\n                _context3.prev = 99;\n\n                if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n                  _iterator3.return();\n                }\n\n              case 101:\n                _context3.prev = 101;\n\n                if (!_didIteratorError3) {\n                  _context3.next = 104;\n                  break;\n                }\n\n                throw _iteratorError3;\n\n              case 104:\n                return _context3.finish(101);\n\n              case 105:\n                return _context3.finish(98);\n\n              case 106:\n                // First, attempt to find a matching file or directory\n                match = entryDirectoryMap.get(filename);\n\n                if (!match) {\n                  _context3.next = 111;\n                  break;\n                }\n\n                if (!(match.type !== ResolvedEntryKind.Directory)) {\n                  _context3.next = 110;\n                  break;\n                }\n\n                throw new Error(\"Invariant violation \".concat(match.type, \" is unexpected\"));\n\n              case 110:\n                return _context3.abrupt(\"return\", this.resolveAsDirectory(match.url, options));\n\n              case 111:\n                throw new EntryNotFoundError(url);\n\n              case 112:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[46, 58, 62, 70], [63,, 65, 69], [73, 94, 98, 106], [99,, 101, 105]]);\n      }));\n\n      function resolveAsFile(_x4, _x5) {\n        return _resolveAsFile.apply(this, arguments);\n      }\n\n      return resolveAsFile;\n    }()\n  }, {\n    key: \"readParentPackageJson\",\n    value: function () {\n      var _readParentPackageJson = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(url) {\n        var _this3 = this;\n\n        var options,\n            hostRootUrl,\n            hostRootHref,\n            containingDirUrl,\n            readPackageJsonOrRecurse,\n            _args5 = arguments;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                options = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {};\n                _context5.next = 3;\n                return this.host.getCanonicalUrl(this, url, {\n                  token: options.token\n                });\n\n              case 3:\n                url = _context5.sent;\n\n                if (!(options.token && options.token.isCancellationRequested)) {\n                  _context5.next = 6;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 6:\n                _context5.next = 8;\n                return this.host.getResolveRoot(this, url, {\n                  token: options.token\n                });\n\n              case 8:\n                hostRootUrl = _context5.sent;\n\n                if (!(options.token && options.token.isCancellationRequested)) {\n                  _context5.next = 11;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 11:\n                hostRootHref = ensureTrailingSlash(hostRootUrl.href);\n                containingDirUrl = new URL(ensureTrailingSlash(dirname(url.pathname)), url);\n\n                readPackageJsonOrRecurse =\n                /*#__PURE__*/\n                function () {\n                  var _ref5 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee4(dir) {\n                    var entries, packageJsonEntry, parentPackageJsonContent, packageJson, parentDir;\n                    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                      while (1) {\n                        switch (_context4.prev = _context4.next) {\n                          case 0:\n                            if (dir.href.startsWith(hostRootHref)) {\n                              _context4.next = 2;\n                              break;\n                            }\n\n                            return _context4.abrupt(\"return\", undefined);\n\n                          case 2:\n                            _context4.next = 4;\n                            return _this3.host.listEntries(_this3, dir, {\n                              token: options.token\n                            });\n\n                          case 4:\n                            entries = _context4.sent;\n\n                            if (!(options.token && options.token.isCancellationRequested)) {\n                              _context4.next = 7;\n                              break;\n                            }\n\n                            throw new CanceledError('Canceled');\n\n                          case 7:\n                            packageJsonEntry = entries.find(function (entry) {\n                              return entry.type === ResolvedEntryKind.File && entry.url.pathname.endsWith('/package.json');\n                            });\n\n                            if (!packageJsonEntry) {\n                              _context4.next = 24;\n                              break;\n                            }\n\n                            _context4.prev = 9;\n                            _context4.next = 12;\n                            return _this3.host.readFileContent(_this3, packageJsonEntry.url, {\n                              token: options.token\n                            });\n\n                          case 12:\n                            parentPackageJsonContent = _context4.sent;\n\n                            if (!(options.token && options.token.isCancellationRequested)) {\n                              _context4.next = 15;\n                              break;\n                            }\n\n                            throw new CanceledError('Canceled');\n\n                          case 15:\n                            packageJson = parseBufferAsPackageJson(_this3.decoder, parentPackageJsonContent, packageJsonEntry.url.href);\n                            return _context4.abrupt(\"return\", {\n                              packageJson: packageJson,\n                              url: packageJsonEntry.url\n                            });\n\n                          case 19:\n                            _context4.prev = 19;\n                            _context4.t0 = _context4[\"catch\"](9);\n\n                            if (!(_context4.t0 instanceof CanceledError || _context4.t0 && _context4.t0.name === 'CanceledError')) {\n                              _context4.next = 23;\n                              break;\n                            }\n\n                            throw _context4.t0;\n\n                          case 23:\n                            console.warn(\"Error reading the parent package manifest for \".concat(url.href, \" from \").concat(packageJsonEntry.url.href, \": \").concat(_context4.t0.message));\n\n                          case 24:\n                            // Not found here, let's try one up\n                            parentDir = new URL(ensureTrailingSlash(dirname(dir.pathname)), dir); // Skip infinite recursion\n\n                            if (!(parentDir.href === dir.href)) {\n                              _context4.next = 27;\n                              break;\n                            }\n\n                            return _context4.abrupt(\"return\", undefined);\n\n                          case 27:\n                            return _context4.abrupt(\"return\", readPackageJsonOrRecurse(parentDir));\n\n                          case 28:\n                          case \"end\":\n                            return _context4.stop();\n                        }\n                      }\n                    }, _callee4, null, [[9, 19]]);\n                  }));\n\n                  return function readPackageJsonOrRecurse(_x7) {\n                    return _ref5.apply(this, arguments);\n                  };\n                }();\n\n                return _context5.abrupt(\"return\", readPackageJsonOrRecurse(containingDirUrl));\n\n              case 15:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function readParentPackageJson(_x6) {\n        return _readParentPackageJson.apply(this, arguments);\n      }\n\n      return readParentPackageJson;\n    }()\n  }]);\n\n  return Resolver;\n}();\n\nResolver.defaultExtensions = ['.js', '.jsx', '.es6', '.es', '.mjs', '.ts', '.tsx', '.json'];\nResolver.path = {\n  basename: basename,\n  dirname: dirname,\n  extname: extname,\n  resolve: resolve\n};\nexport { AbstractResolverHost, Decoder, EntryNotFoundError, ResolvedEntryKind, Resolver, isValidPackageJson, util };"],"sourceRoot":""}